"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[8692],{8692:(e,i,s)=>{s.r(i),s.d(i,{EmailAccountsAdmin:()=>fe});var r,l,n,o,a,d,t,c,h,m,x,p=s(57528),g=s(65043),u=s(96870),b=s(88787),j=s(85871),S=s(87139),f=s(22107),v=s(98662),E=s(42703),C=s(83169),y=s(24330),z=s(91751),I=s(44093),A=s(82459),w=s(35699),k=s(7189),T=s(47781),R=s(67516),N=s(35929),O=s(56529),P=s(15071),M=s(11054),W=s(78460),F=s(25722),U=s(61724),D=s(76659),L=s(96148),$=s(10202),X=s(98481),G=s(80511),B=s(82595),H=s(67813),_=s(83201),K=s(3313),V=s(55395),J=s(30502),q=s(47726),Z=s(39081),Y=s(1009),Q=s(31881),ee=s(10585),ie=s(70459),se=s(39985),re=s(66037),le=s(52003),ne=s(63295),oe=s(95214),ae=s(95393),de=s(70579);const te=(0,ie.J1)(r||(r=(0,p.A)(["\n  query GetClients {\n    clients {\n      id\n      fName\n      lName\n      email\n      phoneNumber\n      permissions\n    }\n  }\n"]))),ce=(0,ie.J1)(l||(l=(0,p.A)(["\n  query GetEmailAddresses {\n    emailAddresses {\n      id\n      email\n      name\n      type\n      associatedClients\n      emailsSent\n      emailsReceived\n      lastSeenAt\n      isRegisteredWithImprovMX\n      isVerified\n      primaryCalendarId\n      linkedCalendarIds\n      acceptedSenderEmailsForCalendarInvites\n      acceptCalendarInvitesFromAnyone\n      blockedDomainsForCalendarInvites\n      postmarkEndpoint\n      forwardingProvider\n    }\n  }\n"]))),he=(0,ie.J1)(n||(n=(0,p.A)(["\n  query GetCalendars {\n    calendars {\n      id\n      name\n      type\n      responsibleOwnerId\n    }\n  }\n"]))),me=(0,ie.J1)(o||(o=(0,p.A)(["\n  mutation UpdateEmailCalendar($emailId: String!, $primaryCalendarId: String, $linkedCalendarIds: [String!]) {\n    updateEmailAddress(id: $emailId, input: {\n      primaryCalendarId: $primaryCalendarId,\n      linkedCalendarIds: $linkedCalendarIds\n    }) {\n      id\n      primaryCalendarId\n      linkedCalendarIds\n    }\n  }\n"]))),xe=(0,ie.J1)(a||(a=(0,p.A)(["\n  mutation AssignEmailToClient($emailId: String!, $clientId: String!) {\n    assignEmailToClient(emailId: $emailId, clientId: $clientId) {\n      id\n      associatedClients\n    }\n  }\n"]))),pe=(0,ie.J1)(d||(d=(0,p.A)(["\n  mutation UnassignEmailFromClient($emailId: String!, $clientId: String!) {\n    unassignEmailFromClient(emailId: $emailId, clientId: $clientId) {\n      id\n      associatedClients\n    }\n  }\n"]))),ge=(0,ie.J1)(t||(t=(0,p.A)(["\n  mutation CreateEmailAddressWithAlias($input: CreateEmailAddressWithAliasInput!) {\n    createEmailAddressWithAlias(input: $input) {\n      id\n      email\n      name\n      type\n      associatedClients\n    }\n  }\n"]))),ue=(0,ie.J1)(c||(c=(0,p.A)(["\n  mutation ToggleImprovMXStatus($emailId: String!, $isRegistered: Boolean!) {\n    updateEmailAddress(id: $emailId, input: { isRegisteredWithImprovMX: $isRegistered }) {\n      id\n      isRegisteredWithImprovMX\n    }\n  }\n"]))),be=(0,ie.J1)(h||(h=(0,p.A)(["\n  mutation CreateEmailAddress($input: EmailAddressInput!) {\n    createEmailAddress(input: $input) {\n      id\n      email\n      name\n      type\n      postmarkEndpoint\n      isRegisteredWithImprovMX\n    }\n  }\n"]))),je=(0,ie.J1)(m||(m=(0,p.A)(["\n  mutation UpdateEmailType($emailId: String!, $type: String!) {\n    updateEmailAddress(id: $emailId, input: { type: $type }) {\n      id\n      type\n    }\n  }\n"]))),Se=(0,ie.J1)(x||(x=(0,p.A)(["\n  mutation UpdateForwardingProvider($emailId: String!, $provider: ForwardingProvider!) {\n    updateEmailAddress(id: $emailId, input: { forwardingProvider: $provider }) {\n      id\n      forwardingProvider\n    }\n  }\n"]))),fe=()=>{var e,i,s;(0,re.H)("Email Accounts Admin");const r=(0,J.d)(),{isOpen:l,onOpen:n,onClose:o}=(0,u.j)(),{isOpen:a,onOpen:d,onClose:t}=(0,u.j)(),{isOpen:c,onOpen:h,onClose:m}=(0,u.j)(),[x,p]=(0,g.useState)(!1),[ie,fe]=(0,g.useState)(null),[ve,Ee]=(0,g.useState)(null),[Ce,ye]=(0,g.useState)(""),[ze,Ie]=(0,g.useState)("all"),[Ae,we]=(0,g.useState)("all"),[ke,Te]=(0,g.useState)("registered"),[Re,Ne]=(0,g.useState)("all"),[Oe,Pe]=(0,g.useState)(""),[Me,We]=(0,g.useState)(""),[Fe,Ue]=(0,g.useState)(""),[De,Le]=(0,g.useState)("BUSINESS"),[$e,Xe]=(0,g.useState)("SHARED"),[Ge,Be]=(0,g.useState)(""),[He,_e]=(0,g.useState)(""),[Ke,Ve]=(0,g.useState)(null),[Je,qe]=(0,g.useState)(null),[Ze,Ye]=(0,g.useState)(null),[Qe,ei]=(0,g.useState)(null),{data:ii,loading:si}=(0,ee.IT)(te),{data:ri,loading:li,refetch:ni}=(0,ee.IT)(ce),{data:oi}=(0,ee.IT)(he),[ai]=(0,Q.n)(xe,{onCompleted:()=>{r({title:"Email assigned successfully",status:"success",duration:3e3,isClosable:!0}),ni(),o()},onError:e=>{r({title:"Error assigning email",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[di]=(0,Q.n)(pe,{onCompleted:()=>{r({title:"Email unassigned successfully",status:"success",duration:3e3,isClosable:!0}),ni()},onError:e=>{r({title:"Error unassigning email",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[ti]=(0,Q.n)(ge,{onCompleted:e=>{r({title:"Email created successfully",description:"Created ".concat(e.createEmailAddressWithAlias.email),status:"success",duration:5e3,isClosable:!0}),ni(),t(),We(""),Ue(""),Le("BUSINESS")},onError:e=>{r({title:"Error creating email",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[ci]=(0,Q.n)(ue,{onCompleted:()=>{r({title:"ImprovMX status updated",status:"success",duration:2e3,isClosable:!0})},onError:e=>{r({title:"Error updating ImprovMX status",description:e.message,status:"error",duration:5e3,isClosable:!0}),ni()}}),[hi]=(0,Q.n)(je,{onCompleted:()=>{r({title:"Email type updated",status:"success",duration:2e3,isClosable:!0}),ni()},onError:e=>{r({title:"Error updating email type",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[mi]=(0,Q.n)(Se,{onCompleted:()=>{r({title:"Forwarding provider updated",status:"success",duration:2e3,isClosable:!0}),ni()},onError:e=>{r({title:"Error updating forwarding provider",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[xi]=(0,Q.n)(be,{onCompleted:e=>{const i=e.createEmailAddress;r({title:"Email Created Successfully",description:"".concat(i.email," has been created. Click on it in the list to view setup instructions."),status:"success",duration:7e3,isClosable:!0}),Be(""),_e(""),Xe("SHARED"),m(),ni()},onError:e=>{r({title:"Error creating forwarding setup",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[pi]=(0,Q.n)(me,{onCompleted:()=>{r({title:"Calendar assignment updated",status:"success",duration:3e3,isClosable:!0}),ni()},onError:e=>{r({title:"Error updating calendar assignment",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),{colorMode:gi}=(0,I.G6)(),ui=(0,se.oU)("background.main",gi),bi=(0,se.oU)("background.cardGradient",gi),ji=(0,se.oU)("border.darkCard",gi),Si="white",fi="gray.400",vi=(null===ii||void 0===ii?void 0:ii.clients)||[],Ei=(null===ri||void 0===ri?void 0:ri.emailAddresses)||[],Ci=Ei.filter(e=>{var i;const s=e.email.toLowerCase().includes(Ce.toLowerCase())||(null===(i=e.name)||void 0===i?void 0:i.toLowerCase().includes(Ce.toLowerCase())),r="all"===ze||e.type===ze;let l=!0;"incoming"===Ae?l=e.emailsReceived>0:"outgoing"===Ae&&(l=e.emailsSent>0);let n=!0;"registered"===ke?n=!0===e.isRegisteredWithImprovMX:"unregistered"===ke&&(n=!0!==e.isRegisteredWithImprovMX);let o=!0;return"all"!==Re&&(o=e.forwardingProvider===Re||!e.forwardingProvider&&"NONE"===Re),s&&r&&l&&n&&o}),yi=async(e,i)=>{await pi({variables:{emailId:e,linkedCalendarIds:i}}),ei(null)};return si||li?(0,de.jsx)(f.a,{minH:"100vh",bg:ui,p:6,display:"flex",alignItems:"center",justifyContent:"center",children:(0,de.jsxs)($.T,{spacing:4,children:[(0,de.jsx)(D.y,{size:"xl",color:"blue.400"}),(0,de.jsx)(Z.E,{color:Si,children:"Loading email accounts..."})]})}):(0,de.jsxs)(f.a,{minH:"100vh",bg:ui,children:[(0,de.jsx)(le.m,{}),(0,de.jsx)(oe.y,{moduleConfig:ae.default}),(0,de.jsx)(f.a,{p:{base:4,md:6},children:(0,de.jsxs)($.T,{spacing:{base:4,md:6},align:"stretch",maxW:{base:"100%",lg:"none"},children:[(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontSize:{base:"2xl",md:"3xl"},fontWeight:"bold",color:Si,mb:2,children:"\ud83d\udce7 Email Account Management"}),(0,de.jsx)(Z.E,{color:"gray.300",fontSize:{base:"md",md:"lg"},lineHeight:"1.6",children:"Control which emails your clients can access. Assign specific email addresses to individual clients - they'll only see emails sent to their assigned addresses when they visit their inbox."})]}),(0,de.jsx)(C.Z,{bg:"blue.900",backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:"blue.700",children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsxs)($.T,{align:"start",spacing:3,children:[(0,de.jsxs)(L.z,{children:[(0,de.jsx)(Z.E,{fontSize:"lg",fontWeight:"bold",color:"blue.200",children:"\ud83d\udccb Email Routing & Processing Flow"}),(0,de.jsx)(S.E,{colorScheme:"blue",fontSize:"xs",children:"SINGLE SOURCE OF TRUTH"})]}),(0,de.jsx)(f.a,{pl:4,children:(0,de.jsxs)($.T,{align:"start",spacing:2,children:[(0,de.jsxs)(Z.E,{fontSize:"sm",color:"gray.300",children:[(0,de.jsx)("strong",{children:"1. \ud83c\udfaf Primary Calendar ID:"})," Direct routing to ONE specific calendar (highest priority)"]}),(0,de.jsxs)(Z.E,{fontSize:"sm",color:"gray.300",children:[(0,de.jsx)("strong",{children:"2. \ud83d\udcc5 Linked Calendar IDs:"})," Secondary calendars that may receive events"]}),(0,de.jsxs)(Z.E,{fontSize:"sm",color:"gray.300",children:[(0,de.jsx)("strong",{children:"3. \ud83d\udc65 Associated Clients:"})," Who can VIEW and MANAGE this email (not for routing)"]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",mt:2,children:[(0,de.jsx)("strong",{children:"Processing Order:"})," Incoming email \u2192 Check EmailAddress.primaryCalendarId \u2192 If not set, check linkedCalendarIds \u2192 If none, use associatedClients[0]'s personal calendar"]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"orange.300",mt:2,children:["\u26a0\ufe0f ",(0,de.jsx)("strong",{children:"Important:"})," EmailAddress model is the SINGLE SOURCE OF TRUTH. Client.email is for login only, not email routing."]})]})})]})})}),(0,de.jsxs)(L.z,{spacing:{base:2,md:4},direction:{base:"column",md:"row"},align:"stretch",children:[(0,de.jsx)(C.Z,{bg:bi,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:ji,flex:1,children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsxs)(L.z,{justify:"space-between",children:[(0,de.jsxs)($.T,{align:"start",spacing:1,flex:"1",children:[(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"Tracked Email Addresses"}),(0,de.jsx)(Z.E,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:Si,children:Ei.length}),(0,de.jsx)(Z.E,{fontSize:"2xs",color:"gray.400",display:{base:"none",md:"block"},children:"Auto-detected from incoming emails"})]}),(0,de.jsx)(f.a,{p:{base:2,md:3},borderRadius:"lg",bg:"blue.500",color:"white",children:(0,de.jsx)(Y.pHD,{size:24})})]})})}),(0,de.jsx)(C.Z,{bg:bi,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:ji,flex:1,children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsxs)(L.z,{justify:"space-between",children:[(0,de.jsxs)($.T,{align:"start",spacing:1,flex:"1",children:[(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"Assigned to Clients"}),(0,de.jsx)(Z.E,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:Si,children:Ei.filter(e=>e.associatedClients&&e.associatedClients.length>0).length}),(0,de.jsx)(Z.E,{fontSize:"2xs",color:"gray.400",display:{base:"none",md:"block"},children:"Addresses with client access"})]}),(0,de.jsx)(f.a,{p:{base:2,md:3},borderRadius:"lg",bg:"green.500",color:"white",children:(0,de.jsx)(Y.JXP,{size:24})})]})})}),(0,de.jsx)(C.Z,{bg:bi,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:ji,flex:1,children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsxs)(L.z,{justify:"space-between",children:[(0,de.jsxs)($.T,{align:"start",spacing:1,flex:"1",children:[(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"Unassigned Addresses"}),(0,de.jsx)(Z.E,{fontSize:{base:"xl",md:"2xl"},fontWeight:"bold",color:Si,children:Ei.filter(e=>!e.associatedClients||0===e.associatedClients.length).length}),(0,de.jsx)(Z.E,{fontSize:"2xs",color:"gray.400",display:{base:"none",md:"block"},children:"Need client assignment"})]}),(0,de.jsx)(f.a,{p:{base:2,md:3},borderRadius:"lg",bg:"orange.500",color:"white",children:(0,de.jsx)(Y.pHD,{size:24})})]})})})]}),(0,de.jsx)(C.Z,{bg:bi,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:ji,children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsxs)($.T,{spacing:4,align:"stretch",children:[(0,de.jsx)(w.p,{placeholder:"Search email addresses...",value:Ce,onChange:e=>ye(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,_placeholder:{color:"gray.500"}}),(0,de.jsxs)(L.z,{spacing:3,justifyContent:"space-between",children:[(0,de.jsxs)(L.z,{spacing:3,flex:"1",children:[(0,de.jsxs)(U.l,{value:ke,onChange:e=>Te(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,flex:1,children:[(0,de.jsx)("option",{value:"registered",children:"Registered Only"}),(0,de.jsx)("option",{value:"unregistered",children:"Unregistered Only"}),(0,de.jsx)("option",{value:"all",children:"All Emails"})]}),(0,de.jsxs)(U.l,{value:Re,onChange:e=>Ne(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,flex:1,children:[(0,de.jsx)("option",{value:"all",children:"All Providers"}),(0,de.jsx)("option",{value:"IMPROVMX",children:"ImprovMX"}),(0,de.jsx)("option",{value:"MICROSOFT",children:"Microsoft 365"}),(0,de.jsx)("option",{value:"GOOGLE",children:"Google Workspace"}),(0,de.jsx)("option",{value:"OTHER",children:"Other Provider"}),(0,de.jsx)("option",{value:"NONE",children:"No Provider"})]}),(0,de.jsxs)(U.l,{value:Ae,onChange:e=>we(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,flex:1,children:[(0,de.jsx)("option",{value:"all",children:"All Directions"}),(0,de.jsx)("option",{value:"incoming",children:"Incoming (Sent to us)"}),(0,de.jsx)("option",{value:"outgoing",children:"Outgoing (We sent to)"})]}),(0,de.jsxs)(U.l,{value:ze,onChange:e=>Ie(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,flex:1,children:[(0,de.jsx)("option",{value:"all",children:"All Types"}),(0,de.jsx)("option",{value:"PERSONAL",children:"Personal"}),(0,de.jsx)("option",{value:"BUSINESS",children:"Business"}),(0,de.jsx)("option",{value:"SUPPORT",children:"Support"}),(0,de.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,de.jsx)("option",{value:"NOREPLY",children:"No Reply"})]})]}),(0,de.jsxs)(L.z,{spacing:2,children:[(0,de.jsx)(v.$,{leftIcon:(0,de.jsx)(Y.VSk,{}),colorScheme:"purple",onClick:h,size:"md",variant:"outline",children:"Setup M365 Forwarding"}),(0,de.jsx)(v.$,{leftIcon:(0,de.jsx)(Y.GGD,{}),colorScheme:"blue",onClick:d,size:"md",children:"Create Email"})]})]})]})})}),(0,de.jsx)(C.Z,{bg:bi,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:ji,children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsx)(f.a,{overflowX:"auto",width:"100%",children:(0,de.jsxs)(G.X,{variant:"simple",size:{base:"sm",md:"md"},minWidth:"700px",children:[(0,de.jsx)(K.d,{position:"sticky",top:0,bg:bi,children:(0,de.jsxs)(V.Tr,{children:[(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"180px",children:(0,de.jsx)(q.m,{label:"\ud83d\udce7 email: The email address being tracked. This is the unique identifier for routing emails and calendar invites (Required)",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Email Address"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"80px",children:(0,de.jsx)(q.m,{label:"\ud83d\udcdd type: Categorizes the email (PERSONAL, WORK, SUPPORT, etc). Helps organize and filter email addresses by purpose",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Type"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"120px",children:(0,de.jsx)(q.m,{label:"\ud83c\udf10 Provider: Which service manages this email's forwarding (ImprovMX, Microsoft 365, Google Workspace, etc)",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Provider"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"120px",children:(0,de.jsx)(q.m,{label:"\ud83d\udd17 isRegisteredWithImprovMX: Whether this email is set up with ImprovMX for forwarding. Enables email routing through ImprovMX service",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"ImprovMX"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"150px",children:(0,de.jsx)(q.m,{label:"\ud83d\udcc5 primaryCalendarId: The main calendar where invites to this email are added. Single source of truth for calendar routing",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Primary Calendar"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"100px",children:(0,de.jsx)(q.m,{label:"\ud83d\udd04 linkedCalendarIds: Additional calendars that receive copies of invites. Allows one email to update multiple calendars",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Linked Cals"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"150px",children:(0,de.jsx)(q.m,{label:"\ud83d\udee1\ufe0f Calendar Invite Rules: Controls who can send calendar invites (acceptCalendarInvitesFromAnyone, acceptedSenderEmailsForCalendarInvites, blockedDomainsForCalendarInvites). Prevents spam and unauthorized calendar events",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Invite Rules"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},display:{base:"none",md:"table-cell"},minW:"250px",children:(0,de.jsx)(q.m,{label:"\ud83d\udc65 associatedClients: Links this email to specific clients/users. Determines who can access calendars and emails sent to this address",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Assigned Clients"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},display:{base:"none",lg:"table-cell"},minW:"100px",children:(0,de.jsx)(q.m,{label:"\ud83d\udcca emailsSent/emailsReceived: Tracks email activity statistics. Helps identify active vs inactive email addresses",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Activity"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},display:{base:"none",lg:"table-cell"},minW:"100px",children:(0,de.jsx)(q.m,{label:"\ud83d\udd50 lastSeenAt: When this email was last active. Helps identify stale or abandoned email addresses",placement:"top",hasArrow:!0,children:(0,de.jsx)(Z.E,{children:"Last Seen"})})}),(0,de.jsx)(_.Th,{color:fi,px:{base:2,md:4},fontSize:{base:"xs",md:"sm"},minW:"80px",children:(0,de.jsx)(Z.E,{children:"Actions"})})]})}),(0,de.jsx)(B.N,{children:Ci.map(e=>{var i,s,r,l,o,a;return(0,de.jsxs)(V.Tr,{children:[(0,de.jsx)(H.Td,{px:{base:2,md:4},children:(0,de.jsxs)($.T,{align:"start",spacing:1,children:[(0,de.jsx)(Z.E,{color:Si,fontWeight:"medium",fontSize:{base:"xs",md:"sm"},noOfLines:2,children:e.email}),e.name&&(0,de.jsx)(Z.E,{fontSize:{base:"2xs",md:"xs"},color:"gray.300",noOfLines:1,children:e.name}),(0,de.jsx)(Z.E,{display:{base:"block",md:"none"},fontSize:"2xs",color:"gray.400",children:e.associatedClients&&e.associatedClients.length>0?"".concat(e.associatedClients.length," client(s)"):"Unassigned"})]})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:Ke===e.id?(0,de.jsxs)(U.l,{size:"sm",value:e.type,onChange:i=>(async(e,i)=>{await hi({variables:{emailId:e,type:i}}),Ve(null)})(e.id,i.target.value),onBlur:()=>Ve(null),autoFocus:!0,width:"100px",children:[(0,de.jsx)("option",{value:"BUSINESS",children:"Business"}),(0,de.jsx)("option",{value:"PERSONAL",children:"Personal"}),(0,de.jsx)("option",{value:"SUPPORT",children:"Support"}),(0,de.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,de.jsx)("option",{value:"NOREPLY",children:"No Reply"}),(0,de.jsx)("option",{value:"UNKNOWN",children:"Unknown"})]}):(0,de.jsx)(S.E,{colorScheme:"PERSONAL"===e.type?"blue":"BUSINESS"===e.type?"green":"SUPPORT"===e.type?"yellow":"MARKETING"===e.type?"purple":"gray",variant:"subtle",fontSize:{base:"2xs",md:"xs"},cursor:"pointer",onClick:()=>Ve(e.id),_hover:{opacity:.8},children:"PERSONAL"===e.type?"PERS":"BUSINESS"===e.type?"BIZ":"MARKETING"===e.type?"MKTG":e.type})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:Je===e.id?(0,de.jsxs)(U.l,{size:"sm",value:e.forwardingProvider||"NONE",onChange:i=>(async(e,i)=>{await mi({variables:{emailId:e,provider:i}}),qe(null)})(e.id,i.target.value),onBlur:()=>qe(null),autoFocus:!0,width:"120px",children:[(0,de.jsx)("option",{value:"IMPROVMX",children:"ImprovMX"}),(0,de.jsx)("option",{value:"MICROSOFT",children:"Microsoft 365"}),(0,de.jsx)("option",{value:"GOOGLE",children:"Google"}),(0,de.jsx)("option",{value:"OTHER",children:"Other"}),(0,de.jsx)("option",{value:"NONE",children:"None"})]}):(0,de.jsx)(S.E,{colorScheme:"IMPROVMX"===e.forwardingProvider?"cyan":"MICROSOFT"===e.forwardingProvider?"blue":"GOOGLE"===e.forwardingProvider?"green":"OTHER"===e.forwardingProvider?"orange":"gray",variant:"subtle",fontSize:{base:"2xs",md:"xs"},cursor:"pointer",onClick:()=>qe(e.id),_hover:{opacity:.8},children:"IMPROVMX"===e.forwardingProvider?"ImprovMX":"MICROSOFT"===e.forwardingProvider?"MS 365":"GOOGLE"===e.forwardingProvider?"Google":"OTHER"===e.forwardingProvider?"Other":"None"})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:(0,de.jsxs)($.T,{align:"start",spacing:1,children:[(0,de.jsxs)(L.z,{children:[(0,de.jsx)(X.d,{size:"sm",colorScheme:"green",isChecked:e.isRegisteredWithImprovMX,onChange:()=>(async(e,i)=>{await ci({variables:{emailId:e,isRegistered:!i},optimisticResponse:{updateEmailAddress:{__typename:"EmailAddress",id:e,isRegisteredWithImprovMX:!i}}})})(e.id,e.isRegisteredWithImprovMX)}),(0,de.jsx)(Z.E,{fontSize:"xs",color:e.isRegisteredWithImprovMX?"green.400":"gray.400",children:e.isRegisteredWithImprovMX?"Registered":"Not Registered"})]}),void 0!==e.isVerified&&(0,de.jsx)(S.E,{colorScheme:e.isVerified?"blue":"orange",fontSize:"2xs",variant:"subtle",children:e.isVerified?"Verified":"Unverified"})]})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:Ze===e.id?(0,de.jsxs)(U.l,{size:"sm",value:e.primaryCalendarId||"none",onChange:i=>(async(e,i)=>{await pi({variables:{emailId:e,primaryCalendarId:"none"===i?null:i}}),Ye(null)})(e.id,i.target.value),onBlur:()=>Ye(null),autoFocus:!0,width:"150px",fontSize:"xs",children:[(0,de.jsx)("option",{value:"none",children:"Not set"}),null===oi||void 0===oi||null===(i=oi.calendars)||void 0===i?void 0:i.map(e=>(0,de.jsx)("option",{value:e.id,children:e.name},e.id))]}):(0,de.jsx)(f.a,{cursor:"pointer",onClick:()=>Ye(e.id),_hover:{opacity:.8},children:e.primaryCalendarId?(0,de.jsxs)($.T,{align:"start",spacing:0,children:[(0,de.jsx)(S.E,{colorScheme:"green",fontSize:"xs",variant:"subtle",children:"\ud83c\udfaf Primary"}),(0,de.jsx)(Z.E,{fontSize:"2xs",color:"gray.400",children:(null===oi||void 0===oi||null===(s=oi.calendars)||void 0===s||null===(r=s.find(i=>i.id===e.primaryCalendarId))||void 0===r?void 0:r.name)||e.primaryCalendarId.slice(-6)})]}):(0,de.jsx)(S.E,{colorScheme:"gray",fontSize:"xs",variant:"subtle",children:"Click to set"})})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:Qe===e.id?(0,de.jsxs)($.T,{align:"start",spacing:2,children:[(0,de.jsx)(U.l,{size:"sm",placeholder:"Add calendar...",onChange:i=>{var s;!i.target.value||null!==(s=e.linkedCalendarIds)&&void 0!==s&&s.includes(i.target.value)||yi(e.id,[...e.linkedCalendarIds||[],i.target.value])},width:"150px",fontSize:"xs",children:null===oi||void 0===oi||null===(l=oi.calendars)||void 0===l||null===(o=l.filter(i=>{var s;return!(null!==(s=e.linkedCalendarIds)&&void 0!==s&&s.includes(i.id))}))||void 0===o?void 0:o.map(e=>(0,de.jsx)("option",{value:e.id,children:e.name},e.id))}),(0,de.jsx)($.T,{align:"start",spacing:1,children:null===(a=e.linkedCalendarIds)||void 0===a?void 0:a.map(i=>{var s;const r=null===oi||void 0===oi||null===(s=oi.calendars)||void 0===s?void 0:s.find(e=>e.id===i);return(0,de.jsxs)(L.z,{spacing:1,children:[(0,de.jsx)(S.E,{colorScheme:"blue",fontSize:"2xs",children:(null===r||void 0===r?void 0:r.name)||i.slice(-6)}),(0,de.jsx)(E.K,{"aria-label":"Remove",icon:(0,de.jsx)(Y.IXo,{}),size:"xs",variant:"ghost",onClick:()=>yi(e.id,(e.linkedCalendarIds||[]).filter(e=>e!==i))})]},i)})}),(0,de.jsx)(v.$,{size:"xs",onClick:()=>ei(null),children:"Done"})]}):(0,de.jsx)(f.a,{cursor:"pointer",onClick:()=>ei(e.id),_hover:{opacity:.8},children:e.linkedCalendarIds&&e.linkedCalendarIds.length>0?(0,de.jsxs)($.T,{align:"start",spacing:0,children:[(0,de.jsxs)(S.E,{colorScheme:"blue",fontSize:"xs",variant:"subtle",children:["\ud83d\udcc5 ",e.linkedCalendarIds.length," linked"]}),(0,de.jsx)(Z.E,{fontSize:"2xs",color:"gray.400",children:"Click to edit"})]}):(0,de.jsx)(S.E,{colorScheme:"gray",fontSize:"xs",variant:"subtle",children:"Click to add"})})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:(0,de.jsxs)($.T,{align:"start",spacing:1,children:[e.acceptCalendarInvitesFromAnyone&&(0,de.jsx)(S.E,{colorScheme:"green",fontSize:"xs",children:"Accepts All"}),e.acceptedSenderEmailsForCalendarInvites&&e.acceptedSenderEmailsForCalendarInvites.length>0&&(0,de.jsx)(q.m,{label:"Accepts from: ".concat(e.acceptedSenderEmailsForCalendarInvites.join(", ")),children:(0,de.jsxs)(S.E,{colorScheme:"blue",fontSize:"xs",children:[e.acceptedSenderEmailsForCalendarInvites.length," Allowed"]})}),e.blockedDomainsForCalendarInvites&&e.blockedDomainsForCalendarInvites.length>0&&(0,de.jsx)(q.m,{label:"Blocks: ".concat(e.blockedDomainsForCalendarInvites.join(", ")),children:(0,de.jsxs)(S.E,{colorScheme:"red",fontSize:"xs",children:[e.blockedDomainsForCalendarInvites.length," Blocked"]})}),!e.acceptCalendarInvitesFromAnyone&&(!e.acceptedSenderEmailsForCalendarInvites||0===e.acceptedSenderEmailsForCalendarInvites.length)&&(!e.blockedDomainsForCalendarInvites||0===e.blockedDomainsForCalendarInvites.length)&&(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.500",children:"No rules"})]})}),(0,de.jsx)(H.Td,{display:{base:"none",md:"table-cell"},px:{base:2,md:4},children:(0,de.jsx)($.T,{align:"start",spacing:2,maxW:"250px",children:e.associatedClients&&0!==e.associatedClients.length?e.associatedClients.map(i=>{const s=vi.find(e=>e.id===i);return(0,de.jsx)(f.a,{p:2,borderRadius:"md",bg:"whiteAlpha.50",border:"1px solid",borderColor:ji,width:"100%",children:(0,de.jsxs)(L.z,{justify:"space-between",align:"start",children:[(0,de.jsxs)($.T,{align:"start",spacing:.5,flex:1,children:[(0,de.jsx)(Z.E,{fontSize:"xs",fontWeight:"medium",color:Si,children:s?"".concat(s.fName," ").concat(s.lName):"Unknown Client"}),(null===s||void 0===s?void 0:s.email)&&(0,de.jsx)(Z.E,{fontSize:"2xs",color:"gray.400",noOfLines:1,children:s.email}),(null===s||void 0===s?void 0:s.phoneNumber)&&(0,de.jsxs)(Z.E,{fontSize:"2xs",color:"gray.400",children:["\ud83d\udcf1 ",s.phoneNumber]}),(0,de.jsxs)(Z.E,{fontSize:"2xs",color:"gray.500",children:["ID: ",i]})]}),(0,de.jsx)(E.K,{"aria-label":"Unassign client",icon:(0,de.jsx)(Y.IXo,{}),size:"xs",variant:"ghost",colorScheme:"red",onClick:()=>(async(e,i)=>{await di({variables:{emailId:e,clientId:i}})})(e.id,i)})]})},i)}):(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.400",children:"Unassigned"})})}),(0,de.jsx)(H.Td,{display:{base:"none",lg:"table-cell"},px:{base:2,md:4},children:(0,de.jsxs)($.T,{align:"start",spacing:1,children:[(0,de.jsxs)(Z.E,{fontSize:"xs",color:Si,children:["\ud83d\udce4 ",e.emailsSent," sent"]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:Si,children:["\ud83d\udce5 ",e.emailsReceived," received"]})]})}),(0,de.jsx)(H.Td,{display:{base:"none",lg:"table-cell"},px:{base:2,md:4},children:(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.300",children:e.lastSeenAt?new Date(e.lastSeenAt).toLocaleDateString():"-"})}),(0,de.jsx)(H.Td,{px:{base:2,md:4},children:(0,de.jsxs)(L.z,{spacing:1,children:[!e.isRegisteredWithImprovMX&&(0,de.jsx)(v.$,{leftIcon:(0,de.jsx)(Y.VSk,{}),size:{base:"xs",md:"sm"},variant:"outline",colorScheme:"purple",onClick:()=>{const i=e.postmarkEndpoint||"c167efbd0aabb934087409a8be5588be@inbound.postmarkapp.com";fe({alias:e.email,displayName:e.name||e.email,postmarkEndpoint:i,type:e.type||"BUSINESS"}),p(!0)},fontSize:{base:"xs",md:"sm"},children:"View Microsoft Forwarding Instructions"}),(0,de.jsx)(q.m,{label:"Assign to client",children:(0,de.jsx)(E.K,{"aria-label":"Assign email",icon:(0,de.jsx)(Y.GGD,{}),size:{base:"xs",md:"sm"},variant:"ghost",colorScheme:"blue",minW:{base:"28px",md:"32px"},onClick:()=>(e=>{Ee(e),Pe(""),n()})(e)})})]})})]},e.id)})})]})})})}),(0,de.jsx)(C.Z,{bg:bi,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:ji,children:(0,de.jsx)(y.b,{p:{base:4,md:6},children:(0,de.jsxs)($.T,{align:"start",spacing:{base:2,md:3},children:[(0,de.jsx)(L.z,{children:(0,de.jsx)(Z.E,{fontSize:{base:"md",md:"lg"},fontWeight:"semibold",color:Si,children:"\ud83d\udcda How Email Assignment Works"})}),(0,de.jsxs)($.T,{align:"start",spacing:{base:1,md:2},pl:{base:2,md:4},children:[(0,de.jsxs)(L.z,{align:"start",spacing:{base:2,md:3},children:[(0,de.jsx)(Z.E,{color:"blue.400",fontWeight:"bold",children:"1."}),(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"Email addresses are automatically tracked when emails arrive at your Postmark inbound webhook"})]}),(0,de.jsxs)(L.z,{align:"start",spacing:{base:2,md:3},children:[(0,de.jsx)(Z.E,{color:"blue.400",fontWeight:"bold",children:"2."}),(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"Click the plus button next to any email address to assign it to specific clients"})]}),(0,de.jsxs)(L.z,{align:"start",spacing:{base:2,md:3},children:[(0,de.jsx)(Z.E,{color:"blue.400",fontWeight:"bold",children:"3."}),(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"Clients will only see emails from their assigned addresses in their inbox"})]}),(0,de.jsxs)(L.z,{align:"start",spacing:{base:2,md:3},children:[(0,de.jsx)(Z.E,{color:"blue.400",fontWeight:"bold",children:"4."}),(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.300",children:"System admins always see all emails regardless of assignments"})]})]})]})})}),(0,de.jsxs)(W.aF,{isOpen:l,onClose:o,size:{base:"full",md:"md"},children:[(0,de.jsx)(M.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),(0,de.jsxs)(F.$,{bg:bi,border:"1px solid",borderColor:ji,margin:{base:0,md:"auto"},borderRadius:{base:0,md:"md"},maxH:{base:"100vh",md:"90vh"},children:[(0,de.jsxs)(P.r,{color:Si,fontSize:{base:"lg",md:"xl"},children:["Assign Email: ",null===ve||void 0===ve?void 0:ve.email]}),(0,de.jsx)(N.s,{color:Si}),(0,de.jsx)(R.c,{pb:6,children:(0,de.jsxs)($.T,{spacing:{base:3,md:4},align:"stretch",children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:{base:"sm",md:"md"},children:"Select a client to assign this email address to:"}),(0,de.jsx)(w.p,{placeholder:"Search by name, email, or client ID...",value:Oe,onChange:e=>Pe(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,_placeholder:{color:"gray.500"},mb:2}),(0,de.jsx)($.T,{spacing:2,align:"stretch",maxH:{base:"300px",md:"400px"},overflowY:"auto",children:vi.filter(e=>{var i,s,r,l,n,o;const a=Oe.toLowerCase();return e.id.toLowerCase().includes(a)||null!==(i=null===(s=e.fName)||void 0===s?void 0:s.toLowerCase().includes(a))&&void 0!==i&&i||null!==(r=null===(l=e.lName)||void 0===l?void 0:l.toLowerCase().includes(a))&&void 0!==r&&r||null!==(n=null===(o=e.email)||void 0===o?void 0:o.toLowerCase().includes(a))&&void 0!==n&&n}).map(e=>{var i,s;return(0,de.jsxs)(L.z,{p:{base:3,md:4},borderRadius:"md",border:"1px solid",borderColor:ji,justify:"space-between",bg:"whiteAlpha.50",direction:{base:"column",md:"row"},align:{base:"stretch",md:"center"},spacing:{base:2,md:3},children:[(0,de.jsxs)($.T,{align:{base:"stretch",md:"start"},spacing:1,flex:"1",children:[(0,de.jsxs)(Z.E,{color:Si,fontWeight:"medium",fontSize:{base:"sm",md:"md"},textAlign:{base:"center",md:"left"},children:[e.fName," ",e.lName]}),(0,de.jsx)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.400",textAlign:{base:"center",md:"left"},children:e.email}),e.phoneNumber&&(0,de.jsxs)(Z.E,{fontSize:{base:"xs",md:"sm"},color:"gray.400",textAlign:{base:"center",md:"left"},children:["\ud83d\udcf1 ",e.phoneNumber]}),(0,de.jsxs)(Z.E,{fontSize:{base:"xs",md:"xs"},color:"gray.500",textAlign:{base:"center",md:"left"},children:["ID: ",e.id]})]}),(0,de.jsx)(v.$,{size:{base:"sm",md:"sm"},colorScheme:"blue",width:{base:"100%",md:"auto"},minW:{md:"120px"},onClick:()=>(async e=>{ve&&await ai({variables:{emailId:ve.id,clientId:e}})})(e.id),isDisabled:null===ve||void 0===ve||null===(i=ve.associatedClients)||void 0===i?void 0:i.includes(e.id),children:null!==ve&&void 0!==ve&&null!==(s=ve.associatedClients)&&void 0!==s&&s.includes(e.id)?"Already Assigned":"Assign"})]},e.id)})})]})})]})]}),(0,de.jsxs)(W.aF,{isOpen:a,onClose:t,size:{base:"full",md:"md"},children:[(0,de.jsx)(M.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),(0,de.jsxs)(F.$,{bg:bi,border:"1px solid",borderColor:ji,margin:{base:0,md:"auto"},borderRadius:{base:0,md:"md"},children:[(0,de.jsx)(P.r,{color:Si,fontSize:{base:"lg",md:"xl"},children:"Create New Email Address (ImprovMX)"}),(0,de.jsx)(N.s,{color:Si}),(0,de.jsx)(R.c,{pb:6,children:(0,de.jsxs)($.T,{spacing:4,align:"stretch",children:[(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:"sm",mb:2,children:"Email Alias *"}),(0,de.jsx)(w.p,{placeholder:"e.g., support, info, sales",value:Me,onChange:e=>We(e.target.value.toLowerCase().replace(/[^a-z0-9.-]/g,"")),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,_placeholder:{color:"gray.500"}}),(0,de.jsx)(Z.E,{color:"gray.500",fontSize:"xs",mt:1,children:"Only lowercase letters, numbers, dots and dashes allowed"})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:"sm",mb:2,children:"Display Name (Optional)"}),(0,de.jsx)(w.p,{placeholder:"e.g., Customer Support",value:Fe,onChange:e=>Ue(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,_placeholder:{color:"gray.500"}})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:"sm",mb:2,children:"Email Type"}),(0,de.jsxs)(U.l,{value:De,onChange:e=>Le(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,children:[(0,de.jsx)("option",{value:"BUSINESS",children:"Business"}),(0,de.jsx)("option",{value:"PERSONAL",children:"Personal"}),(0,de.jsx)("option",{value:"SUPPORT",children:"Support"}),(0,de.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,de.jsx)("option",{value:"NOREPLY",children:"No Reply"}),(0,de.jsx)("option",{value:"UNKNOWN",children:"Unknown"})]})]}),(0,de.jsxs)(b.F,{status:"info",bg:"blue.900",border:"1px solid",borderColor:"blue.700",children:[(0,de.jsx)(j._,{}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",color:"blue.200",mb:2,children:"\ud83d\ude80 Automatic ImprovMX Forwarding"}),(0,de.jsxs)($.T,{align:"start",spacing:2,children:[(0,de.jsxs)(Z.E,{fontSize:"sm",color:"blue.100",children:["This option uses ",(0,de.jsx)("strong",{children:"ImprovMX"})," for automatic email forwarding:"]}),(0,de.jsxs)($.T,{align:"start",pl:4,spacing:1,children:[(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.300",children:["\u2705 ",(0,de.jsx)("strong",{children:"Instant setup"})," - forwarding rules created automatically"]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.300",children:["\u2705 ",(0,de.jsx)("strong",{children:"No manual configuration"})," - works immediately"]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.300",children:["\u2705 ",(0,de.jsx)("strong",{children:"Auto-forwards to Postmark"})," for programmatic processing"]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.300",children:["\u2705 ",(0,de.jsx)("strong",{children:"Perfect for new emails"})," not in Microsoft 365"]})]}),(0,de.jsx)(A.c,{borderColor:"blue.600",my:2}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"orange.300",children:["\ud83d\udca1 ",(0,de.jsx)("strong",{children:"Already using Microsoft 365?"}),' Use the purple "Setup M365 Forwarding" button instead to keep emails in your existing Microsoft system.']})]})]})]}),(0,de.jsxs)(L.z,{spacing:3,justify:"flex-end",pt:2,children:[(0,de.jsx)(v.$,{variant:"ghost",onClick:t,color:Si,children:"Cancel"}),(0,de.jsx)(v.$,{colorScheme:"blue",onClick:async()=>{Me.trim()?await ti({variables:{input:{alias:Me,name:Fe||void 0,type:De}}}):r({title:"Error",description:"Please enter an email alias",status:"error",duration:3e3,isClosable:!0})},isDisabled:!Me.trim(),children:"Create Email"})]})]})})]})]}),(0,de.jsxs)(W.aF,{isOpen:c,onClose:m,size:"xl",children:[(0,de.jsx)(M.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),(0,de.jsxs)(F.$,{bg:bi,border:"1px solid",borderColor:ji,children:[(0,de.jsx)(P.r,{color:Si,children:"Setup Microsoft 365 Email Forwarding"}),(0,de.jsx)(N.s,{color:Si}),(0,de.jsx)(R.c,{pb:6,children:(0,de.jsxs)($.T,{spacing:4,align:"stretch",children:[(0,de.jsxs)(b.F,{status:"info",bg:"blue.900",border:"1px solid",borderColor:"blue.700",children:[(0,de.jsx)(j._,{}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Manual Setup Required"}),(0,de.jsx)(Z.E,{fontSize:"sm",children:"This will generate instructions for configuring email forwarding in Microsoft 365 to Postmark."})]})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:"sm",mb:2,children:"Forwarding Type"}),(0,de.jsxs)(U.l,{value:$e,onChange:e=>Xe(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,children:[(0,de.jsx)("option",{value:"SHARED",children:"Shared Mailbox (Team Access)"}),(0,de.jsx)("option",{value:"DISTRIBUTION",children:"Distribution List (Multiple Recipients)"}),(0,de.jsx)("option",{value:"PERSONAL",children:"Personal Alias (Single User)"})]})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:"sm",mb:2,children:"Email Alias"}),(0,de.jsxs)(L.z,{children:[(0,de.jsx)(w.p,{placeholder:"support",value:Ge,onChange:e=>Be(e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,_placeholder:{color:"gray.500"}}),(0,de.jsx)(Z.E,{color:"gray.400",children:"@vanguardiq.com.au"})]})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{color:"gray.300",fontSize:"sm",mb:2,children:"Display Name"}),(0,de.jsx)(w.p,{placeholder:"Support Team",value:He,onChange:e=>_e(e.target.value),bg:"whiteAlpha.100",border:"1px solid",borderColor:ji,color:Si,_placeholder:{color:"gray.500"}})]}),(0,de.jsxs)(b.F,{status:"info",bg:"purple.900",border:"1px solid",borderColor:"purple.700",fontSize:"sm",children:[(0,de.jsx)(j._,{}),(0,de.jsxs)(f.a,{children:[("SUPPORT"===(null===ie||void 0===ie?void 0:ie.type)||"SHARED"===(null===ie||void 0===ie?void 0:ie.type))&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Shared Mailbox"}),(0,de.jsx)(Z.E,{children:"Perfect for support@, info@, sales@. Multiple people can access without extra licenses."})]}),("BUSINESS"===(null===ie||void 0===ie?void 0:ie.type)||"DISTRIBUTION"===(null===ie||void 0===ie?void 0:ie.type))&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Distribution List"}),(0,de.jsx)(Z.E,{children:"Emails forward to all list members. Great for team@, alerts@."})]}),"PERSONAL"===(null===ie||void 0===ie?void 0:ie.type)&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Personal Alias"}),(0,de.jsx)(Z.E,{children:"Additional email address for an existing user mailbox."})]})]})]})]})}),(0,de.jsxs)(O.j,{children:[(0,de.jsx)(v.$,{variant:"ghost",mr:3,onClick:m,color:Si,children:"Cancel"}),(0,de.jsx)(v.$,{colorScheme:"purple",onClick:async()=>{if(!Ge.trim())return void r({title:"Error",description:"Please enter an email alias",status:"error",duration:3e3,isClosable:!0});const e="c167efbd0aabb934087409a8be5588be@inbound.postmarkapp.com",i="".concat(Ge,"@vanguardiq.com.au");if(Ei.find(e=>e.email===i))return r({title:"Email Already Exists",description:"The email ".concat(i," already exists in the system. You can click on it to view setup instructions."),status:"warning",duration:5e3,isClosable:!0}),void m();console.log("Creating M365 forwarding with:",{email:i,name:He||Ge,type:"SHARED"===$e?"SUPPORT":"DISTRIBUTION"===$e?"BUSINESS":"PERSONAL",postmarkEndpoint:e,isRegisteredWithImprovMX:!1,isVerified:!0});try{var s;const r=await xi({variables:{input:{email:i,name:He||Ge,type:"SHARED"===$e?"SUPPORT":"DISTRIBUTION"===$e?"BUSINESS":"PERSONAL",postmarkEndpoint:e,isRegisteredWithImprovMX:!1,isVerified:!0,forwardingProvider:"MICROSOFT"}}});console.log("Created email successfully:",r.data),null!==(s=r.data)&&void 0!==s&&s.createEmailAddress&&(fe({alias:i,displayName:He||Ge,postmarkEndpoint:e,type:"SHARED"===$e?"SUPPORT":"DISTRIBUTION"===$e?"BUSINESS":"PERSONAL"}),p(!0))}catch(l){console.error("Error creating M365 forwarding:",l)}},isDisabled:!Ge,children:"Create Email & Save"})]})]})]}),(0,de.jsxs)(W.aF,{isOpen:x,onClose:()=>p(!1),size:"2xl",children:[(0,de.jsx)(M.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px)"}),(0,de.jsxs)(F.$,{bg:bi,border:"1px solid",borderColor:ji,maxH:"90vh",overflowY:"auto",children:[(0,de.jsxs)(P.r,{color:Si,children:["Setup Instructions for ",null===ie||void 0===ie?void 0:ie.alias]}),(0,de.jsx)(N.s,{color:Si}),(0,de.jsx)(R.c,{pb:6,children:(0,de.jsxs)($.T,{spacing:6,align:"stretch",children:[(0,de.jsxs)(b.F,{status:"success",bg:"green.900",border:"1px solid",borderColor:"green.700",children:[(0,de.jsx)(j._,{}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Postmark Endpoint Created"}),(0,de.jsx)(z.C,{colorScheme:"green",bg:"green.800",children:null===ie||void 0===ie?void 0:ie.postmarkEndpoint})]})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",mb:3,color:Si,children:"Setup Steps in Microsoft 365 Admin Center:"}),(0,de.jsxs)(T._J,{spacing:3,color:"gray.300",children:[(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Open Microsoft 365 Admin Center"}),(0,de.jsxs)(k.N,{href:"https://admin.microsoft.com/Adminportal/Home#/users",isExternal:!0,color:"blue.400",children:["Go to Admin Center ",(0,de.jsx)(Y.HaR,{style:{display:"inline"}})]})]}),("SUPPORT"===(null===ie||void 0===ie?void 0:ie.type)||"SHARED"===(null===ie||void 0===ie?void 0:ie.type))&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Create a Shared Mailbox"}),(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.400",children:"Navigate to Teams & Groups \u2192 Shared mailboxes \u2192 Add a shared mailbox"}),(0,de.jsxs)(Z.E,{fontSize:"sm",mt:1,children:["\u2022 Name: ",(0,de.jsx)(z.C,{children:null===ie||void 0===ie?void 0:ie.displayName})]}),(0,de.jsxs)(Z.E,{fontSize:"sm",children:["\u2022 Email: ",(0,de.jsx)(z.C,{children:null===ie||void 0===ie||null===(e=ie.alias)||void 0===e?void 0:e.replace("@vanguardiq.com.au","")})]})]}),(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Add Members to the Shared Mailbox"}),(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.400",children:"Add users who need to access this mailbox"})]})]}),("BUSINESS"===(null===ie||void 0===ie?void 0:ie.type)||"DISTRIBUTION"===(null===ie||void 0===ie?void 0:ie.type))&&(0,de.jsxs)(de.Fragment,{children:[(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Create a Distribution List"}),(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.400",children:"Navigate to Teams & Groups \u2192 Distribution lists \u2192 Add a group"}),(0,de.jsxs)(Z.E,{fontSize:"sm",mt:1,children:["\u2022 Name: ",(0,de.jsx)(z.C,{children:null===ie||void 0===ie?void 0:ie.displayName})]}),(0,de.jsxs)(Z.E,{fontSize:"sm",children:["\u2022 Email: ",(0,de.jsx)(z.C,{children:null===ie||void 0===ie||null===(i=ie.alias)||void 0===i?void 0:i.replace("@vanguardiq.com.au","")})]})]}),(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Add Members to the List"}),(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.400",children:"Add all recipients who should receive emails sent to this list"})]})]}),"PERSONAL"===(null===ie||void 0===ie?void 0:ie.type)&&(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Add Alias to User Mailbox"}),(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.400",children:"Navigate to Users \u2192 Active users \u2192 Select user \u2192 Manage email addresses"}),(0,de.jsxs)(Z.E,{fontSize:"sm",mt:1,children:["Add alias: ",(0,de.jsx)(z.C,{children:null===ie||void 0===ie?void 0:ie.alias})]})]}),(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Setup Mail Flow Rule for Postmark"}),(0,de.jsxs)($.T,{align:"start",spacing:2,mt:2,children:[(0,de.jsxs)(b.F,{status:"warning",bg:"orange.900",border:"1px solid",borderColor:"orange.700",fontSize:"sm",children:[(0,de.jsx)(j._,{}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Important: Switch to Exchange Admin Center"}),(0,de.jsx)(Z.E,{fontSize:"xs",children:"You're currently in Microsoft 365 Admin. Click below to go to Exchange Admin:"})]})]}),(0,de.jsxs)(k.N,{href:"https://admin.exchange.microsoft.com/#/mailflow/rules",isExternal:!0,color:"blue.400",fontSize:"sm",fontWeight:"bold",children:["\u2192 Open Exchange Admin Center - Mail Flow Rules ",(0,de.jsx)(Y.HaR,{style:{display:"inline"}})]}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'Or from Microsoft 365 Admin: Click "Show all" in left menu \u2192 "Exchange" \u2192 "Mail flow" \u2192 "Rules"'})]}),(0,de.jsxs)(f.a,{bg:"gray.800",p:3,borderRadius:"md",mt:3,children:[(0,de.jsx)(Z.E,{fontSize:"sm",color:"gray.200",fontWeight:"bold",mb:2,children:"Detailed Steps in Exchange Admin Center:"}),(0,de.jsxs)($.T,{align:"stretch",spacing:3,pl:2,children:[(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontSize:"sm",color:"blue.300",fontWeight:"semibold",children:"Step 1: Create New Rule"}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Click "+ Add a rule" button'}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Select "Create a new rule"'})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontSize:"sm",color:"blue.300",fontWeight:"semibold",children:"Step 2: Set Rule Conditions"}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 ",(0,de.jsx)("strong",{children:"Name:"})," ",(0,de.jsxs)(z.C,{fontSize:"xs",children:["Forward ",null===ie||void 0===ie||null===(s=ie.alias)||void 0===s?void 0:s.replace("@vanguardiq.com.au","")," to Postmark"]})]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 ",(0,de.jsx)("strong",{children:"Apply this rule if:"}),' Select "The recipient..." \u2192 "address contains any of these words"']}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",pl:4,children:["\u2192 Enter: ",(0,de.jsx)(z.C,{fontSize:"xs",children:null===ie||void 0===ie?void 0:ie.alias})]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 ",(0,de.jsx)("strong",{children:"Do the following:"}),' Select "Redirect the message to..." \u2192 "Select one"']}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",pl:4,children:["\u2192 Click in the field and type/paste: ",(0,de.jsx)(z.C,{fontSize:"xs",children:null===ie||void 0===ie?void 0:ie.postmarkEndpoint})]}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",pl:4,children:"\u2192 Press Enter or semicolon (;) to add it"}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",pl:4,children:'\u2192 Click "Save" to confirm the recipient'})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontSize:"sm",color:"blue.300",fontWeight:"semibold",children:"Step 3: Configure Rule Settings"}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Click "Next" to go to settings page'}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 ",(0,de.jsx)("strong",{children:"Rule mode:"})," Select ",(0,de.jsx)(S.E,{colorScheme:"green",fontSize:"xs",children:"Enforce"})]}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 ",(0,de.jsx)("strong",{children:"Severity:"}),' Leave as "Not specified"']}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 ",(0,de.jsx)("strong",{children:"Stop processing more rules:"})," ",(0,de.jsx)(S.E,{colorScheme:"orange",fontSize:"xs",children:"CHECK THIS BOX"})," (Important!)"]}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:"\u2022 Leave other settings as default"})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontSize:"sm",color:"blue.300",fontWeight:"semibold",children:"Step 4: Optional - Keep a Copy"}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Back in rule conditions, click "+ Add action"'}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Select "Bcc the message to..." or "Send a copy to..."'}),(0,de.jsxs)(Z.E,{fontSize:"xs",color:"gray.400",children:["\u2022 Add: ",(0,de.jsx)(z.C,{fontSize:"xs",children:null===ie||void 0===ie?void 0:ie.alias})," (your shared mailbox)"]})]}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontSize:"sm",color:"blue.300",fontWeight:"semibold",children:"Step 5: Finish"}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Click "Next" to review'}),(0,de.jsx)(Z.E,{fontSize:"xs",color:"gray.400",children:'\u2022 Click "Finish" or "Save" to create the rule'})]})]})]})]}),(0,de.jsxs)(T.ck,{children:[(0,de.jsx)(Z.E,{fontWeight:"semibold",children:"Test the Configuration"}),(0,de.jsxs)(Z.E,{fontSize:"sm",color:"gray.400",children:["Send a test email to ",(0,de.jsx)(z.C,{children:null===ie||void 0===ie?void 0:ie.alias})," and verify:"]}),(0,de.jsxs)($.T,{align:"stretch",spacing:1,pl:4,mt:1,children:[(0,de.jsx)(Z.E,{fontSize:"sm",children:"\u2713 Email arrives in the mailbox"}),(0,de.jsx)(Z.E,{fontSize:"sm",children:"\u2713 Copy is forwarded to Postmark endpoint"}),(0,de.jsx)(Z.E,{fontSize:"sm",children:"\u2713 Check Postmark activity logs"})]})]})]})]}),(0,de.jsx)(A.c,{borderColor:ji}),(0,de.jsxs)(b.F,{status:"warning",bg:"orange.900",border:"1px solid",borderColor:"orange.700",children:[(0,de.jsx)(j._,{}),(0,de.jsxs)(f.a,{children:[(0,de.jsx)(Z.E,{fontWeight:"bold",children:"Important Notes:"}),(0,de.jsx)(Z.E,{fontSize:"sm",children:"\u2022 Changes may take 15-30 minutes to propagate in Microsoft 365"}),(0,de.jsx)(Z.E,{fontSize:"sm",children:"\u2022 The Postmark endpoint will process incoming emails programmatically"}),(0,de.jsx)(Z.E,{fontSize:"sm",children:"\u2022 Keep a copy in the mailbox for backup and manual review"})]})]}),(0,de.jsxs)(L.z,{justify:"space-between",children:[(0,de.jsx)(v.$,{onClick:()=>{return e=null===ie||void 0===ie?void 0:ie.postmarkEndpoint,navigator.clipboard.writeText(e),void r({title:"Copied",description:"Address copied to clipboard",status:"info",duration:2e3});var e},leftIcon:(0,de.jsx)(Y.nxz,{}),variant:"outline",colorScheme:"purple",children:"Copy Postmark Endpoint"}),(0,de.jsx)(v.$,{colorScheme:"blue",onClick:()=>{p(!1),fe(null)},children:"Done"})]})]})})]})]})]})}),(0,de.jsx)(ne.n,{})]})}}}]);
//# sourceMappingURL=8692.ce1f8af2.chunk.js.map