"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[7283],{49664:(e,r,s)=>{s.r(r),s.d(r,{default:()=>O});var o,l,i=s(57528),n=s(65043),t=s(27024),a=s(87139),c=s(22107),d=s(98662),b=s(83169),g=s(24330),x=s(26201),h=s(68659),m=s(44093),p=s(98939),j=s(73212),u=s(25011),f=s(57371),k=s(99032),E=s(96148),C=s(10202),y=s(30502),v=s(28846),z=s(39081),S=s(31881),P=s(10585),w=s(70459),N=s(73216),A=s(52003),D=s(63295),T=s(95214),B=s(1009),F=s(26312),I=s(39985),_=s(29066),U=s(66037),R=s(70579);const W=(0,w.J1)(o||(o=(0,i.A)(["\n  query GetAllProjects {\n    projects {\n      id\n      projectName\n      projectGoal\n      progress\n      billingClient {\n        id\n        fName\n        lName\n        email\n        businessName\n      }\n      members {\n        id\n        fName\n        lName\n        email\n      }\n      tasks {\n        id\n        description\n        status\n        assignedTo {\n          id\n          fName\n          lName\n        }\n        billed\n      }\n      bills {\n        id\n        lineItems {\n          id\n          amount\n        }\n        isPaid\n        status\n      }\n    }\n  }\n"]))),$=(0,w.J1)(l||(l=(0,i.A)(["\n  mutation DeleteProject($id: ID!) {\n    deleteProject(id: $id)\n  }\n"]))),G=e=>{var r,s;let{project:o,onDelete:l}=e;(0,y.d)();const i=(0,N.Zp)(),{colorMode:n}=(0,m.G6)(),h=(0,I.oU)("background.cardGradient",n),p=(0,I.oU)("border.darkCard",n),k=(0,I.oU)("light"===n?"text.primary":"text.primaryDark",n),S=(0,I.oU)("light"===n?"text.secondary":"text.secondaryDark",n),P=(0,I.oU)("light"===n?"text.muted":"text.mutedDark",n),w=(e,r)=>{e.stopPropagation(),"delete"===r?window.confirm("Are you sure you want to delete this project?")&&l():i("/project/".concat(o.id))};console.log("Project ".concat(o.projectName,":"),{tasks:o.tasks,taskCount:(null===(r=o.tasks)||void 0===r?void 0:r.length)||0,bills:o.bills,members:o.members});const A=o.tasks.filter(e=>"COMPLETED"===e.status).length,D=o.tasks.filter(e=>e.billed).length,T=o.bills.filter(e=>"SENT"===e.status||e.isPaid),F=T.reduce((e,r)=>{var s;return e+((null===(s=r.lineItems)||void 0===s?void 0:s.reduce((e,r)=>e+(r.amount||0),0))||0)},0),_=T.filter(e=>e.isPaid).length;return console.log("Project ".concat(o.projectName," billing:"),{allBills:o.bills.length,actualBills:T.length,sentBills:o.bills.filter(e=>"SENT"===e.status).length,paidBills:o.bills.filter(e=>e.isPaid).length,draftBills:o.bills.filter(e=>"DRAFT"===e.status&&!e.isPaid).length,proposalBills:o.bills.filter(e=>"PROPOSAL"===e.status&&!e.isPaid).length,totalBilled:F}),(0,R.jsxs)(b.Z,{bg:h,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:p,borderRadius:"lg",cursor:"pointer",onClick:e=>w(e,"view"),_hover:{transform:"translateY(-4px)",boxShadow:"0 12px 40px 0 rgba(0, 0, 0, 0.5)",borderColor:S,transition:"all 0.2s"},transition:"all 0.2s",children:[(0,R.jsx)(x.a,{children:(0,R.jsxs)(E.z,{justify:"space-between",width:"full",children:[(0,R.jsxs)(C.T,{align:"start",spacing:2,children:[(0,R.jsx)(v.D,{size:"md",color:k,fontFamily:I.Kk.fonts.heading,children:o.projectName}),(0,R.jsxs)(E.z,{spacing:2,flexWrap:"wrap",children:[o.billingClient.businessName&&(0,R.jsx)(a.E,{bg:"rgba(59, 130, 246, 0.2)",color:"#3B82F6",border:"1px solid",borderColor:"rgba(59, 130, 246, 0.3)",children:o.billingClient.businessName}),(0,R.jsxs)(a.E,{bg:"rgba(251, 146, 60, 0.2)",color:"#FB923C",border:"1px solid",borderColor:"rgba(251, 146, 60, 0.3)",fontSize:"sm",px:2,py:1,children:[(null===(s=o.tasks)||void 0===s?void 0:s.length)||0," Total Tasks"]}),(0,R.jsxs)(a.E,{bg:"rgba(34, 197, 94, 0.2)",color:"#22C55E",border:"1px solid",borderColor:"rgba(34, 197, 94, 0.3)",fontSize:"sm",px:2,py:1,children:[A," Completed"]}),(0,R.jsxs)(a.E,{bg:"rgba(168, 85, 247, 0.2)",color:"#A855F7",border:"1px solid",borderColor:"rgba(168, 85, 247, 0.3)",fontSize:"sm",px:2,py:1,children:["$",F.toLocaleString()," Billed"]})]})]}),(0,R.jsx)(d.$,{size:"sm",variant:"ghost",onClick:e=>w(e,"delete"),color:"#EF4444",_hover:{bg:"rgba(239, 68, 68, 0.2)",color:"#EF4444"},children:(0,R.jsx)(u.I,{as:B.IXo})})]})}),(0,R.jsx)(g.b,{children:(0,R.jsxs)(C.T,{align:"start",spacing:4,children:[(0,R.jsx)(z.E,{noOfLines:2,color:S,fontFamily:I.Kk.fonts.body,children:o.projectGoal}),(0,R.jsxs)(c.a,{width:"full",children:[(0,R.jsxs)(E.z,{justify:"space-between",mb:1,children:[(0,R.jsx)(z.E,{fontSize:"sm",fontWeight:"medium",color:k,children:"Project Progress"}),(0,R.jsxs)(z.E,{fontSize:"sm",color:S,children:[o.progress||0,"%"]})]}),(0,R.jsx)(f.k,{value:o.progress||0,size:"sm",colorScheme:(o.progress||0)>=100?"green":(o.progress||0)>=50?"blue":"yellow",borderRadius:"full",hasStripe:!0,isAnimated:!0})]}),(0,R.jsxs)(j.r,{columns:4,spacing:4,width:"full",children:[(0,R.jsxs)(C.T,{children:[(0,R.jsx)(u.I,{as:B.cfS,color:"#3B82F6",boxSize:5}),(0,R.jsx)(z.E,{fontWeight:"bold",color:k,children:o.members.length}),(0,R.jsx)(z.E,{fontSize:"sm",color:P,children:"Members"})]}),(0,R.jsxs)(C.T,{children:[(0,R.jsx)(u.I,{as:B.A3x,color:"#22C55E",boxSize:5}),(0,R.jsxs)(z.E,{fontWeight:"bold",color:k,children:[A,"/",o.tasks.length]}),(0,R.jsx)(z.E,{fontSize:"sm",color:P,children:"Tasks Done"})]}),(0,R.jsxs)(C.T,{children:[(0,R.jsx)(u.I,{as:B.z8N,color:"#A855F7",boxSize:5}),(0,R.jsxs)(z.E,{fontWeight:"bold",color:k,children:["$",F]}),(0,R.jsx)(z.E,{fontSize:"sm",color:P,children:"Billed"})]}),(0,R.jsxs)(C.T,{children:[(0,R.jsx)(u.I,{as:B.A3x,color:"#14B8A6",boxSize:5}),(0,R.jsxs)(z.E,{fontWeight:"bold",color:k,children:[D,"/",o.tasks.length]}),(0,R.jsx)(z.E,{fontSize:"sm",color:P,children:"Tasks Billed"})]})]}),(0,R.jsxs)(E.z,{spacing:2,wrap:"wrap",children:[o.members.slice(0,3).map(e=>(0,R.jsx)(t.e,{size:"sm",name:"".concat(e.fName," ").concat(e.lName),title:"".concat(e.fName," ").concat(e.lName),bg:"#3B82F6"},e.id)),o.members.length>3&&(0,R.jsx)(t.e,{size:"sm",name:"+".concat(o.members.length-3),bg:P})]}),T.length>0&&(0,R.jsxs)(E.z,{spacing:2,children:[(0,R.jsxs)(a.E,{bg:_===T.length?"rgba(34, 197, 94, 0.2)":"rgba(251, 191, 36, 0.2)",color:_===T.length?"#22C55E":"#FBBF24",border:"1px solid",borderColor:_===T.length?"rgba(34, 197, 94, 0.3)":"rgba(251, 191, 36, 0.3)",children:[_,"/",T.length," Bills Paid"]}),(0,R.jsxs)(a.E,{bg:"rgba(59, 130, 246, 0.2)",color:"#3B82F6",border:"1px solid",borderColor:"rgba(59, 130, 246, 0.3)",children:[D,"/",o.tasks.length," Tasks Billed"]})]})]})})]})},O=()=>{var e,r,s;(0,U.H)("Projects");const o=(0,y.d)(),l=(0,N.Zp)(),{loading:i,isAuthenticated:t,user:a}=(0,_.A)(),{loading:b,error:g,data:x,refetch:m}=(0,P.IT)(W,{skip:!t||!(null!==a&&void 0!==a&&null!==(e=a.permissions)&&void 0!==e&&e.includes("PROJECTS_ADMIN"))}),f=(0,I.oU)("background.main"),w=(0,I.oU)("background.cardGradient"),O=(0,I.oU)("border.darkCard"),M=(0,I.oU)("text.primaryDark"),J=(0,I.oU)("text.secondaryDark"),L=(0,I.oU)("text.mutedDark");(0,n.useEffect)(()=>{var e;i||t?!i&&t&&(null===a||void 0===a||null===(e=a.permissions)||void 0===e||e.includes("PROJECTS_ADMIN")):(o({title:"Authentication required",description:"Please log in to access projects",status:"warning",duration:3e3}),l("/"))},[i,t,a,l,o]);const[Y]=(0,S.n)($,{onCompleted:()=>{o({title:"Project deleted",status:"success",duration:3e3,isClosable:!0}),m()},onError:e=>{o({title:"Error deleting project",description:e.message,status:"error",duration:5e3,isClosable:!0})}});return g?(console.error("GraphQL Error:",g),(0,R.jsxs)(z.E,{children:["Error: ",g.message]})):(0,R.jsxs)(c.a,{bg:f,minHeight:"100vh",display:"flex",flexDirection:"column",children:[(0,R.jsx)(A.m,{}),(0,R.jsx)(T.y,{moduleConfig:F.default}),(0,R.jsx)(p.m,{maxW:"container.xl",py:12,flex:"1",children:i||!t||null!==a&&void 0!==a&&null!==(r=a.permissions)&&void 0!==r&&r.includes("PROJECTS_ADMIN")?(0,R.jsxs)(C.T,{spacing:8,align:"stretch",children:[(0,R.jsxs)(E.z,{justify:"space-between",children:[(0,R.jsx)(v.D,{size:"lg",color:M,fontFamily:I.Kk.fonts.heading,children:"\ud83d\udcc2 Projects"}),(0,R.jsx)(d.$,{bg:"white",color:"black",_hover:{bg:"gray.100",transform:"translateY(-2px)"},_active:{transform:"translateY(1px)"},onClick:()=>l("/projects/new"),size:"lg",fontFamily:I.Kk.fonts.body,boxShadow:"0 2px 4px rgba(255, 255, 255, 0.1)",children:"New Project"})]}),b?(0,R.jsx)(j.r,{columns:{base:1,md:2,lg:3},spacing:6,children:[...Array(6)].map((e,r)=>(0,R.jsx)(k.E,{height:"300px",borderRadius:"lg"},r))}):(0,R.jsx)(j.r,{columns:{base:1,md:2,lg:3},spacing:6,children:null===x||void 0===x?void 0:x.projects.map(e=>(0,R.jsx)(G,{project:e,onDelete:()=>(async e=>{try{await Y({variables:{id:e}})}catch(g){console.error("Error deleting project:",g)}})(e.id)},e.id))}),!b&&0===(null===x||void 0===x||null===(s=x.projects)||void 0===s?void 0:s.length)&&(0,R.jsxs)(c.a,{textAlign:"center",py:12,px:6,borderWidth:"1px",borderRadius:"lg",borderStyle:"dashed",borderColor:O,bg:w,backdropFilter:"blur(10px)",children:[(0,R.jsx)(u.I,{as:B.A3x,boxSize:12,color:"#3B82F6",mb:4}),(0,R.jsx)(v.D,{as:"h4",size:"md",mb:2,color:M,children:"No projects yet"}),(0,R.jsx)(z.E,{color:L,mb:4,children:"Start by creating your first project to organize your work"}),(0,R.jsx)(d.$,{bg:"white",color:"black",_hover:{bg:"gray.100",transform:"translateY(-2px)"},onClick:()=>l("/projects/new"),children:"Create First Project"})]})]}):(0,R.jsx)(h.o,{minH:"50vh",children:(0,R.jsxs)(C.T,{spacing:6,children:[(0,R.jsx)(u.I,{as:B.F5$,boxSize:16,color:L}),(0,R.jsx)(v.D,{size:"lg",color:M,children:"Access Denied"}),(0,R.jsx)(z.E,{color:L,textAlign:"center",maxW:"md",children:"You need PROJECTS_ADMIN permission to access this page. Please contact your administrator to request access."}),(0,R.jsx)(d.$,{onClick:()=>l("/"),variant:"outline",borderColor:O,color:M,_hover:{borderColor:J,bg:"rgba(255, 255, 255, 0.05)"},children:"Go to Home"})]})})}),(0,R.jsx)(D.n,{})]})}}}]);
//# sourceMappingURL=7283.39fa59d5.chunk.js.map