"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[6035],{66035:(n,i,r)=>{r.r(i),r.d(i,{default:()=>H});var e,t,s,o,a=r(57528),l=r(65043),c=r(31881),d=r(10585),u=r(70459),p=r(73216),x=r(88787),h=r(85871),m=r(87139),j=r(22107),g=r(98662),f=r(42703),b=r(83169),E=r(24330),T=r(44093),y=r(98939),C=r(82459),D=r(43533),S=r(25527),v=r(76659),I=r(96148),w=r(10202),k=r(19077),z=r(30502),N=r(47726),L=r(28846),U=r(39081),A=r(1009),P=r(39985),R=r(52003),F=r(63295),O=r(95214),G=r(86253),W=r(70579);const $=(0,u.J1)(e||(e=(0,a.A)(["\n  query GetTranscription($id: ID!) {\n    transcription(id: $id) {\n      id\n      title\n      description\n      audioUrl\n      fileName\n      fileSize\n      duration\n      transcription\n      status\n      errorMessage\n      detectedLanguage\n      confidence\n      processingTime\n      createdAt\n      updatedAt\n      owner {\n        id\n        fName\n        lName\n      }\n    }\n  }\n"]))),_=(0,u.J1)(t||(t=(0,a.A)(["\n  mutation RetryTranscription($id: ID!) {\n    retryTranscription(id: $id) {\n      id\n      status\n    }\n  }\n"]))),M=(0,u.J1)(s||(s=(0,a.A)(["\n  mutation TranscribeAudio($input: TranscriptionUploadInput!) {\n    transcribeAudio(input: $input) {\n      id\n      status\n      transcription\n    }\n  }\n"]))),Z=(0,u.J1)(o||(o=(0,a.A)(["\n  mutation DeleteTranscription($id: ID!) {\n    deleteTranscription(id: $id)\n  }\n"]))),H=()=>{var n;const{id:i}=(0,p.g)(),r=(0,p.Zp)(),e=(0,z.d)(),{colorMode:t}=(0,T.G6)(),s=(0,P.oU)("background.main",t),o=(0,P.oU)("background.cardGradient",t),a=(0,P.oU)("border.darkCard",t),u=(0,P.oU)("light"===t?"text.primary":"text.primaryDark",t),H=(0,P.oU)("light"===t?"text.secondary":"text.secondaryDark",t),J=((0,P.oU)("light"===t?"text.muted":"text.mutedDark",t),(0,P.oU)("primary",t)),{data:K,loading:B,error:q,refetch:X}=(0,d.IT)($,{variables:{id:i}});l.useEffect(()=>{var n,i;if("PROCESSING"===(null===K||void 0===K||null===(n=K.transcription)||void 0===n?void 0:n.status)||"UPLOADING"===(null===K||void 0===K||null===(i=K.transcription)||void 0===i?void 0:i.status)){const n=setInterval(()=>{X()},5e3);return()=>clearInterval(n)}},[null===K||void 0===K||null===(n=K.transcription)||void 0===n?void 0:n.status,X]);const[Y,{loading:Q}]=(0,c.n)(_,{onCompleted:()=>{e({title:"Transcription restarted",status:"success",duration:3e3}),X()},onError:n=>{e({title:"Error retrying transcription",description:n.message,status:"error",duration:5e3})}}),[V,{loading:nn}]=(0,c.n)(M,{onCompleted:()=>{e({title:"Transcription started!",description:"Your audio is being transcribed. This may take a few minutes.",status:"success",duration:5e3}),X()},onError:n=>{e({title:"Error starting transcription",description:n.message,status:"error",duration:5e3})}}),[rn,{loading:en}]=(0,c.n)(Z,{onCompleted:()=>{e({title:"Transcription deleted",status:"success",duration:3e3}),r("/transcriptions")},onError:n=>{e({title:"Error deleting transcription",description:n.message,status:"error",duration:5e3})}}),tn=()=>{var n;if(null===K||void 0===K||null===(n=K.transcription)||void 0===n||!n.transcription)return;const i=new Blob([K.transcription.transcription],{type:"text/plain"}),r=window.URL.createObjectURL(i),t=document.createElement("a");t.href=r,t.download="".concat(K.transcription.title||"transcription",".txt"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(r),e({title:"Download started",status:"success",duration:2e3})},sn=()=>{window.confirm("Are you sure you want to retry this transcription?")&&Y({variables:{id:i}})};if(B)return(0,W.jsxs)(j.a,{bg:s,minH:"100vh",display:"flex",flexDirection:"column",children:[(0,W.jsx)(R.m,{}),(0,W.jsx)(O.y,{moduleConfig:G.default}),(0,W.jsx)(j.a,{flex:"1",display:"flex",alignItems:"center",justifyContent:"center",children:(0,W.jsxs)(w.T,{spacing:4,children:[(0,W.jsx)(v.y,{size:"xl",color:J}),(0,W.jsx)(U.E,{color:H,children:"Loading transcription..."})]})}),(0,W.jsx)(F.n,{})]});if(q||null===K||void 0===K||!K.transcription)return(0,W.jsxs)(j.a,{bg:s,minH:"100vh",display:"flex",flexDirection:"column",children:[(0,W.jsx)(R.m,{}),(0,W.jsx)(O.y,{moduleConfig:G.default}),(0,W.jsxs)(y.m,{maxW:"container.md",flex:"1",py:8,children:[(0,W.jsxs)(x.F,{status:"error",borderRadius:"lg",children:[(0,W.jsx)(h._,{}),(0,W.jsxs)(w.T,{align:"start",children:[(0,W.jsx)(U.E,{fontWeight:"bold",children:"Error loading transcription"}),(0,W.jsx)(U.E,{fontSize:"sm",children:(null===q||void 0===q?void 0:q.message)||"Transcription not found"})]})]}),(0,W.jsx)(g.$,{leftIcon:(0,W.jsx)(A.kRp,{}),mt:4,onClick:()=>r("/transcriptions"),children:"Back to Transcriptions"})]}),(0,W.jsx)(F.n,{})]});const on=K.transcription;return(0,W.jsxs)(j.a,{bg:s,minH:"100vh",display:"flex",flexDirection:"column",children:[(0,W.jsx)(R.m,{}),(0,W.jsx)(O.y,{moduleConfig:G.default}),(0,W.jsxs)(y.m,{maxW:"container.xl",py:8,flex:"1",children:[(0,W.jsxs)(I.z,{justify:"space-between",mb:6,children:[(0,W.jsx)(g.$,{leftIcon:(0,W.jsx)(A.kRp,{}),variant:"ghost",color:H,onClick:()=>r("/transcriptions"),children:"Back to Transcriptions"}),(0,W.jsxs)(I.z,{children:[("PENDING"===on.status||"UPLOADING"===on.status)&&(0,W.jsx)(N.m,{label:"Start transcription with Pinata URL",children:(0,W.jsx)(g.$,{leftIcon:(0,W.jsx)(A.jTZ,{}),onClick:()=>{const n=window.prompt("Enter the Pinata IPFS URL for the audio file:\n\nExample: https://scarlet-professional-perch-484.mypinata.cloud/ipfs/bafyb...\nor just the CID: bafyb...",on.audioUrl||"");if(!n)return;const r=n.startsWith("http")?n:"https://scarlet-professional-perch-484.mypinata.cloud/ipfs/".concat(n);V({variables:{input:{transcriptionId:i,audioUrl:r,fileName:on.fileName||"audio.m4a",fileSize:on.fileSize||0}}})},isLoading:nn,colorScheme:"blue",size:"sm",children:"Start Transcription"})}),"FAILED"===on.status&&(0,W.jsx)(N.m,{label:"Retry transcription",children:(0,W.jsx)(f.K,{"aria-label":"Retry",icon:(0,W.jsx)(A.jTZ,{}),onClick:sn,isLoading:Q,colorScheme:"blue"})}),"COMPLETED"===on.status&&(0,W.jsx)(N.m,{label:"Download transcription",children:(0,W.jsx)(f.K,{"aria-label":"Download",icon:(0,W.jsx)(A.a4x,{}),onClick:tn,colorScheme:"green"})}),(0,W.jsx)(N.m,{label:"Delete transcription",children:(0,W.jsx)(f.K,{"aria-label":"Delete",icon:(0,W.jsx)(A.IXo,{}),onClick:()=>{window.confirm("Are you sure you want to delete this transcription? This action cannot be undone.")&&rn({variables:{id:i}})},isLoading:en,colorScheme:"red",variant:"outline"})})]})]}),(0,W.jsxs)(w.T,{align:"start",spacing:2,mb:6,children:[(0,W.jsxs)(I.z,{children:[(0,W.jsxs)(L.D,{color:u,fontFamily:P.Kk.fonts.heading,children:["\ud83c\udfa4 ",on.title]}),(n=>{const i={PENDING:{color:"gray",icon:A.Ohp,label:"Pending"},UPLOADING:{color:"purple",icon:A.Ohp,label:"Uploading"},PROCESSING:{color:"blue",icon:A.Ohp,label:"Processing"},COMPLETED:{color:"green",icon:A.A3x,label:"Completed"},FAILED:{color:"red",icon:A.q_G,label:"Failed"}},r=i[n]||i.PENDING,e=r.icon;return(0,W.jsxs)(m.E,{colorScheme:r.color,display:"flex",alignItems:"center",gap:1,fontSize:"md",p:2,children:[(0,W.jsx)(e,{size:16}),r.label]})})(on.status)]}),on.description&&(0,W.jsx)(U.E,{color:H,children:on.description})]}),(0,W.jsxs)(D.x,{templateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:4,mb:6,children:[(0,W.jsx)(S.E,{children:(0,W.jsx)(b.Z,{bg:o,borderColor:a,borderWidth:1,children:(0,W.jsx)(E.b,{children:(0,W.jsxs)(w.T,{align:"start",spacing:1,children:[(0,W.jsxs)(I.z,{children:[(0,W.jsx)(A.jH2,{color:H}),(0,W.jsx)(U.E,{color:H,fontSize:"sm",children:"File Name"})]}),(0,W.jsx)(U.E,{color:u,fontWeight:"medium",children:on.fileName||"Unknown"})]})})})}),(0,W.jsx)(S.E,{children:(0,W.jsx)(b.Z,{bg:o,borderColor:a,borderWidth:1,children:(0,W.jsx)(E.b,{children:(0,W.jsxs)(w.T,{align:"start",spacing:1,children:[(0,W.jsxs)(I.z,{children:[(0,W.jsx)(A.$Mw,{color:H}),(0,W.jsx)(U.E,{color:H,fontSize:"sm",children:"Duration"})]}),(0,W.jsx)(U.E,{color:u,fontWeight:"medium",children:(n=>{if(!n)return"N/A";const i=Math.floor(n/60),r=Math.floor(n%60);return"".concat(i,":").concat(r.toString().padStart(2,"0"))})(on.duration)})]})})})}),(0,W.jsx)(S.E,{children:(0,W.jsx)(b.Z,{bg:o,borderColor:a,borderWidth:1,children:(0,W.jsx)(E.b,{children:(0,W.jsxs)(w.T,{align:"start",spacing:1,children:[(0,W.jsx)(U.E,{color:H,fontSize:"sm",children:"Language"}),(0,W.jsx)(U.E,{color:u,fontWeight:"medium",children:on.detectedLanguage||"Not detected"})]})})})}),(0,W.jsx)(S.E,{children:(0,W.jsx)(b.Z,{bg:o,borderColor:a,borderWidth:1,children:(0,W.jsx)(E.b,{children:(0,W.jsxs)(w.T,{align:"start",spacing:1,children:[(0,W.jsx)(U.E,{color:H,fontSize:"sm",children:"Confidence"}),(0,W.jsx)(U.E,{color:u,fontWeight:"medium",children:on.confidence?"".concat((100*on.confidence).toFixed(1),"%"):"N/A"})]})})})})]}),("PROCESSING"===on.status||"UPLOADING"===on.status)&&(0,W.jsxs)(x.F,{status:"info",borderRadius:"lg",mb:6,children:[(0,W.jsx)(h._,{}),(0,W.jsxs)(w.T,{align:"start",spacing:1,flex:1,children:[(0,W.jsx)(U.E,{fontWeight:"bold",children:"Transcription in progress"}),(0,W.jsx)(U.E,{fontSize:"sm",children:"Your audio is being transcribed. This page will refresh automatically every 5 seconds."}),on.processingTime&&(0,W.jsxs)(U.E,{fontSize:"sm",children:["Processing time so far: ",on.processingTime.toFixed(2),"s"]})]})]}),"FAILED"===on.status&&(0,W.jsxs)(x.F,{status:"error",borderRadius:"lg",mb:6,children:[(0,W.jsx)(h._,{}),(0,W.jsxs)(w.T,{align:"start",spacing:1,flex:1,children:[(0,W.jsx)(U.E,{fontWeight:"bold",children:"Transcription failed"}),(0,W.jsx)(U.E,{fontSize:"sm",children:on.errorMessage||"An error occurred during transcription"}),(0,W.jsx)(g.$,{size:"sm",leftIcon:(0,W.jsx)(A.jTZ,{}),onClick:sn,isLoading:Q,mt:2,children:"Retry Transcription"})]})]}),"COMPLETED"===on.status&&on.transcription&&(0,W.jsx)(b.Z,{bg:o,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:a,borderRadius:"lg",children:(0,W.jsxs)(E.b,{children:[(0,W.jsxs)(I.z,{justify:"space-between",mb:4,children:[(0,W.jsx)(L.D,{size:"md",color:u,children:"Transcription"}),(0,W.jsx)(g.$,{leftIcon:(0,W.jsx)(A.a4x,{}),size:"sm",onClick:tn,colorScheme:"green",children:"Download as TXT"})]}),(0,W.jsx)(C.c,{mb:4}),(0,W.jsx)(k.T,{value:on.transcription,readOnly:!0,bg:"rgba(0, 0, 0, 0.2)",borderColor:a,color:u,minH:"400px",fontFamily:"monospace",fontSize:"sm",p:4}),(0,W.jsxs)(w.T,{align:"start",mt:4,spacing:1,children:[(0,W.jsxs)(U.E,{color:H,fontSize:"sm",children:["Word count: ",on.transcription.split(/\s+/).length]}),(0,W.jsxs)(U.E,{color:H,fontSize:"sm",children:["Character count: ",on.transcription.length]}),on.processingTime&&(0,W.jsxs)(U.E,{color:H,fontSize:"sm",children:["Processing time: ",on.processingTime.toFixed(2),"s"]})]})]})}),"PENDING"===on.status&&(0,W.jsxs)(x.F,{status:"warning",borderRadius:"lg",children:[(0,W.jsx)(h._,{}),(0,W.jsx)(U.E,{children:"Transcription has not started yet. The audio file may still be uploading."})]})]}),(0,W.jsx)(F.n,{})]})}}}]);
//# sourceMappingURL=6035.0b9d4ad2.chunk.js.map