"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[9345],{39324:(e,n,t)=>{t.d(n,{Sd:()=>o,g_:()=>s,l2:()=>i});const o='# Unified Markdown Format Specification\n\n**Version:** 1.0\n**Last Updated:** January 2025\n\nThis document defines the unified markdown format for importing/exporting projects, bills, and proposals.\n\n---\n\n## \ud83d\udcdd Format Overview\n\nThe unified format combines:\n- Project metadata (name, goal, description)\n- Bill metadata (currency, payment method, status)\n- Line items / Tasks (description, price, status, assignee)\n- Agreement text (optional)\n\nThis allows editing proposals in Claude and importing them into the system.\n\n---\n\n## \ud83d\udccb Complete Example\n\n```markdown\n# One Group Website Development Proposal\n\n## Project Information\n**Project Name:** One Group Website Development\n**Project Goal:** Build unified digital platform for Solar, Finance & Property Investment\n**Project Description:** Complete 80-page unified platform representing all three One Group verticals with custom calculators, CRM integration, and SEO optimization.\n\n## Bill Information\n**Currency:** AUD\n**Payment Method:** AUD_TRANSFER\n**Status:** PROPOSAL\n\n## Line Items\n\n### 1. Content Page: onegroupaustralasia.com.au/\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n\n### 2. Content Page: onegroupaustralasia.com.au/about\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n### 3. Custom Logic: onegroupaustralasia.com.au/solar/calculator\n**Price:** $300.00\n**Billable:** Yes\n**Status:** IN_PROGRESS\n**Assignee:** jane@tommillerservices.com\n\n### 4. Project management and coordination\n**Price:** $0.00\n**Billable:** No\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n\n### 5. Internal testing and QA\n**Price:** [ENTER PRICE]\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n## Agreement\n\n[Full agreement text goes here...]\n\n**Between:** Tom Miller Services Pty Ltd ("TMS")\n**And:** One Group ("Client")\n\n[Rest of agreement...]\n```\n\n---\n\n## \ud83d\udd0d Field Specifications\n\n### Project Information Section\n\n| Field | Required | Format | Example |\n|-------|----------|--------|---------|\n| Project Name | Yes | Plain text | `One Group Website Development` |\n| Project Goal | No | Max 17 words | `Build unified digital platform for Solar, Finance & Property` |\n| Project Description | No | Max 200 words | `Complete 80-page unified platform...` |\n\n**Notes:**\n- Project Goal is used for taglines (keep concise)\n- Project Description provides context for the work\n\n---\n\n### Bill Information Section\n\n| Field | Required | Format | Options |\n|-------|----------|--------|---------|\n| Currency | Yes | Uppercase code | `AUD`, `USD` |\n| Payment Method | No | Enum value | `AUD_TRANSFER`, `CARD`, `CRYPTO` |\n| Status | No | Enum value | `PROPOSAL`, `DRAFT`, `SENT` |\n\n**Notes:**\n- Currency affects how prices are parsed\n- If Payment Method is omitted, defaults to `AUD_TRANSFER`\n- If Status is omitted, defaults to `PROPOSAL`\n\n---\n\n### Line Items Section\n\nEach line item uses this format:\n\n```markdown\n### [Number]. [Description]\n**Price:** [Amount]\n**Billable:** [Yes/No]\n**Status:** [Status]\n**Assignee:** [Email or "Unassigned"]\n```\n\n#### Field Details:\n\n| Field | Required | Format | Options/Rules |\n|-------|----------|--------|---------------|\n| Number | No | Integer | Sequential numbering (1, 2, 3...) |\n| Description | Yes | Plain text | Task/line item description |\n| Price | Yes | Number with currency symbol | `$100.00`, `[ENTER PRICE]` (placeholder) |\n| Billable | No | Yes/No | Defaults to `Yes` if omitted |\n| Status | No | Enum | `PENDING`, `IN_PROGRESS`, `COMPLETED` (defaults to `PENDING`) |\n| Assignee | No | Email or "Unassigned" | Must be valid email or literal "Unassigned" |\n\n**Price Format Rules:**\n- With symbol: `$100.00`, `$100`, `$99.50`\n- Without symbol: `100.00`, `100`, `99.50`\n- Placeholder: `[ENTER PRICE]` \u2190 **Fails import** (must add price before importing)\n- Zero price: `$0.00` \u2190 Creates non-billable line item\n\n**Assignee Rules:**\n- Valid email: `tom@tommillerservices.com` \u2190 Looks up user and assigns\n- Invalid email: Creates unassigned task and shows warning\n- "Unassigned": Creates unassigned task\n- Omitted: Creates unassigned task\n\n---\n\n## \ud83d\udd04 Import/Export Behavior\n\n### Export (Project \u2192 Markdown)\n\nWhen exporting a project to markdown:\n1. **Project Info:** Populated from project.projectName, projectGoal, projectDescription\n2. **Bill Info:** Uses default values (Currency from tenant, Status = PROPOSAL)\n3. **Line Items:**\n   - Description from task.description\n   - Price = `[ENTER PRICE]` for billable tasks, `$0.00` for non-billable\n   - Billable from task.billable (defaults to Yes)\n   - Status from task.status\n   - Assignee from task.assignedTo.email (or "Unassigned")\n4. **Agreement:** Not included in export (add manually if needed)\n\n### Import (Markdown \u2192 Bill)\n\nWhen importing markdown to a bill:\n1. **Project Info:** Ignored (bill already linked to project)\n2. **Bill Info:** Updates bill.currency if specified\n3. **Line Items:**\n   - **Replaces all existing line items** (with confirmation modal)\n   - Creates new line items from each `### [Number]. [Description]` section\n   - Parses price and converts to cents for Stripe\n   - Sets billable flag based on price ($0 = non-billable)\n   - Assignee is stored but not enforced (bills don\'t have task assignments)\n4. **Agreement:** Ignored during bill import\n\n---\n\n## \u2705 Validation Rules\n\n### During Export\n- [ ] At least 1 task exists in project\n- [ ] Task descriptions are not empty\n- [ ] All billable tasks marked with price placeholder\n\n### During Import to Bill\n- [ ] Valid markdown structure\n- [ ] At least 1 line item found\n- [ ] All line items have valid prices (no `[ENTER PRICE]` placeholders)\n- [ ] All prices are positive numbers or zero\n- [ ] Currency code is valid (AUD or USD)\n- [ ] Status enum is valid (if provided)\n\n---\n\n## \ud83d\udeab Common Parse Errors\n\n| Error | Cause | Solution |\n|-------|-------|----------|\n| "No line items found" | Missing `## Line Items` section | Add section header |\n| "Invalid price format" | Price has `[ENTER PRICE]` | Replace with actual dollar amount |\n| "Currency not supported" | Invalid currency code | Use `AUD` or `USD` |\n| "Line item missing description" | Empty description after number | Add description text |\n| "Negative price not allowed" | Price is negative | Use positive number or $0.00 |\n\n---\n\n## \ud83c\udfa8 Formatting Tips for Claude Editing\n\n### Adding New Line Items\n```markdown\n### 81. New feature: User authentication module\n**Price:** $500.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n```\n\n### Bulk Price Adjustments\nAsk Claude: "Increase all Content Page items by 20%"\nClaude will update:\n- `**Price:** $100.00` \u2192 `**Price:** $120.00`\n\n### Reassigning Tasks\nAsk Claude: "Assign all calculator tasks to jane@tommillerservices.com"\nClaude will update:\n- `**Assignee:** Unassigned` \u2192 `**Assignee:** jane@tommillerservices.com`\n\n### Marking Tasks Complete\nAsk Claude: "Mark tasks 1-10 as completed"\nClaude will update:\n- `**Status:** PENDING` \u2192 `**Status:** COMPLETED`\n\n---\n\n**Version History:**\n- v1.0 (Jan 2025) - Initial specification\n',i="# Bill Line Items Template\n\n## Project Information\n**Project Name:** [Enter project name]\n**Project Goal:** [Enter project goal - max 17 words]\n**Project Description:** [Enter project description - max 200 words]\n\n## Bill Information\n**Currency:** AUD\n**Payment Method:** AUD_TRANSFER\n**Status:** PROPOSAL\n\n## Line Items\n\n### 1. [Task description]\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** email@example.com\n\n### 2. [Another task description]\n**Price:** $200.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n### 3. [Add more line items as needed]\n**Price:** $150.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n## Agreement\n\n[Add your agreement text here, or leave this section empty]\n",s=(e,n)=>{const t=new Blob([e],{type:"text/markdown"}),o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}},59345:(e,n,t)=>{t.r(n),t.d(n,{default:()=>te});var o,i,s,r,l,a=t(89379),c=t(57528),d=t(65043),m=t(39324),u=t(22107),p=t(98662),g=t(42703),b=t(44093),h=t(98939),f=t(73225),x=t(76668),j=t(35699),C=t(61724),v=t(96148),k=t(10202),y=t(98481),P=t(80511),S=t(82595),N=t(67813),A=t(83201),I=t(3313),E=t(55395),T=t(19077),D=t(30502),w=t(28846),R=t(39081),U=t(12730),B=t(58584),F=t(35190),L=t(31881),z=t(10585),G=t(70459),O=t(73216),M=t(35475),$=t(52003),_=t(63295),Y=t(66037),W=t(95214),q=t(192),J=t(29066),V=t(39985),H=t(70579),Q=function(e){return e.PROPOSAL="PROPOSAL",e.DRAFT="DRAFT",e.SENT="SENT",e}(Q||{});const X=(0,G.J1)(o||(o=(0,c.A)(["\n  query GetAllProjects {\n    projects {\n      id\n      projectName\n      projectGoal\n      progress\n      billingClient {\n        id\n        fName\n        lName\n        email\n        businessName\n      }\n    }\n  }\n"]))),Z=(0,G.J1)(i||(i=(0,c.A)(["\n  query GetProjectWithTasks($projectId: ID!) {\n    project(id: $projectId) {\n      id\n      projectName\n      projectGoal\n      progress\n      billingClient {\n        id\n        fName\n        lName\n        email\n        businessName\n      }\n      tasks {\n        id\n        description\n        status\n        order\n        billed\n        assignedTo {\n          id\n          fName\n          lName\n        }\n        media {\n          url\n          description\n          fileType\n        }\n      }\n    }\n  }\n"]))),K=(0,G.J1)(s||(s=(0,c.A)(["\n  mutation CreateBill($input: BillInput!) {\n    createBill(input: $input) {\n      id\n      isPaid\n      status\n      paymentMethod\n      currency\n      acceptCardPayment\n      acceptCryptoPayment\n      clientId\n      lineItems {\n        id\n        amount\n        description\n      }\n      subtotal\n      taxPercentage\n      taxAmount\n      totalAmount\n      projectId\n      createdAt\n      updatedAt\n    }\n  }\n"]))),ee=(0,G.J1)(r||(r=(0,c.A)(["\n  query GetClients {\n    clients {\n      id\n      fName\n      lName\n      email\n      businessName\n    }\n  }\n"]))),ne=(0,G.J1)(l||(l=(0,c.A)(["\n  query GetCurrentTenant {\n    currentTenant {\n      id\n      name\n      companyDetails {\n        companyName\n        taxId\n        taxPercentage\n        billingEmail\n        billingPhone\n        billingAddress {\n          addressLine1\n          addressLine2\n          city\n          state\n          postalCode\n          country\n        }\n      }\n      paymentReceivingDetails {\n        acceptedMethods\n        bankAccount {\n          accountName\n          bsb\n          accountNumber\n          bankName\n        }\n      }\n    }\n  }\n"]))),te=()=>{var e,n,t,o;(0,Y.H)("New Bill");const i=(0,O.Zp)(),s=(0,D.d)(),{colorMode:r}=(0,b.G6)(),l=(0,F.m)(),{user:c}=(0,J.A)(),G=(0,V.oU)("background.main",r),te=(0,V.oU)("background.cardGradient",r),oe=(0,V.oU)("border.darkCard",r),ie=(0,V.oU)("light"===r?"text.primary":"text.primaryDark",r),se=(0,V.oU)("light"===r?"text.secondary":"text.secondaryDark",r),re=(0,V.oU)("light"===r?"text.muted":"text.mutedDark",r),[le]=(0,M.ok)(),ae=le.get("projectId"),[ce,de]=(0,d.useState)(""),[me,ue]=(0,d.useState)(""),[pe,ge]=(0,d.useState)(!1),[be,he]=(0,d.useState)(Q.DRAFT),[fe,xe]=(0,d.useState)("AUD"),[je,Ce]=(0,d.useState)(!0),[ve,ke]=(0,d.useState)(!0),[ye,Pe]=(0,d.useState)(!1),[Se,Ne]=(0,d.useState)([{description:"",amount:""}]),{data:Ae}=(0,z.IT)(ne),Ie=null!==(e=null===Ae||void 0===Ae||null===(n=Ae.currentTenant)||void 0===n||null===(t=n.companyDetails)||void 0===t?void 0:t.taxPercentage)&&void 0!==e?e:10,Ee=Se.reduce((e,n)=>e+("number"===typeof n.amount?n.amount:parseFloat(n.amount)||0),0),Te=Ee*(Ie/100),De=Ee+Te,{loading:we,error:Re,data:Ue}=(0,z.IT)(X,{onCompleted:e=>{if(console.log("Project data received from query:",e),null!==e&&void 0!==e&&e.projects){if(console.log("Received ".concat(e.projects.length," projects")),e.projects.length>0){var n,t;const o=e.projects[0];console.log("Sample project structure:",{id:o.id,name:o.projectName,tasksCount:(null===(n=o.tasks)||void 0===n?void 0:n.length)||0,hasTasks:Array.isArray(o.tasks),billsCount:(null===(t=o.bills)||void 0===t?void 0:t.length)||0,firstTaskBilled:o.tasks&&o.tasks.length>0?o.tasks[0].billed:"No tasks"})}}else console.log("No projects data received")},onError:e=>{console.error("Error fetching projects:",e)}}),{data:Be,loading:Fe}=(0,z.IT)(ee),[Le,{loading:ze}]=(0,L.n)(K),Ge=e=>{var n,t;if(console.log("Project selected:",e),de(e),!e)return console.log("No project selected, resetting line items"),Ne([{description:"",amount:""}]),void ue("");const o=null===Ue||void 0===Ue||null===(n=Ue.projects)||void 0===n?void 0:n.find(n=>n.id===e);null!==o&&void 0!==o&&null!==(t=o.billingClient)&&void 0!==t&&t.id&&(console.log("Auto-selecting client from project:",o.billingClient),ue(o.billingClient.id)),Ne([{description:"Loading tasks...",amount:""}]),l.query({query:Z,variables:{projectId:e},fetchPolicy:"network-only"}).then(e=>{var n;console.log("Project details fetched:",e.data);const t=e.data.project;if(!t)return console.log("Project data not found"),Ne([{description:"",amount:""}]),void s({title:"Error",description:"Could not load project details",status:"error",duration:3e3,isClosable:!0});if(console.log("Project tasks:",t.tasks),console.log("Task count:",(null===(n=t.tasks)||void 0===n?void 0:n.length)||0),!t.tasks||0===t.tasks.length)return console.log("No tasks found in this project"),Ne([{description:"",amount:""}]),void s({title:"No tasks",description:"This project has no tasks. You can add custom line items.",status:"info",duration:3e3,isClosable:!0});const o=t.tasks.filter(e=>(console.log("Task ".concat(e.id," - ").concat(e.description," - Billed:"),e.billed),!1===e.billed));if(console.log("Unbilled tasks:",o),console.log("Unbilled task count:",o.length),0===o.length)return console.log("No unbilled tasks found"),Ne([{description:"",amount:""}]),void s({title:"No unbilled tasks",description:"This project has no unbilled tasks. You can add custom line items.",status:"info",duration:3e3,isClosable:!0});const i=o.map(e=>(console.log("Creating line item for task: ".concat(e.description)),{description:e.description,amount:"",taskId:e.id,status:e.status}));console.log("New line items:",i),Ne(i),s({title:"Tasks loaded",description:"Loaded ".concat(i.length," unbilled tasks as line items."),status:"success",duration:3e3,isClosable:!0})}).catch(e=>{console.error("Error fetching project details:",e),Ne([{description:"",amount:""}]),s({title:"Error",description:"Failed to load project tasks. Please try again.",status:"error",duration:3e3,isClosable:!0})})};(0,d.useEffect)(()=>{if(ae&&null!==Ue&&void 0!==Ue&&Ue.projects&&!ce){Ue.projects.some(e=>e.id===ae)&&(console.log("Auto-selecting project from URL:",ae),Ge(ae))}},[ae,Ue,ce]),(0,d.useEffect)(()=>{const e=le.get("itemName"),n=le.get("itemPrice"),t=le.get("itemQuantity"),o=le.get("currency");le.get("notes");if(e&&n){console.log("\ud83d\udccb Pre-filling bill from booking:",{itemName:e,itemPrice:n,itemQuantity:t});const i=parseInt(t||"1"),s=parseFloat(n);Ne([{description:e,amount:s*i}]),"AUD"!==o&&"USD"!==o||xe(o)}},[le]);const Oe=(e,n,t)=>{const o=[...Se];o[e]=(0,a.A)((0,a.A)({},o[e]),{},{[n]:"amount"===n?""===t?"":parseFloat(t)||0:t}),Ne(o)};return(0,H.jsxs)(u.a,{bg:G,minHeight:"100vh",children:[(0,H.jsx)($.m,{}),(0,H.jsx)(W.y,{moduleConfig:q.default}),(0,H.jsx)(h.m,{maxW:"container.xl",py:8,children:(0,H.jsxs)(k.T,{spacing:8,align:"stretch",children:[(0,H.jsxs)(v.z,{justify:"space-between",align:"center",children:[(0,H.jsx)(w.D,{color:ie,children:"\ud83d\udcdd Create New Bill"}),(0,H.jsx)(p.$,{size:"sm",colorScheme:"purple",leftIcon:(0,H.jsx)(U.R,{}),onClick:()=>(0,m.g_)(m.l2,"bill_template.md"),children:"Download .md Template"})]}),(0,H.jsx)(u.a,{p:6,bg:te,backdropFilter:"blur(10px)",borderRadius:"lg",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",borderWidth:"1px",borderColor:oe,children:(0,H.jsxs)(k.T,{spacing:6,align:"stretch",children:[(0,H.jsxs)(f.MJ,{children:[(0,H.jsxs)(x.l,{color:ie,children:["Project (Optional)",we&&(0,H.jsx)(R.E,{as:"span",fontSize:"xs",ml:2,color:re,children:"(Loading projects...)"})]}),(0,H.jsx)(C.l,{placeholder:we?"Loading projects...":"Select project (optional)",value:ce,onChange:e=>Ge(e.target.value),isDisabled:we,bg:"rgba(0, 0, 0, 0.2)",borderColor:oe,color:ie,_hover:{borderColor:se},children:null===Ue||void 0===Ue?void 0:Ue.projects.map(e=>{var n,t,o;return(0,H.jsxs)("option",{value:e.id,style:{backgroundColor:"#1a1a1a"},children:[e.projectName," - ",(null===(n=e.billingClient)||void 0===n?void 0:n.businessName)||"".concat(null===(t=e.billingClient)||void 0===t?void 0:t.fName," ").concat(null===(o=e.billingClient)||void 0===o?void 0:o.lName)]},e.id)})}),(0,H.jsx)(R.E,{fontSize:"xs",color:re,mt:1,children:"Link this bill to a project to auto-populate line items from unbilled tasks, or leave blank to create a standalone bill."})]}),(0,H.jsxs)(f.MJ,{isRequired:!ce,children:[(0,H.jsxs)(x.l,{color:ie,children:["Client ",ce?"(Auto-selected from project)":"",Fe&&!ce&&(0,H.jsx)(R.E,{as:"span",fontSize:"xs",ml:2,color:re,children:"(Loading clients...)"})]}),(0,H.jsx)(C.l,{placeholder:Fe?"Loading clients...":"Select client to bill",value:me,onChange:e=>ue(e.target.value),isDisabled:Fe||!!ce,bg:"rgba(0, 0, 0, 0.2)",borderColor:oe,color:ie,_hover:{borderColor:se},children:null===Be||void 0===Be||null===(o=Be.clients)||void 0===o?void 0:o.map(e=>(0,H.jsxs)("option",{value:e.id,style:{backgroundColor:"#1a1a1a"},children:[e.businessName||"".concat(e.fName," ").concat(e.lName)," (",e.email,")"]},e.id))}),(0,H.jsx)(R.E,{fontSize:"xs",color:re,mt:1,children:ce?"Client is automatically selected from the project above":"Select who this bill is for - this is required"})]}),(0,H.jsxs)(f.MJ,{children:[(0,H.jsx)(x.l,{color:ie,children:"Currency"}),(0,H.jsxs)(C.l,{value:fe,onChange:e=>{const n=e.target.value;xe(n),console.log("Currency changed to: ".concat(n))},bg:"rgba(0, 0, 0, 0.2)",borderColor:oe,color:ie,_hover:{borderColor:se},children:[(0,H.jsx)("option",{value:"AUD",style:{backgroundColor:"#1a1a1a"},children:"AUD - Australian Dollar"}),(0,H.jsx)("option",{value:"USD",style:{backgroundColor:"#1a1a1a"},children:"USD - US Dollar"})]})]}),(0,H.jsxs)(u.a,{children:[(0,H.jsx)(R.E,{fontSize:"sm",fontWeight:"semibold",color:ie,mb:3,children:"Payment Methods Available to Customer"}),(0,H.jsxs)(k.T,{align:"stretch",spacing:3,children:[(0,H.jsxs)(f.MJ,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,H.jsx)(x.l,{htmlFor:"bank-transfer",mb:"0",color:ie,children:"Accept Bank Transfer"}),(0,H.jsx)(y.d,{id:"bank-transfer",isChecked:je,onChange:e=>Ce(e.target.checked),colorScheme:"blue"})]}),(0,H.jsxs)(f.MJ,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,H.jsx)(x.l,{htmlFor:"card-payment",mb:"0",color:ie,children:"Accept Card Payments (Stripe)"}),(0,H.jsx)(y.d,{id:"card-payment",isChecked:ve,onChange:e=>ke(e.target.checked),colorScheme:"blue"})]}),(0,H.jsxs)(f.MJ,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,H.jsx)(x.l,{htmlFor:"crypto-payment",mb:"0",color:ie,children:"Accept Crypto Payments (Bitcoin)"}),(0,H.jsx)(y.d,{id:"crypto-payment",isChecked:ye,onChange:e=>Pe(e.target.checked),colorScheme:"blue"})]})]}),(0,H.jsx)(R.E,{fontSize:"xs",color:re,mt:2,children:"Note: These options can only be changed while the bill is in DRAFT status"})]}),(0,H.jsxs)(f.MJ,{display:"flex",alignItems:"center",children:[(0,H.jsx)(x.l,{mb:"0",color:ie,children:"Is Paid?"}),(0,H.jsx)(y.d,{isChecked:pe,onChange:e=>ge(e.target.checked)})]})]})}),(0,H.jsxs)(u.a,{p:6,bg:te,backdropFilter:"blur(10px)",borderRadius:"lg",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",borderWidth:"1px",borderColor:oe,children:[(0,H.jsxs)(v.z,{mb:4,justify:"space-between",children:[(0,H.jsx)(w.D,{size:"md",color:ie,children:"Line Items"}),ce&&(0,H.jsx)(R.E,{fontSize:"sm",color:re,children:"Line items are pre-populated with unbilled tasks from the selected project"})]}),(0,H.jsx)(u.a,{overflowX:"auto",overflowY:"hidden",children:(0,H.jsxs)(P.X,{variant:"simple",size:{base:"sm",md:"md"},children:[(0,H.jsx)(I.d,{children:(0,H.jsxs)(E.Tr,{children:[(0,H.jsx)(A.Th,{color:se,fontSize:{base:"xs",md:"sm"},px:{base:2,md:4},children:"Description"}),(0,H.jsx)(A.Th,{color:se,fontSize:{base:"xs",md:"sm"},px:{base:2,md:4},children:"Amount"}),(0,H.jsx)(A.Th,{color:se,fontSize:{base:"xs",md:"sm"},px:{base:2,md:4},display:{base:"none",md:"table-cell"},children:"Status"}),(0,H.jsx)(A.Th,{color:se,fontSize:{base:"xs",md:"sm"},px:{base:2,md:4},children:"Action"})]})}),(0,H.jsx)(S.N,{children:Se.map((e,n)=>(0,H.jsxs)(E.Tr,{children:[(0,H.jsx)(N.Td,{px:{base:2,md:4},py:{base:2,md:3},children:(0,H.jsx)(T.T,{value:e.description,onChange:e=>Oe(n,"description",e.target.value),placeholder:"Item description",bg:"rgba(0, 0, 0, 0.2)",borderColor:oe,color:ie,_placeholder:{color:re},_hover:{borderColor:se},minH:{base:"80px",md:"120px"},resize:"vertical",rows:5,fontSize:{base:"sm",md:"md"}})}),(0,H.jsx)(N.Td,{px:{base:2,md:4},py:{base:2,md:3},children:(0,H.jsx)(j.p,{type:"number",value:e.amount,onChange:e=>Oe(n,"amount",e.target.value),placeholder:"Amount",bg:"rgba(0, 0, 0, 0.2)",borderColor:oe,color:ie,_placeholder:{color:re},_hover:{borderColor:se},fontSize:{base:"sm",md:"md"},minW:{base:"80px",md:"120px"}})}),(0,H.jsx)(N.Td,{px:{base:2,md:4},py:{base:2,md:3},children:(0,H.jsx)(g.K,{"aria-label":"Remove line item",icon:(0,H.jsx)(B.d,{}),onClick:()=>(e=>{Ne(Se.filter((n,t)=>t!==e))})(n),isDisabled:1===Se.length,size:{base:"sm",md:"md"},variant:"ghost",colorScheme:"red"})})]},n))})]})}),(0,H.jsx)(p.$,{leftIcon:(0,H.jsx)(U.R,{}),onClick:()=>{Ne([...Se,{description:"",amount:""}])},mt:4,size:"sm",bg:"white",color:"black",_hover:{bg:"gray.100",transform:"translateY(-2px)"},children:"Add Line Item"})]}),(0,H.jsxs)(v.z,{spacing:4,children:[(0,H.jsx)(p.$,{onClick:async()=>{if(console.log("\ud83d\ude80 Starting bill creation..."),!ce&&!me)return console.error("\u274c No project or client selected"),void s({title:"Client Required",description:"Please select either a project or a client to bill",status:"error",duration:3e3,isClosable:!0});const e=Se.filter(e=>e.description&&e.amount&&Number(e.amount)>0);if(console.log("\u2705 Valid line items: ".concat(e.length)),0===e.length)return console.error("\u274c No valid line items"),void s({title:"Error",description:"Please add at least one line item with a description and amount",status:"error",duration:3e3,isClosable:!0});try{var n;const t=e.map(e=>{let{description:n,amount:t}=e;return{description:n,amount:Number(t)}}),o={isPaid:pe,status:be,currency:fe,acceptBankTransfer:je,acceptCardPayment:ve,acceptCryptoPayment:ye,lineItems:t,subtotal:Ee,taxPercentage:Ie,taxAmount:Te,totalAmount:De,issuedBy:null===c||void 0===c?void 0:c.id};me&&(o.clientId=me),ce&&(o.projectId=ce),console.log("\ud83d\udccb Creating bill with:",(0,a.A)((0,a.A)({},o),{},{totalAmount:De.toFixed(2),currency:fe,lineItemsCount:t.length,hasClientId:!!me,clientIdValue:me}));const{data:r}=await Le({variables:{input:o}});console.log("\u2705 Bill created successfully:",{billId:r.createBill.id,currency:r.createBill.currency,totalLineItems:null===(n=r.createBill.lineItems)||void 0===n?void 0:n.length,clientId:r.createBill.clientId,hasClientId:!!r.createBill.clientId}),s({title:"Success",description:"Bill created successfully in ".concat(fe),status:"success",duration:3e3,isClosable:!0}),i("/bill/".concat(r.createBill.id))}catch(t){s({title:"Error",description:t instanceof Error?t.message:"Failed to create bill",status:"error",duration:5e3,isClosable:!0})}},isLoading:ze,bg:"white",color:"black",_hover:{bg:"gray.100",transform:"translateY(-2px)"},children:"Create Bill"}),(0,H.jsx)(p.$,{onClick:()=>i("/bills"),variant:"outline",borderColor:oe,color:ie,_hover:{borderColor:se,bg:"rgba(255, 255, 255, 0.05)"},children:"Cancel"})]})]})}),(0,H.jsx)(_.n,{}),(0,H.jsx)(u.a,{position:"fixed",bottom:8,right:8,p:6,bg:"linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(30, 30, 30, 0.9) 50%, rgba(20, 20, 20, 0.95) 100%)",backdropFilter:"blur(20px)",borderRadius:"2xl",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5), 0 0 60px rgba(54, 158, 255, 0.15)",borderWidth:"1px",borderColor:"rgba(54, 158, 255, 0.3)",transition:"all 0.3s ease",_hover:{transform:"translateY(-2px) scale(1.02)",boxShadow:"0 15px 50px rgba(0, 0, 0, 0.6), 0 0 80px rgba(54, 158, 255, 0.25)",borderColor:"rgba(54, 158, 255, 0.5)"},zIndex:1e3,children:(0,H.jsxs)(k.T,{spacing:3,align:"stretch",children:[(0,H.jsx)(R.E,{fontSize:"xs",fontWeight:"semibold",textTransform:"uppercase",letterSpacing:"wider",color:"rgba(255, 255, 255, 0.6)",children:"Bill Summary"}),(0,H.jsxs)(v.z,{justify:"space-between",children:[(0,H.jsx)(R.E,{fontSize:"sm",color:"rgba(255, 255, 255, 0.7)",children:"Subtotal"}),(0,H.jsxs)(R.E,{fontSize:"sm",fontWeight:"medium",color:"rgba(255, 255, 255, 0.9)",children:["$",Ee.toFixed(2)," ",fe]})]}),(0,H.jsxs)(v.z,{justify:"space-between",children:[(0,H.jsxs)(R.E,{fontSize:"sm",color:"rgba(255, 255, 255, 0.7)",children:["GST (",Ie,"%)"]}),(0,H.jsxs)(R.E,{fontSize:"sm",fontWeight:"medium",color:"rgba(255, 255, 255, 0.9)",children:["$",Te.toFixed(2)," ",fe]})]}),(0,H.jsx)(u.a,{height:"1px",bg:"rgba(54, 158, 255, 0.3)",my:1}),(0,H.jsxs)(v.z,{justify:"space-between",align:"baseline",children:[(0,H.jsx)(R.E,{fontSize:"sm",fontWeight:"semibold",color:"rgba(255, 255, 255, 0.8)",children:"Total"}),(0,H.jsxs)(R.E,{fontSize:"2xl",fontWeight:"bold",color:"#FFFFFF",lineHeight:"1",children:["$",De.toFixed(2)," ",fe]})]}),Se.filter(e=>e.amount&&Number(e.amount)>0).length>0&&(0,H.jsxs)(R.E,{fontSize:"xs",color:"rgba(54, 158, 255, 0.8)",textAlign:"center",children:[Se.filter(e=>e.amount&&Number(e.amount)>0).length," item",1!==Se.filter(e=>e.amount&&Number(e.amount)>0).length?"s":""]})]})})]})}}}]);
//# sourceMappingURL=9345.61c4dbc6.chunk.js.map