(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[9893],{22665:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>vn});var i,s,o=t(89379),l=t(57528),r=t(65043),a=t(73216),c=t(70459),d=t(10585),m=t(35190),u=t(31881),h=t(39324),p=t(44093),x=t(30502),g=t(96870),b=t(98939),j=t(10202),y=t(99032),f=t(88787),v=t(85871),C=t(22107),S=t(83169),E=t(26201),k=t(96148),P=t(28846),I=t(39081),A=t(98662),D=t(87139),w=t(73212),B=t(47726),T=t(98481),z=t(82459),N=t(61724),R=t(24330),W=t(73225),F=t(76668),K=t(80511),$=t(3313),U=t(55395),Y=t(83201),O=t(82595),L=t(67813),_=t(35699),M=t(42703),G=t(78460),q=t(11054),Q=t(25722),H=t(15071),J=t(35929),Z=t(67516),V=t(55182),X=t(45973),ee=t(80006),ne=t(19077),te=t(56529),ie=t(52003),se=t(63295),oe=t(66037),le=t(95214),re=t(192),ae=t(55206),ce=t(58797),de=t(99973),me=t(58584),ue=t(29066),he=t(27682),pe=t(22992),xe=t(39985),ge=t(25011),be=t(53639),je=t(86376),ye=t(14960),fe=t(38326),ve=t(57856),Ce=t(76659),Se=t(69677),Ee=t(63393),ke=t(70579);const Pe=(0,c.J1)(i||(i=(0,l.A)(["\n  query GetTenantConfig($id: ID!) {\n    tenant(id: $id) {\n      id\n      apiKeys {\n        stripePublicKey\n      }\n    }\n  }\n"]))),Ie=(0,c.J1)(s||(s=(0,l.A)(["\n  mutation CreateBillPayment($billId: ID!, $paymentMethodId: String!) {\n    createBillPayment(billId: $billId, paymentMethodId: $paymentMethodId) {\n      success\n      requiresAction\n      clientSecret\n      paymentIntentId\n      message\n    }\n  }\n"]))),Ae=e=>{let{billId:n,amount:t,onSuccess:i}=e;const s=(0,Ee.useStripe)(),o=(0,Ee.useElements)(),[l,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),h=(0,x.d)(),p=(0,a.Zp)(),[g]=(0,u.n)(Ie);return(0,ke.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),console.log("[StripeBillPayment] Starting payment submission"),console.log("[StripeBillPayment] Bill ID:",n),console.log("[StripeBillPayment] Amount:",t),s&&o){c(!0),m(null);try{const e=o.getElement(Ee.CardElement);if(!e)throw new Error("Card element not found");const{error:l,paymentMethod:r}=await s.createPaymentMethod({type:"card",card:e});if(l)throw new Error(l.message);if(!r)throw new Error("Failed to create payment method");console.log("[StripeBillPayment] Created payment method:",r.id);const{data:a}=await g({variables:{billId:n,paymentMethodId:r.id}}),c=a.createBillPayment;if(c.requiresAction&&c.clientSecret){console.log("[StripeBillPayment] Payment requires 3D Secure authentication");const{error:e,paymentIntent:o}=await s.confirmCardPayment(c.clientSecret);if(e)throw new Error(e.message);"succeeded"===(null===o||void 0===o?void 0:o.status)&&(h({title:"Payment Successful!",description:"Your payment of $".concat(t.toFixed(2)," has been processed."),status:"success",duration:5e3,isClosable:!0}),i(),p("/bill/".concat(n,"/payment-success")))}else{if(!c.success)throw new Error(c.message||"Payment failed");h({title:"Payment Successful!",description:"Your payment of $".concat(t.toFixed(2)," has been processed."),status:"success",duration:5e3,isClosable:!0}),i(),p("/bill/".concat(n,"/payment-success"))}}catch(l){console.error("[StripeBillPayment] Payment error:",l);const e=l instanceof Error?l.message:"Payment failed. Please try again.";m(e),h({title:"Payment Failed",description:e,status:"error",duration:5e3,isClosable:!0})}finally{c(!1)}}else console.error("[StripeBillPayment] Stripe or Elements not loaded")},children:(0,ke.jsxs)(j.T,{spacing:4,align:"stretch",children:[(0,ke.jsx)(C.a,{p:4,borderWidth:"1px",borderRadius:"md",borderColor:xe.Kk.colors.border.darkCard,bg:xe.Kk.colors.background.main,children:(0,ke.jsx)(Ee.CardElement,{options:{style:{base:{fontSize:"16px",color:xe.Kk.colors.text.inverse,"::placeholder":{color:xe.Kk.colors.text.mutedDark}}}}})}),d&&(0,ke.jsxs)(f.F,{status:"error",borderRadius:"md",children:[(0,ke.jsx)(v._,{}),d]}),(0,ke.jsxs)(A.$,{type:"submit",colorScheme:"blue",size:"lg",width:"full",isDisabled:!s||l,isLoading:l,loadingText:"Processing Payment...",children:["Pay $",t.toFixed(2)," AUD with Card"]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,textAlign:"center",children:"Your payment information is secure and encrypted. We use Stripe for payment processing."})]})})},De=e=>{let{billId:n,amount:t,onPaymentComplete:i}=e;const[s,o]=(0,r.useState)(null),l=((0,x.d)(),localStorage.getItem("tenantId")||""),{data:a,loading:c,error:m}=(0,d.IT)(Pe,{variables:{id:l},skip:!l});(0,r.useEffect)(()=>{var e,n;if(null!==a&&void 0!==a&&null!==(e=a.tenant)&&void 0!==e&&null!==(n=e.apiKeys)&&void 0!==n&&n.stripePublicKey)console.log("[StripeBillPayment] Loading Stripe with tenant key:",a.tenant.apiKeys.stripePublicKey.substring(0,10)+"..."),o((0,Se.c)(a.tenant.apiKeys.stripePublicKey));else if(!c&&!m){const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_GRAPHQL_URI:"https://api.tommillerservices.com/graphql"}.REACT_APP_STRIPE_PUBLIC_KEY;e?(console.log("[StripeBillPayment] Loading Stripe with environment key:",e.substring(0,10)+"..."),o((0,Se.c)(e))):console.error("[StripeBillPayment] No Stripe key found in tenant config or environment")}},[a,c,m]);return c?(0,ke.jsx)(S.Z,{bg:xe.Kk.colors.background.cardGradient,borderColor:xe.Kk.colors.border.darkCard,borderWidth:"1px",children:(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(j.T,{spacing:4,children:[(0,ke.jsx)(Ce.y,{size:"xl",color:xe.Kk.colors.primary}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.secondaryDark,children:"Loading payment options..."})]})})}):s?(0,ke.jsxs)(S.Z,{bg:xe.Kk.colors.background.cardGradient,borderColor:xe.Kk.colors.border.darkCard,borderWidth:"1px",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",backdropFilter:"blur(10px)",children:[(0,ke.jsx)(E.a,{children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsx)(I.E,{fontSize:"lg",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:"\ud83d\udcb3 Pay with Credit/Debit Card"}),(0,ke.jsx)(D.E,{colorScheme:"blue",fontSize:"sm",px:3,py:1,children:"Secure Payment"})]})}),(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[(0,ke.jsx)(C.a,{p:4,bg:xe.Kk.colors.background.main,borderRadius:"md",border:"1px",borderColor:xe.Kk.colors.border.darkCard,children:(0,ke.jsxs)(j.T,{spacing:2,children:[(0,ke.jsx)(I.E,{fontSize:"sm",color:xe.Kk.colors.text.mutedDark,children:"Amount to Pay"}),(0,ke.jsxs)(I.E,{fontSize:"3xl",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:["$",t.toFixed(2)]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,children:"AUD"})]})}),(0,ke.jsx)(z.c,{}),(0,ke.jsx)(Ee.Elements,{stripe:s,children:(0,ke.jsx)(Ae,{billId:n,amount:t,onSuccess:()=>{i&&i()}})}),(0,ke.jsx)(k.z,{justify:"center",spacing:4,pt:2,children:(0,ke.jsxs)(k.z,{spacing:2,children:[(0,ke.jsx)(D.E,{colorScheme:"green",variant:"subtle",children:"\ud83d\udd12 SSL Encrypted"}),(0,ke.jsx)(D.E,{colorScheme:"purple",variant:"subtle",children:"Powered by Stripe"})]})}),(0,ke.jsxs)(C.a,{textAlign:"center",pt:2,children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,mb:2,children:"We accept:"}),(0,ke.jsxs)(k.z,{justify:"center",spacing:3,children:[(0,ke.jsx)(D.E,{children:"Visa"}),(0,ke.jsx)(D.E,{children:"Mastercard"}),(0,ke.jsx)(D.E,{children:"American Express"}),(0,ke.jsx)(D.E,{children:"Discover"})]})]})]})})]}):(0,ke.jsx)(S.Z,{bg:xe.Kk.colors.background.cardGradient,borderColor:xe.Kk.colors.border.darkCard,borderWidth:"1px",children:(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(f.F,{status:"warning",borderRadius:"md",children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Payment Not Available"}),(0,ke.jsx)(I.E,{fontSize:"sm",children:"Stripe payment is not configured for this account. Please contact support."})]})]})})})};var we=t(97541),Be=t(91751),Te=t(53407),ze=t(7189),Ne=t(36210),Re=t(72313),We=t(68899),Fe=t(70764),Ke=t(91614);const $e=(e,n,t)=>{const i="".concat(n,"-").concat(t,"-").concat(Date.now()),s=btoa(i).replace(/[^a-zA-Z0-9]/g,"").substring(0,20);return"sp1qw508d6qejxtdg4y5r3zarvary0c5xw7k".concat(s)},Ue=e=>Number((e/102e3).toFixed(8)),Ye=e=>{let{amount:n,originalAmount:t,discountPercentage:i,billId:s,onPaymentComplete:o,issuerWalletAddress:l}=e;const[a,c]=(0,r.useState)(""),[d,m]=(0,r.useState)(0),[u,h]=(0,r.useState)("pending"),[p,b]=(0,r.useState)(null),[y,P]=(0,r.useState)(!1),{isOpen:w,onToggle:T}=(0,g.j)(),N=(0,x.d)(),{hasCopied:W,onCopy:F}=(0,we.i)(a),{hasCopied:K,onCopy:$}=(0,we.i)(d.toString());(0,r.useEffect)(()=>{console.log("[SilentBitcoinPayment] Issuer wallet address:",l),n>0&&(P(!0),setTimeout(()=>{const e=$e(0,s,n);c(e),m(Ue(n)),P(!1),console.log("[SilentBitcoinPayment] Generated address:",e,"BTC amount:",Ue(n))},1e3))},[n,s,l]),(0,r.useEffect)(()=>{if("processing"===u){const e=setTimeout(()=>{h("confirmed"),b("3a7f9b2c4e5d6789abcdef1234567890abcdef1234567890abcdef1234567890"),o&&o(),N({title:"Payment Confirmed!",description:"Your Bitcoin payment has been successfully received.",status:"success",duration:5e3,isClosable:!0})},15e3);return()=>clearTimeout(e)}},[u,o,N]);return(0,ke.jsxs)(S.Z,{bg:xe.Kk.colors.background.cardGradient,borderColor:xe.Kk.colors.border.darkCard,borderWidth:"1px",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",backdropFilter:"blur(10px)",children:[(0,ke.jsx)(E.a,{children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsxs)(k.z,{children:[(0,ke.jsx)(I.E,{fontSize:"lg",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:"\ud83d\udd12 Pay with Silent Bitcoin"}),(0,ke.jsx)(B.m,{label:"Silent Payments (BIP 352) provide enhanced privacy by generating unique addresses for each transaction",children:(0,ke.jsx)(ge.I,{as:ve.A,w:4,h:4,color:xe.Kk.colors.text.mutedDark})})]}),(0,ke.jsx)(D.E,{colorScheme:(()=>{switch(u){case"pending":return"orange";case"processing":return"blue";case"confirmed":return"green";default:return"gray"}})(),fontSize:"sm",px:3,py:1,children:(()=>{switch(u){case"pending":return"Awaiting Payment";case"processing":return"Processing Transaction";case"confirmed":return"Payment Confirmed";default:return"Unknown"}})()})]})}),(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[(0,ke.jsxs)(f.F,{status:"info",borderRadius:"md",fontSize:"sm",children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Enhanced Privacy Protection"}),(0,ke.jsx)(I.E,{fontSize:"xs",children:"This payment uses Silent Payments (BIP 352) - a unique address is generated just for this transaction, ensuring your privacy without additional fees."})]})]}),(0,ke.jsx)(C.a,{p:4,bg:xe.Kk.colors.background.main,borderRadius:"md",border:"1px",borderColor:xe.Kk.colors.border.darkCard,children:(0,ke.jsxs)(j.T,{spacing:2,children:[(0,ke.jsx)(I.E,{fontSize:"sm",color:xe.Kk.colors.text.mutedDark,children:"Amount to Pay"}),(0,ke.jsxs)(k.z,{spacing:4,children:[(0,ke.jsxs)(j.T,{spacing:0,children:[(0,ke.jsxs)(I.E,{fontSize:"2xl",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:[d," BTC"]}),i&&t?(0,ke.jsxs)(j.T,{spacing:0,children:[(0,ke.jsxs)(k.z,{children:[(0,ke.jsxs)(I.E,{fontSize:"sm",textDecoration:"line-through",color:xe.Kk.colors.text.mutedDark,children:["$",t.toFixed(2)," AUD"]}),(0,ke.jsxs)(D.E,{colorScheme:"green",fontSize:"xs",children:[i,"% OFF"]})]}),(0,ke.jsxs)(I.E,{fontSize:"md",fontWeight:"bold",color:"green.400",children:["$",n.toFixed(2)," AUD"]}),(0,ke.jsxs)(I.E,{fontSize:"xs",color:"green.300",children:["You save $",(t-n).toFixed(2)," AUD"]})]}):(0,ke.jsxs)(I.E,{fontSize:"sm",color:xe.Kk.colors.text.mutedDark,children:["($",n.toFixed(2)," AUD)"]})]}),(0,ke.jsx)(M.K,{"aria-label":"Copy amount",icon:K?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:$,colorScheme:K?"green":"gray"})]})]})}),y?(0,ke.jsxs)(C.a,{textAlign:"center",py:8,children:[(0,ke.jsx)(Ce.y,{size:"xl",color:xe.Kk.colors.primary}),(0,ke.jsx)(I.E,{mt:2,color:xe.Kk.colors.text.mutedDark,children:"Generating unique Silent Payment address..."})]}):(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(C.a,{textAlign:"center",children:(0,ke.jsx)(C.a,{display:"inline-block",p:4,bg:"white",borderRadius:"md",border:"2px",borderColor:xe.Kk.colors.border.darkCard,children:(0,ke.jsx)(Ke.hp,{value:"bitcoin:".concat(a,"?amount=").concat(d,"&label=Invoice%20").concat(s.substring(0,4)),size:200,level:"H",includeMargin:!0})})}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(k.z,{justify:"space-between",mb:2,children:[(0,ke.jsx)(I.E,{fontSize:"sm",fontWeight:"bold",color:xe.Kk.colors.text.secondaryDark,children:"Silent Payment Address:"}),(0,ke.jsx)(A.$,{size:"xs",leftIcon:(0,ke.jsx)(We.A,{size:12}),onClick:()=>{P(!0),setTimeout(()=>{const e=$e(0,s,n);c(e),m(Ue(n)),P(!1),N({title:"New Address Generated",description:"A fresh Silent Payment address has been created.",status:"success",duration:3e3,isClosable:!0})},1e3)},variant:"ghost",isDisabled:"pending"!==u,children:"Regenerate"})]}),(0,ke.jsxs)(k.z,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",border:"1px",borderColor:xe.Kk.colors.border.darkCard,children:[(0,ke.jsx)(Be.C,{flex:1,p:2,fontSize:"xs",bg:"transparent",color:xe.Kk.colors.text.inverse,wordBreak:"break-all",children:a}),(0,ke.jsx)(M.K,{"aria-label":"Copy address",icon:W?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:F,colorScheme:W?"green":"gray"})]})]})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(A.$,{onClick:T,variant:"link",size:"sm",color:xe.Kk.colors.primary,children:[w?"Hide":"Show"," Payment Instructions"]}),(0,ke.jsx)(Te.S,{in:w,children:(0,ke.jsx)(C.a,{mt:3,p:4,bg:xe.Kk.colors.background.main,borderRadius:"md",children:(0,ke.jsxs)(j.T,{align:"start",spacing:2,fontSize:"sm",children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:"How to pay with Silent Bitcoin:"}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.secondaryDark,children:"1. Open your Silent Payment compatible wallet (Cake Wallet, Silentium, or BitBox02)"}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.secondaryDark,children:"2. Scan the QR code or copy the address above"}),(0,ke.jsxs)(I.E,{color:xe.Kk.colors.text.secondaryDark,children:["3. Send exactly ",d," BTC to complete the payment"]}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.secondaryDark,children:'4. Click "I\'ve Sent Payment" below to start monitoring'}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.mutedDark,fontSize:"xs",fontStyle:"italic",children:"Note: Silent Payments use standard Bitcoin network fees (~$1.18 average)"})]})})})]}),(0,ke.jsx)(z.c,{}),"pending"===u&&(0,ke.jsx)(A.$,{colorScheme:"orange",size:"lg",onClick:()=>{h("processing"),N({title:"Payment Processing",description:"Monitoring for your Bitcoin transaction...",status:"info",duration:5e3,isClosable:!0})},width:"full",children:"I've Sent Payment"}),"processing"===u&&(0,ke.jsxs)(j.T,{spacing:3,children:[(0,ke.jsxs)(k.z,{children:[(0,ke.jsx)(Ce.y,{size:"sm",color:xe.Kk.colors.primary}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.secondaryDark,children:"Monitoring blockchain for your transaction..."})]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,children:"This usually takes 10-30 minutes depending on network congestion"})]}),"confirmed"===u&&p&&(0,ke.jsxs)(f.F,{status:"success",borderRadius:"md",children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Payment Confirmed!"}),(0,ke.jsxs)(k.z,{mt:2,children:[(0,ke.jsx)(I.E,{fontSize:"xs",children:"Transaction ID:"}),(0,ke.jsxs)(ze.N,{href:"https://mempool.space/tx/".concat(p),isExternal:!0,color:"blue.500",fontSize:"xs",children:[p.substring(0,10),"...",p.substring(p.length-10),(0,ke.jsx)(ge.I,{as:Fe.A,ml:1,w:3,h:3})]})]})]})]}),l&&"default-pubkey"!==l&&(0,ke.jsxs)(f.F,{status:"info",borderRadius:"md",fontSize:"sm",mb:4,children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Payment Destination"}),(0,ke.jsx)(I.E,{fontSize:"xs",children:"This payment will be sent to the business's Bitcoin wallet. The Silent Payment protocol ensures your privacy while the funds go directly to the merchant."})]})]}),(!l||"default-pubkey"===l)&&(0,ke.jsxs)(f.F,{status:"warning",borderRadius:"md",fontSize:"sm",mb:4,children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"No Bitcoin Receiving Address Configured"}),(0,ke.jsx)(I.E,{fontSize:"xs",children:'The merchant has not configured a Bitcoin wallet address to receive payments. Please contact the merchant to add their Bitcoin (BTC) wallet address in their profile settings under "Payment Receiving Details" \u2192 "Cryptocurrency Wallets".'})]})]}),(0,ke.jsxs)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",fontSize:"xs",children:[(0,ke.jsx)(I.E,{fontWeight:"bold",mb:2,color:xe.Kk.colors.text.secondaryDark,children:"Recommended Wallets for Silent Payments:"}),(0,ke.jsxs)(k.z,{spacing:4,flexWrap:"wrap",children:[(0,ke.jsxs)(ze.N,{href:"https://cakewallet.com",isExternal:!0,color:"blue.400",children:["Cake Wallet ",(0,ke.jsx)(ge.I,{as:Fe.A,w:3,h:3})]}),(0,ke.jsxs)(ze.N,{href:"https://github.com/Silentium-app/Silentium",isExternal:!0,color:"blue.400",children:["Silentium ",(0,ke.jsx)(ge.I,{as:Fe.A,w:3,h:3})]}),(0,ke.jsxs)(ze.N,{href:"https://shiftcrypto.ch/bitbox02/",isExternal:!0,color:"blue.400",children:["BitBox02 ",(0,ke.jsx)(ge.I,{as:Fe.A,w:3,h:3})]})]})]})]})})]})},Oe=e=>{let{billId:n,amount:t,bankDetails:i,onPaymentInitiated:s}=e;const[o]=(0,r.useState)("INV-".concat(n.substring(0,4).toUpperCase())),[l,a]=(0,r.useState)(!1),c=(0,x.d)(),{hasCopied:d,onCopy:m}=(0,we.i)((null===i||void 0===i?void 0:i.accountName)||""),{hasCopied:u,onCopy:h}=(0,we.i)((null===i||void 0===i?void 0:i.bsb)||""),{hasCopied:p,onCopy:g}=(0,we.i)((null===i||void 0===i?void 0:i.accountNumber)||""),{hasCopied:b,onCopy:y}=(0,we.i)(o),{hasCopied:P,onCopy:T}=(0,we.i)(t.toFixed(2));return i?(0,ke.jsxs)(S.Z,{bg:xe.Kk.colors.background.cardGradient,borderColor:xe.Kk.colors.border.darkCard,borderWidth:"1px",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",backdropFilter:"blur(10px)",children:[(0,ke.jsx)(E.a,{children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsx)(I.E,{fontSize:"lg",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:"\ud83c\udfe6 Bank Transfer Payment"}),(0,ke.jsx)(D.E,{colorScheme:"blue",fontSize:"sm",px:3,py:1,children:"Manual Transfer"})]})}),(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[(0,ke.jsxs)(f.F,{status:"info",borderRadius:"md",children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Important: Include Reference Number"}),(0,ke.jsx)(I.E,{fontSize:"sm",children:"Please include the reference number when making your transfer to ensure your payment is correctly matched to this bill."})]})]}),(0,ke.jsx)(C.a,{p:4,bg:xe.Kk.colors.background.main,borderRadius:"md",border:"1px",borderColor:xe.Kk.colors.border.darkCard,children:(0,ke.jsxs)(j.T,{spacing:2,children:[(0,ke.jsx)(I.E,{fontSize:"sm",color:xe.Kk.colors.text.mutedDark,children:"Amount to Transfer"}),(0,ke.jsxs)(k.z,{children:[(0,ke.jsxs)(I.E,{fontSize:"3xl",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:["$",t.toFixed(2)]}),(0,ke.jsx)(B.m,{label:P?"Copied!":"Copy amount",children:(0,ke.jsx)(M.K,{"aria-label":"Copy amount",icon:P?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:T,colorScheme:P?"green":"gray",variant:"ghost"})})]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,children:"AUD - Australian Dollars"})]})}),(0,ke.jsx)(z.c,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",fontSize:"md",mb:3,color:xe.Kk.colors.text.inverse,children:"Bank Account Details"}),(0,ke.jsxs)(j.T,{spacing:3,align:"stretch",children:[(0,ke.jsx)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsxs)(C.a,{flex:1,children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,mb:1,children:"Account Name"}),(0,ke.jsx)(I.E,{fontWeight:"semibold",color:xe.Kk.colors.text.inverse,children:i.accountName})]}),(0,ke.jsx)(B.m,{label:d?"Copied!":"Copy",children:(0,ke.jsx)(M.K,{"aria-label":"Copy account name",icon:d?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:m,colorScheme:d?"green":"gray",variant:"ghost"})})]})}),(0,ke.jsxs)(w.r,{columns:2,spacing:3,children:[(0,ke.jsx)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsxs)(C.a,{flex:1,children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,mb:1,children:"BSB"}),(0,ke.jsx)(I.E,{fontWeight:"semibold",color:xe.Kk.colors.text.inverse,children:i.bsb})]}),(0,ke.jsx)(B.m,{label:u?"Copied!":"Copy",children:(0,ke.jsx)(M.K,{"aria-label":"Copy BSB",icon:u?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:h,colorScheme:u?"green":"gray",variant:"ghost"})})]})}),(0,ke.jsx)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsxs)(C.a,{flex:1,children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,mb:1,children:"Account Number"}),(0,ke.jsx)(I.E,{fontWeight:"semibold",color:xe.Kk.colors.text.inverse,children:i.accountNumber})]}),(0,ke.jsx)(B.m,{label:p?"Copied!":"Copy",children:(0,ke.jsx)(M.K,{"aria-label":"Copy account number",icon:p?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:g,colorScheme:p?"green":"gray",variant:"ghost"})})]})})]}),i.bankName&&(0,ke.jsxs)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,mb:1,children:"Bank Name"}),(0,ke.jsx)(I.E,{fontWeight:"semibold",color:xe.Kk.colors.text.inverse,children:i.bankName})]}),i.swiftCode&&(0,ke.jsxs)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:xe.Kk.colors.text.mutedDark,mb:1,children:"SWIFT Code (International Transfers)"}),(0,ke.jsx)(I.E,{fontWeight:"semibold",color:xe.Kk.colors.text.inverse,children:i.swiftCode})]}),(0,ke.jsx)(C.a,{p:3,bg:"orange.900",borderRadius:"md",borderWidth:"2px",borderColor:"orange.500",children:(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsxs)(C.a,{flex:1,children:[(0,ke.jsx)(I.E,{fontSize:"xs",color:"orange.200",mb:1,children:"\u26a0\ufe0f IMPORTANT - Payment Reference"}),(0,ke.jsx)(I.E,{fontWeight:"bold",fontSize:"lg",color:"white",children:o})]}),(0,ke.jsx)(B.m,{label:b?"Copied!":"Copy reference",children:(0,ke.jsx)(M.K,{"aria-label":"Copy reference",icon:b?(0,ke.jsx)(Ne.A,{}):(0,ke.jsx)(Re.A,{}),size:"sm",onClick:y,colorScheme:b?"green":"orange",variant:"solid"})})]})})]})]}),(0,ke.jsx)(z.c,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",fontSize:"sm",mb:2,color:xe.Kk.colors.text.inverse,children:"How to Complete Your Payment:"}),(0,ke.jsxs)(j.T,{align:"start",spacing:2,fontSize:"sm",color:xe.Kk.colors.text.secondaryDark,children:[(0,ke.jsx)(I.E,{children:"1. Log in to your online banking or visit your bank branch"}),(0,ke.jsx)(I.E,{children:"2. Create a new payment or transfer"}),(0,ke.jsx)(I.E,{children:"3. Enter the bank account details exactly as shown above"}),(0,ke.jsxs)(I.E,{children:["4. Enter $",t.toFixed(2)," as the amount"]}),(0,ke.jsxs)(I.E,{children:["5. ",(0,ke.jsxs)(I.E,{as:"span",fontWeight:"bold",color:"orange.400",children:["Include the reference: ",o]})]}),(0,ke.jsx)(I.E,{children:"6. Complete the transfer"}),(0,ke.jsx)(I.E,{children:'7. Click "I\'ve Made the Transfer" below'})]})]}),l?(0,ke.jsxs)(f.F,{status:"success",borderRadius:"md",children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Transfer Instructions Recorded"}),(0,ke.jsx)(I.E,{fontSize:"sm",children:"We'll confirm your payment once it's received (usually 1-2 business days). You'll receive an email confirmation when the payment is processed."})]})]}):(0,ke.jsx)(A.$,{colorScheme:"blue",size:"lg",width:"full",onClick:()=>{a(!0),s&&s(),c({title:"Payment Instructions Sent",description:"Please complete the bank transfer using the details provided. Your payment will be confirmed once received.",status:"info",duration:5e3,isClosable:!0})},children:"I've Made the Transfer"}),(0,ke.jsx)(C.a,{p:3,bg:xe.Kk.colors.background.main,borderRadius:"md",fontSize:"xs",children:(0,ke.jsxs)(k.z,{spacing:2,children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:xe.Kk.colors.text.secondaryDark,children:"Processing Time:"}),(0,ke.jsx)(I.E,{color:xe.Kk.colors.text.mutedDark,children:"1-2 business days for domestic transfers, 3-5 days for international"})]})})]})})]}):(0,ke.jsx)(S.Z,{bg:xe.Kk.colors.background.cardGradient,borderColor:xe.Kk.colors.border.darkCard,borderWidth:"1px",children:(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(f.F,{status:"warning",borderRadius:"md",children:[(0,ke.jsx)(v._,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",children:"Bank Transfer Not Available"}),(0,ke.jsx)(I.E,{fontSize:"sm",children:"Bank account details have not been configured for this merchant. Please choose a different payment method."})]})]})})})},Le=e=>{let{billId:n,amount:t,issuerWalletAddress:i,issuerBankDetails:s,cryptoDiscountPercentage:o,acceptCardPayment:l=!0,acceptCryptoPayment:a=!1,onPaymentComplete:c}=e;const[d,m]=(0,r.useState)(null),u=o?t*(1-o/100):t,h=e=>e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),p=[{id:"bank",name:"Bank Transfer",description:"Transaction data monitored by banks & AI surveillance companies",icon:be.A,color:"green",badge:"Most Popular",processingTime:"1-2 days",available:!!s,sovereignty:"Centralized \u2022 Subject to bank policies",privacyTooltip:"Bank transfers are subject to complete financial surveillance. Your transaction data is shared with government agencies, analyzed by AI companies like Palantir (a CIA-funded surveillance company), and stored indefinitely. This data is used to create a permanent digital profile of you that will be used to judge your behavior, limit your future options, deny services, and control what you can buy or sell. Banks can freeze, reverse, or block transactions at will based on their policies, government orders, or AI-driven risk scores. You have no control over your financial privacy or autonomy."},{id:"stripe",name:"Credit/Debit Card",description:"All data scraped by Palantir & AI companies for surveillance",icon:je.A,color:"blue",badge:"Card Payment",processingTime:"1-2 days",available:l,sovereignty:"Centralized \u2022 Card network controlled",privacyTooltip:"Credit card payments are the least private payment method. Palantir (a data mining company founded with CIA funding) aggregates all card transaction data to build detailed profiles of your spending habits, political views, and personal life. This permanent digital profile will be used to judge you, determine your social credit score, limit your access to services, control your interest rates, insurance premiums, and employment opportunities. Your purchase history becomes a tool for discrimination and social control. Card networks can block transactions, freeze accounts, and share your entire purchase history without your consent. Every purchase strengthens the surveillance system that will limit your children's freedoms."},{id:"bitcoin",name:"Bitcoin (Silent Payment)",description:o?"Enhanced privacy with BIP 352 + ".concat(o,"% discount!"):"Enhanced privacy with BIP 352 Silent Payments",icon:ye.A,color:"orange",badge:o?"".concat(o,"% OFF"):"Sovereign",processingTime:"10-30 min",available:a,sovereignty:"Sovereign \u2022 Self-custodial & censorship-resistant",privacyTooltip:"Bitcoin with Silent Payments (BIP 352) provides true financial sovereignty. No company, bank, or government can freeze, reverse, or censor your transactions. Silent Payments generate unique addresses for each transaction, preventing surveillance and protecting your privacy. You maintain complete control over your money without intermediaries collecting your data."}].filter(e=>e.available);return(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[!d&&(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(k.z,{mb:4,children:[(0,ke.jsx)(I.E,{fontSize:"lg",fontWeight:"bold",color:xe.Kk.colors.text.primaryDark,children:"Choose Payment Method"}),(0,ke.jsx)(D.E,{colorScheme:"red",fontSize:"sm",children:"Required"})]}),(0,ke.jsx)(w.r,{columns:{base:1,md:3},spacing:4,children:p.map(e=>(0,ke.jsx)(S.Z,{cursor:"pointer",onClick:()=>m(e.id),variant:"outline",borderWidth:"2px",borderColor:xe.Kk.colors.border.medium,bg:"transparent",_hover:{borderColor:"".concat(e.color,".500"),bg:xe.Kk.colors.background.cardGradient,transform:"translateY(-2px)",boxShadow:"md"},transition:"all 0.2s",children:(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(j.T,{align:"start",spacing:3,children:[(0,ke.jsxs)(k.z,{justify:"space-between",width:"100%",children:[(0,ke.jsx)(ge.I,{as:e.icon,w:8,h:8,color:"".concat(e.color,".500")}),(0,ke.jsx)(ge.I,{as:fe.A,w:5,h:5,color:xe.Kk.colors.text.mutedDark})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(k.z,{spacing:2,mb:1,children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:e.name}),e.badge&&(0,ke.jsx)(D.E,{colorScheme:e.color,size:"sm",children:e.badge})]}),(0,ke.jsxs)(k.z,{spacing:1,align:"start",children:[(0,ke.jsx)(I.E,{fontSize:"sm",color:xe.Kk.colors.text.secondaryDark,children:e.description}),e.privacyTooltip&&(0,ke.jsx)(B.m,{label:e.privacyTooltip,fontSize:"xs",placement:"top",hasArrow:!0,bg:"bitcoin"===e.id?"green.600":"red.600",color:"white",p:3,maxW:"300px",children:(0,ke.jsx)(ge.I,{as:ve.A,w:4,h:4,color:"bitcoin"===e.id?"green.400":"yellow.500",cursor:"help"})})]})]}),(0,ke.jsx)(k.z,{spacing:4,fontSize:"xs",color:xe.Kk.colors.text.mutedDark,children:(0,ke.jsxs)(I.E,{children:["Processing: ",(0,ke.jsx)(I.E,{as:"span",fontWeight:"bold",children:e.processingTime})]})}),e.sovereignty&&(0,ke.jsx)(I.E,{fontSize:"xs",color:"bitcoin"===e.id?"orange.300":"yellow.600",fontStyle:"italic",children:e.sovereignty}),(0,ke.jsx)(C.a,{pt:2,width:"100%",children:"bitcoin"===e.id&&o?(0,ke.jsxs)(j.T,{align:"start",spacing:0,children:[(0,ke.jsxs)(k.z,{children:[(0,ke.jsxs)(I.E,{fontSize:"lg",textDecoration:"line-through",color:xe.Kk.colors.text.mutedDark,children:["$",h(t)]}),(0,ke.jsxs)(D.E,{colorScheme:"green",fontSize:"xs",children:["Save $",h(t-u)]})]}),(0,ke.jsxs)(I.E,{fontSize:"2xl",fontWeight:"bold",color:"green.400",children:["$",h(u)]})]}):(0,ke.jsxs)(I.E,{fontSize:"2xl",fontWeight:"bold",color:xe.Kk.colors.text.inverse,children:["$",h(t)]})})]})})},e.id))})]}),d&&(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(k.z,{justify:"space-between",mb:4,children:[(0,ke.jsx)(I.E,{fontSize:"lg",fontWeight:"bold",color:xe.Kk.colors.text.primaryDark,children:"Complete Payment"}),(0,ke.jsx)(A.$,{variant:"ghost",size:"sm",onClick:()=>m(null),color:xe.Kk.colors.text.secondaryDark,children:"\u2190 Choose Different Method"})]}),"bank"===d&&(0,ke.jsx)(Oe,{billId:n,amount:t,bankDetails:s,onPaymentInitiated:()=>{console.log("[PaymentMethodSelector] Bank transfer initiated")}}),"stripe"===d&&(0,ke.jsx)(De,{billId:n,amount:t,onPaymentComplete:c}),"bitcoin"===d&&(0,ke.jsx)(Ye,{amount:u,originalAmount:o?t:void 0,discountPercentage:o,billId:n,issuerWalletAddress:i,onPaymentComplete:c})]})]})};var _e,Me,Ge,qe,Qe,He,Je,Ze,Ve,Xe,en,nn,tn,sn,on=t(33715),ln=function(e){return e.PROPOSAL="PROPOSAL",e.DRAFT="DRAFT",e.SENT="SENT",e}(ln||{});const rn=(0,c.J1)(_e||(_e=(0,l.A)(["\n  query GetBillById($id: ID!) {\n    bill(id: $id) {\n      id\n      isPaid\n      status\n      paymentMethod\n      currency\n      acceptCardPayment\n      acceptCryptoPayment\n      projectId\n      clientId\n      issuedBy\n      lineItems {\n        id\n        description\n        amount\n        createdAt\n        updatedAt\n      }\n      subtotal\n      taxPercentage\n      taxAmount\n      totalAmount\n      tenantId\n      createdAt\n      updatedAt\n    }\n  }\n"]))),an=(0,c.J1)(Me||(Me=(0,l.A)(["\n  query GetClient($id: ID!) {\n    client(id: $id) {\n      id\n      fName\n      lName\n      email\n      businessName\n      phoneNumber\n    }\n  }\n"]))),cn=(0,c.J1)(Ge||(Ge=(0,l.A)(["\n  mutation ToggleBillPaymentStatus($id: ID!) {\n    toggleBillPaymentStatus(id: $id) {\n      id\n      isPaid\n    }\n  }\n"]))),dn=(0,c.J1)(qe||(qe=(0,l.A)(["\n  mutation ToggleBillDraftStatus($id: ID!) {\n    toggleBillDraftStatus(id: $id) {\n      id\n      status\n    }\n  }\n"]))),mn=(0,c.J1)(Qe||(Qe=(0,l.A)(["\n  mutation UpdateBillStatus($id: ID!, $status: BillStatus!) {\n    updateBillStatus(id: $id, status: $status) {\n      id\n      status\n      lineItems {\n        id\n        description\n        amount\n      }\n      isPaid\n      totalAmount\n      paymentMethod\n      createdAt\n      updatedAt\n    }\n  }\n"]))),un=(0,c.J1)(He||(He=(0,l.A)(["\n  mutation UpdateLineItem($billId: ID!, $lineItemId: ID!, $amount: Float, $description: String) {\n    updateLineItem(\n      billId: $billId\n      lineItemId: $lineItemId\n      amount: $amount\n      description: $description\n    ) {\n      id\n      lineItems {\n        id\n        description\n        amount\n        createdAt\n        updatedAt\n      }\n      status\n      totalAmount\n      isPaid\n      updatedAt\n    }\n  }\n"]))),hn=(0,c.J1)(Je||(Je=(0,l.A)(["\n  mutation DeleteLineItem($billId: ID!, $lineItemId: ID!) {\n    deleteLineItem(billId: $billId, lineItemId: $lineItemId) {\n      id\n      lineItems {\n        id\n        description\n        amount\n        createdAt\n        updatedAt\n      }\n      status\n      totalAmount\n      isPaid\n      updatedAt\n    }\n  }\n"]))),pn=(0,c.J1)(Ze||(Ze=(0,l.A)(["\n  mutation UpdateBill($id: ID!, $input: BillInput!) {\n    updateBill(id: $id, input: $input) {\n      id\n      acceptCardPayment\n      acceptCryptoPayment\n    }\n  }\n"]))),xn=(0,c.J1)(Ve||(Ve=(0,l.A)(["\n  mutation DuplicateBillWithPercentage($id: ID!, $percentage: Float!, $paymentTerms: String) {\n    duplicateBillWithPercentage(id: $id, percentage: $percentage, paymentTerms: $paymentTerms) {\n      id\n      isPaid\n      status\n      currency\n      lineItems {\n        id\n        description\n        amount\n      }\n      totalAmount\n      percentageOfTotal\n      paymentTerms\n    }\n  }\n"]))),gn=(0,c.J1)(Xe||(Xe=(0,l.A)(["\n  query GetClientDetailsByBillId($billId: ID!) {\n    getClientDetailsByBillId(billId: $billId) {\n      id\n      fName\n      lName\n      email\n      phoneNumber\n      businessName\n    }\n  }\n"]))),bn=(0,c.J1)(en||(en=(0,l.A)(["\n  mutation ChangeBillClient($billId: ID!, $newClientId: ID!) {\n    changeBillClient(billId: $billId, newClientId: $newClientId)\n  }\n"]))),jn=(0,c.J1)(nn||(nn=(0,l.A)(["\n  query GetBillIssuerDetails($billId: ID!) {\n    getBillIssuerDetails(billId: $billId) {\n      id\n      fName\n      lName\n      email\n      phoneNumber\n      businessName\n      businessRegistrationNumber\n      paymentReceivingDetails {\n        acceptedMethods\n        bankAccount {\n          accountName\n          bsb\n          accountNumber\n          bankName\n          swiftCode\n        }\n        cryptoWallets {\n          walletAddress\n          network\n          memo\n        }\n        stripeConnect {\n          stripeAccountId\n          accountVerified\n          verifiedAt\n        }\n        paypalEmail\n        isVerified\n        cryptoDiscountPercentage\n      }\n    }\n  }\n"]))),yn=(0,c.J1)(tn||(tn=(0,l.A)(["\n  mutation ImportLineItemsFromMarkdown($billId: ID!, $markdown: String!) {\n    importLineItemsFromMarkdown(billId: $billId, markdown: $markdown) {\n      id\n      lineItems {\n        id\n        description\n        amount\n      }\n      totalAmount\n      status\n      isPaid\n      updatedAt\n    }\n  }\n"]))),fn=(0,c.J1)(sn||(sn=(0,l.A)(["\n  query GetCurrentTenantDetails {\n    currentTenant {\n      id\n      name\n      companyDetails {\n        companyName\n        taxId\n        billingEmail\n        billingPhone\n        billingAddress {\n          addressLine1\n          addressLine2\n          city\n          state\n          postalCode\n          country\n        }\n      }\n      paymentReceivingDetails {\n        acceptedMethods\n        bankAccount {\n          accountName\n          bsb\n          accountNumber\n          bankName\n          swiftCode\n        }\n        cryptoWallets {\n          walletAddress\n          network\n          memo\n        }\n        paypalEmail\n        cryptoDiscountPercentage\n      }\n    }\n  }\n"]))),vn=()=>{var e,n,t,i,s,l,c,ge,be,je,ye,fe,ve,Ce,Se,Ee,Pe,Ie,Ae,De,we,Be,Te,ze,Ne,Re,We,Fe,Ke,$e,Ue;(0,oe.H)("Bill Details");const{id:Ye}=(0,a.g)(),Oe=(0,a.Zp)(),{user:_e,isAuthenticated:Me,loading:Ge}=(0,ue.A)(),{colorMode:qe}=(0,p.G6)(),Qe=(0,xe.oU)("background.main"),He=(0,xe.oU)("background.cardGradient"),Je=(0,xe.oU)("border.darkCard"),Ze=(0,xe.oU)("text.primary"),Ve=(0,xe.oU)("text.secondary"),Xe=(0,xe.oU)("text.muted"),en=(0,xe.oU)("status.success"),nn=(null===_e||void 0===_e||null===(e=_e.permissions)||void 0===e?void 0:e.includes("ADMIN"))||(null===_e||void 0===_e||null===(n=_e.permissions)||void 0===n?void 0:n.includes("admin")),tn=e=>e.substring(0,4),{loading:sn,error:vn,data:Cn}=(0,d.IT)(rn,{variables:{id:Ye}}),{data:Sn,loading:En,error:kn}=(0,d.IT)(an,{variables:{id:null===Cn||void 0===Cn||null===(t=Cn.bill)||void 0===t?void 0:t.clientId},skip:!(null!==Cn&&void 0!==Cn&&null!==(i=Cn.bill)&&void 0!==i&&i.clientId)});r.useEffect(()=>{null!==Cn&&void 0!==Cn&&Cn.bill&&console.log("\ud83d\udccb Bill data loaded:",{billId:Cn.bill.id,clientId:Cn.bill.clientId,hasClientId:!!Cn.bill.clientId,projectId:Cn.bill.projectId})},[Cn]),r.useEffect(()=>{var e,n;console.log("\ud83d\udd0d Client query status:",{loading:En,hasData:!!Sn,hasClient:!(null===Sn||void 0===Sn||!Sn.client),hasError:!!kn,skip:!(null!==Cn&&void 0!==Cn&&null!==(e=Cn.bill)&&void 0!==e&&e.clientId),clientId:null===Cn||void 0===Cn||null===(n=Cn.bill)||void 0===n?void 0:n.clientId})},[En,Sn,kn,null===Cn||void 0===Cn||null===(s=Cn.bill)||void 0===s?void 0:s.clientId]),r.useEffect(()=>{null!==Sn&&void 0!==Sn&&Sn.client&&console.log("\ud83d\udc64 Client data loaded:",{clientId:Sn.client.id,name:"".concat(Sn.client.fName," ").concat(Sn.client.lName),email:Sn.client.email}),kn&&console.error("\u274c Error loading client:",kn)},[Sn,kn]);const{data:Pn,loading:In}=(0,d.IT)(jn,{variables:{billId:Ye}}),{data:An,loading:Dn}=(0,d.IT)(fn,{skip:!Me}),wn=(null===Pn||void 0===Pn?void 0:Pn.getBillIssuerDetails)||{businessName:null===An||void 0===An||null===(l=An.currentTenant)||void 0===l||null===(c=l.companyDetails)||void 0===c?void 0:c.companyName,email:null===An||void 0===An||null===(ge=An.currentTenant)||void 0===ge||null===(be=ge.companyDetails)||void 0===be?void 0:be.billingEmail,phoneNumber:null===An||void 0===An||null===(je=An.currentTenant)||void 0===je||null===(ye=je.companyDetails)||void 0===ye?void 0:ye.billingPhone,paymentReceivingDetails:null===An||void 0===An||null===(fe=An.currentTenant)||void 0===fe?void 0:fe.paymentReceivingDetails,fName:"",lName:""};console.log("Raw data:",Cn),console.log("Bill:",null===Cn||void 0===Cn?void 0:Cn.bill),console.log("Line Items:",null===Cn||void 0===Cn||null===(ve=Cn.bill)||void 0===ve?void 0:ve.lineItems),console.log("[BillDetails] Issuer crypto wallets:",null===wn||void 0===wn||null===(Ce=wn.paymentReceivingDetails)||void 0===Ce?void 0:Ce.cryptoWallets),console.log("[BillDetails] Bitcoin wallet found:",null===wn||void 0===wn||null===(Se=wn.paymentReceivingDetails)||void 0===Se||null===(Ee=Se.cryptoWallets)||void 0===Ee?void 0:Ee.find(e=>"BTC"===e.network));const Bn=(0,m.m)(),Tn=(0,x.d)(),[zn]=(0,u.n)(mn),[Nn]=(0,u.n)(un),[Rn]=(0,u.n)(hn),[Wn]=(0,u.n)(pn),[Fn]=(0,u.n)(xn),[Kn]=(0,u.n)(dn),[$n]=(0,u.n)(bn),[Un]=(0,u.n)(yn),[Yn,On]=r.useState(null),[Ln,_n]=r.useState({description:"",amount:0}),{isOpen:Mn,onOpen:Gn,onClose:qn}=(0,g.j)(),{isOpen:Qn,onOpen:Hn,onClose:Jn}=(0,g.j)(),{isOpen:Zn,onOpen:Vn,onClose:Xn}=(0,g.j)(),[et,nt]=r.useState(50),[tt,it]=r.useState(""),[st,ot]=r.useState(!1),lt=r.useRef(null),[rt,at]=r.useState([]),ct=async(e,n)=>{try{await Wn({variables:{id:Cn.bill.id,input:{acceptCardPayment:e,acceptCryptoPayment:n,projectId:Cn.bill.projectId,isPaid:Cn.bill.isPaid,currency:Cn.bill.currency||"AUD"}},refetchQueries:[{query:rn,variables:{id:Cn.bill.id}}]}),Tn({title:"Payment methods updated",status:"success",duration:3e3,isClosable:!0})}catch(vn){console.error("Error updating payment methods:",vn),Tn({title:"Error updating payment methods",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}};if(sn||Ge)return(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(ie.m,{}),(0,ke.jsx)(le.y,{moduleConfig:re.default}),(0,ke.jsx)(b.m,{maxW:"container.xl",py:8,children:(0,ke.jsxs)(j.T,{spacing:6,children:[(0,ke.jsx)(y.E,{height:"60px",width:"100%"}),(0,ke.jsx)(y.E,{height:"200px",width:"100%"}),(0,ke.jsx)(y.E,{height:"300px",width:"100%"})]})}),(0,ke.jsx)(se.n,{})]});if(vn)return(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(ie.m,{}),(0,ke.jsx)(le.y,{moduleConfig:re.default}),(0,ke.jsx)(b.m,{maxW:"container.xl",py:8,children:(0,ke.jsxs)(f.F,{status:"error",children:[(0,ke.jsx)(v._,{}),"Error loading bill details: ",vn.message]})})]});const dt=null===Cn||void 0===Cn?void 0:Cn.bill;if(console.log("[RENDER CHECK 1] About to check if bill exists",{bill:!!dt}),!dt)return console.log("[RENDER CHECK 2] Bill not found, showing error"),(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(ie.m,{}),(0,ke.jsx)(le.y,{moduleConfig:re.default}),(0,ke.jsx)(b.m,{maxW:"container.xl",py:8,children:(0,ke.jsxs)(f.F,{status:"info",children:[(0,ke.jsx)(v._,{}),"Bill not found"]})})]});console.log("[RENDER CHECK 3] Bill found, preparing to render"),console.log("[RENDER CHECK 4] isAuthenticated:",Me),console.log("[RENDER CHECK 5] user:",_e),console.log("[RENDER CHECK 6] isAdmin:",nn);const mt=e=>{const n=e instanceof Object?e.$date:e;return new Date(n).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"})},ut=e=>null===e||void 0===e?"0.00":e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return console.log("[RENDER CHECK 7] About to return main component"),(0,ke.jsxs)(C.a,{minH:"100vh",bg:Qe,children:[(0,ke.jsx)(ie.m,{}),(0,ke.jsx)(le.y,{moduleConfig:re.default}),(0,ke.jsx)(b.m,{maxW:"container.xl",py:8,children:(0,ke.jsx)(j.T,{spacing:6,align:"stretch",children:(0,ke.jsxs)(S.Z,{bg:He,borderColor:Je,borderWidth:"1px",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",backdropFilter:"blur(10px)",children:[(0,ke.jsx)(E.a,{children:(0,ke.jsxs)(j.T,{spacing:4,width:"100%",children:[(0,ke.jsxs)(k.z,{justify:"space-between",width:"100%",children:[(0,ke.jsxs)(j.T,{align:"start",spacing:2,children:[(0,ke.jsx)(P.D,{size:{base:"md",md:"lg"},color:Ze,children:"Bill Details"}),(0,ke.jsxs)(I.E,{color:Xe,fontSize:{base:"sm",md:"md"},children:["Invoice ID: ",tn(dt.id)]})]}),(0,ke.jsxs)(k.z,{spacing:{base:2,md:4},flexWrap:"wrap",children:[(dt.status===ln.DRAFT||dt.status===ln.PROPOSAL)&&nn&&(0,ke.jsx)(A.$,{colorScheme:"blue",size:{base:"sm",md:"md"},onClick:()=>{it("".concat(et,"% upfront payment")),Gn()},children:"Duplicate (Partial)"}),(0,ke.jsx)(A.$,{colorScheme:"purple",size:{base:"sm",md:"md"},onClick:()=>{Oe("/bill/".concat(Ye,"/preview"))},leftIcon:(0,ke.jsx)(ae.t,{}),children:"Preview PDF"}),(0,ke.jsx)(A.$,{colorScheme:"green",size:{base:"sm",md:"md"},onClick:async()=>{try{const e=(0,ke.jsx)(pe.C,{bill:dt,clientData:Sn,issuerData:Pn}),n=await(0,he.x8)(e).toBlob(),t=URL.createObjectURL(n),i=document.createElement("a");i.href=t,i.download="Invoice_".concat(tn(dt.id),"_").concat((new Date).toISOString().split("T")[0],".pdf"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t),Tn({title:"PDF downloaded successfully",status:"success",duration:3e3,isClosable:!0})}catch(vn){Tn({title:"Error generating PDF",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}},leftIcon:(0,ke.jsx)(ce.s,{}),children:"Download PDF"}),nn&&(0,ke.jsx)(A.$,{colorScheme:"blue",size:{base:"sm",md:"md"},onClick:async()=>{try{await zn({variables:{id:Cn.bill.id,status:ln.SENT},refetchQueries:[{query:rn,variables:{id:Cn.bill.id}}]}),Tn({title:"Bill sent successfully",status:"success",duration:3e3,isClosable:!0})}catch(vn){Tn({title:"Error sending bill",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}},isDisabled:dt.status===ln.SENT,children:"Send Bill"}),(0,ke.jsx)(D.E,{fontSize:{base:"md",md:"lg"},colorScheme:dt.status===ln.SENT?"blue":"gray",p:2,borderRadius:"md",children:dt.status})]})]}),(0,ke.jsx)(S.Z,{p:6,width:"100%",bg:He,borderColor:Je,borderWidth:"1px",borderRadius:"lg",children:(0,ke.jsx)(w.r,{columns:{base:1,md:2},spacing:8,children:(0,ke.jsx)(j.T,{align:"start",spacing:4,children:(0,ke.jsxs)(j.T,{spacing:4,align:"stretch",children:[(0,ke.jsx)(B.m,{label:"Toggle the payment status of this bill. Use this when payment has been received or to mark as unpaid.",placement:"top",hasArrow:!0,children:(0,ke.jsxs)(k.z,{justify:"flex-start",spacing:4,flexWrap:"wrap",children:[(0,ke.jsx)(I.E,{fontSize:{base:"lg",md:"xl"},fontWeight:"bold",color:Ze,children:"Payment Status:"}),(0,ke.jsx)(T.d,{size:"lg",isChecked:dt.isPaid,onChange:()=>(async e=>{try{await Bn.mutate({mutation:cn,variables:{id:e},refetchQueries:[{query:rn,variables:{id:e}}]}),Tn({title:"Bill marked as ".concat(null!==Cn&&void 0!==Cn&&Cn.bill.isPaid?"unpaid":"paid"),status:"success",duration:3e3,isClosable:!0})}catch(vn){console.error("Error toggling payment status:",vn),Tn({title:"Error updating payment status",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}})(dt.id),colorScheme:"green",sx:{"span.chakra-switch__track":{w:"4rem",h:"2rem"},"span.chakra-switch__thumb":{w:"1.75rem",h:"1.75rem"}}}),(0,ke.jsx)(I.E,{fontSize:{base:"lg",md:"xl"},fontWeight:"bold",color:dt.isPaid?en:Xe,children:dt.isPaid?"PAID":"UNPAID"})]})}),(0,ke.jsx)(z.c,{}),(0,ke.jsxs)(j.T,{align:"stretch",spacing:2,children:[(0,ke.jsxs)(k.z,{justify:"flex-start",spacing:4,flexWrap:"wrap",align:"center",children:[(0,ke.jsx)(I.E,{fontSize:{base:"lg",md:"xl"},fontWeight:"bold",color:Ze,children:"Bill Status:"}),nn?(0,ke.jsxs)(N.l,{value:dt.status,onChange:e=>(async e=>{try{await zn({variables:{id:null===Cn||void 0===Cn?void 0:Cn.bill.id,status:e},refetchQueries:[{query:rn,variables:{id:null===Cn||void 0===Cn?void 0:Cn.bill.id}}]}),Tn({title:"Bill marked as ".concat(e),status:"success",duration:3e3,isClosable:!0})}catch(vn){console.error("Error updating bill status:",vn),Tn({title:"Error updating bill status",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}})(e.target.value),width:"200px",size:"lg",bg:"light"===qe?dt.status===ln.PROPOSAL?"purple.50":dt.status===ln.DRAFT?"orange.50":"blue.50":dt.status===ln.PROPOSAL?"purple.900":dt.status===ln.DRAFT?"orange.900":"blue.900",borderColor:dt.status===ln.PROPOSAL?"purple.500":dt.status===ln.DRAFT?"orange.500":"blue.500",fontWeight:"bold",_hover:{borderColor:"gray.400"},children:[(0,ke.jsx)("option",{value:ln.PROPOSAL,children:"PROPOSAL"}),(0,ke.jsx)("option",{value:ln.DRAFT,children:"DRAFT"}),(0,ke.jsx)("option",{value:ln.SENT,children:"SENT"})]}):(0,ke.jsx)(D.E,{colorScheme:dt.status===ln.PROPOSAL?"purple":dt.status===ln.DRAFT?"orange":"blue",fontSize:"lg",px:4,py:2,children:dt.status}),(0,ke.jsx)(B.m,{label:dt.status===ln.PROPOSAL?"This is a proposal/quote - not counted in billing metrics":dt.status===ln.DRAFT?"This bill is in draft status - not sent to client yet":"This bill has been marked as sent to the client",hasArrow:!0,children:(0,ke.jsx)(D.E,{colorScheme:dt.status===ln.PROPOSAL?"purple":dt.status===ln.DRAFT?"orange":"blue",fontSize:"sm",px:3,py:1,children:dt.status===ln.PROPOSAL?"Quote - Not in metrics":dt.status===ln.DRAFT?"Not sent":"Sent to client"})})]}),dt.status===ln.DRAFT&&nn&&(0,ke.jsx)(I.E,{fontSize:"sm",color:Xe,pl:2,children:'\ud83d\udca1 Use "Send Bill to Client" button below to email this bill'})]})]})})})})]})}),(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(P.D,{size:"md",mb:4,color:Ze,children:"Bill Information"}),(0,ke.jsx)(S.Z,{variant:"outline",bg:He,borderColor:Je,children:(0,ke.jsxs)(R.b,{children:[(0,ke.jsxs)(w.r,{columns:2,spacing:4,children:[(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Created Date"}),(0,ke.jsx)(I.E,{color:Ze,children:mt(dt.createdAt)})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Last Updated"}),(0,ke.jsx)(I.E,{color:Ze,children:mt(dt.updatedAt)})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Payment Method"}),(0,ke.jsx)(I.E,{color:Ze,children:dt.paymentMethod||"Not specified"})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Total Amount"}),(0,ke.jsxs)(I.E,{color:Ze,children:["$",dt.totalAmount&&dt.totalAmount>0?ut(dt.totalAmount):ut((null===(Pe=dt.lineItems)||void 0===Pe?void 0:Pe.reduce((e,n)=>e+Number(n.amount),0))||0)," ",dt.currency||"AUD"]})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Tenant ID"}),(0,ke.jsx)(I.E,{color:Ze,children:dt.tenantId})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Project ID"}),dt.projectId?(0,ke.jsx)(I.E,{color:"blue.500",textDecoration:"underline",cursor:"pointer",_hover:{color:"blue.700"},onClick:()=>window.open("/project/".concat(dt.projectId),"_blank"),children:dt.projectId}):(0,ke.jsx)(I.E,{color:Ze,children:"Not associated with a project"})]})]}),dt.status===ln.DRAFT&&nn&&(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(z.c,{my:4,borderColor:Je}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontSize:"sm",fontWeight:"bold",color:Ze,mb:3,children:"Payment Methods Available to Customer"}),(0,ke.jsxs)(j.T,{align:"stretch",spacing:3,children:[(0,ke.jsxs)(W.MJ,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,ke.jsx)(F.l,{htmlFor:"card-payment-edit",mb:"0",color:Ve,children:"Accept Card Payments (Stripe)"}),(0,ke.jsx)(T.d,{id:"card-payment-edit",isChecked:null===(Ie=dt.acceptCardPayment)||void 0===Ie||Ie,onChange:e=>{var n;return ct(e.target.checked,null!==(n=dt.acceptCryptoPayment)&&void 0!==n&&n)},colorScheme:"blue"})]}),(0,ke.jsxs)(W.MJ,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,ke.jsx)(F.l,{htmlFor:"crypto-payment-edit",mb:"0",color:Ve,children:"Accept Crypto Payments (Bitcoin)"}),(0,ke.jsx)(T.d,{id:"crypto-payment-edit",isChecked:null!==(Ae=dt.acceptCryptoPayment)&&void 0!==Ae&&Ae,onChange:e=>{var n;return ct(null===(n=dt.acceptCardPayment)||void 0===n||n,e.target.checked)},colorScheme:"blue"})]})]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:Xe,mt:2,children:"These options can only be changed while the bill is in DRAFT status"})]})]}),dt.status!==ln.DRAFT&&(0,ke.jsxs)(C.a,{mt:4,children:[(0,ke.jsx)(I.E,{fontSize:"sm",fontWeight:"bold",color:Ze,mb:2,children:"Available Payment Methods:"}),(0,ke.jsxs)(k.z,{spacing:3,children:[(null===(De=dt.acceptCardPayment)||void 0===De||De)&&(0,ke.jsx)(D.E,{colorScheme:"blue",children:"Card Payment"}),dt.acceptCryptoPayment&&(0,ke.jsx)(D.E,{colorScheme:"orange",children:"Crypto Payment"}),!dt.acceptCardPayment&&!dt.acceptCryptoPayment&&(0,ke.jsx)(I.E,{fontSize:"sm",color:Xe,children:"Bank Transfer Only"})]})]})]})})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(k.z,{justify:"space-between",mb:4,children:[(0,ke.jsx)(P.D,{size:"md",color:Ze,children:"Client Information"}),nn&&(0,ke.jsx)(A.$,{size:"sm",leftIcon:(0,ke.jsx)(de.q,{}),onClick:Hn,colorScheme:"blue",variant:"outline",children:"Change Client"})]}),(0,ke.jsx)(S.Z,{variant:"outline",bg:He,borderColor:Je,children:(0,ke.jsx)(R.b,{children:En?(0,ke.jsx)(y.E,{height:"100px"}):null!==Sn&&void 0!==Sn&&Sn.client?(0,ke.jsxs)(w.r,{columns:2,spacing:4,children:[(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Name"}),(0,ke.jsxs)(I.E,{color:Ze,children:[Sn.client.fName," ",Sn.client.lName]})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Email"}),(0,ke.jsx)(I.E,{color:Ze,children:Sn.client.email})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Phone"}),(0,ke.jsx)(I.E,{color:Ze,children:Sn.client.phoneNumber||"Not provided"})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Business Name"}),(0,ke.jsx)(I.E,{color:Ze,children:Sn.client.businessName||"Not provided"})]})]}):(0,ke.jsx)(I.E,{color:Xe,children:"No client information available"})})})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(P.D,{size:"md",mb:4,color:Ze,children:"Bill Issued By"}),(0,ke.jsx)(S.Z,{variant:"outline",bg:He,borderColor:Je,children:(0,ke.jsx)(R.b,{children:In||Dn?(0,ke.jsx)(y.E,{height:"200px"}):wn?(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",fontSize:"lg",mb:3,color:Ze,children:"Business Information"}),(0,ke.jsxs)(w.r,{columns:2,spacing:4,children:[(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Business Name"}),(0,ke.jsx)(I.E,{color:Ze,children:xe.Kk.contact.businessName||wn.businessName||"Not provided"})]}),wn.businessRegistrationNumber&&(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Registration Number"}),(0,ke.jsx)(I.E,{color:Ze,children:wn.businessRegistrationNumber})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Contact Person"}),(0,ke.jsx)(I.E,{color:Ze,children:xe.Kk.contact.contactName||"".concat(wn.fName," ").concat(wn.lName)})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Email"}),(0,ke.jsx)(I.E,{color:Ze,children:xe.Kk.contact.email||wn.email})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontWeight:"bold",color:Ve,children:"Phone"}),(0,ke.jsx)(I.E,{color:Ze,children:xe.Kk.contact.phone||wn.phoneNumber||"Not provided"})]})]})]}),!1]}):(0,ke.jsx)(I.E,{color:Xe,children:"No issuer information available"})})})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsxs)(k.z,{justify:"space-between",mb:4,children:[(0,ke.jsx)(P.D,{size:"md",color:Ze,children:"Line Items"}),nn&&(0,ke.jsxs)(k.z,{spacing:2,children:[(0,ke.jsx)(B.m,{label:"Delete all line items",children:(0,ke.jsx)(A.$,{size:"sm",colorScheme:"red",variant:"outline",leftIcon:(0,ke.jsx)(me.d,{}),onClick:()=>{var e;if(window.confirm("Are you sure you want to delete all ".concat((null===(e=dt.lineItems)||void 0===e?void 0:e.length)||0," line items? This cannot be undone."))){var n;const e=null===(n=dt.lineItems)||void 0===n?void 0:n.map(e=>Rn({variables:{billId:dt.id,lineItemId:e.id}}));Promise.all(e||[]).then(()=>{Tn({title:"All line items deleted",status:"success",duration:3e3,isClosable:!0}),Bn.refetchQueries({include:[rn]})}).catch(e=>{Tn({title:"Error deleting line items",description:e.message,status:"error",duration:5e3,isClosable:!0})})}},isDisabled:!dt.lineItems||0===dt.lineItems.length,children:"Delete All"})}),(0,ke.jsx)(B.m,{label:"Export line items to markdown file",children:(0,ke.jsx)(A.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ke.jsx)(ce.s,{}),onClick:()=>{var e,n,t,i,s;let o="# ".concat((null===(e=dt.projectId)||void 0===e?void 0:e.projectName)||"Bill","\n\n");o+="## Project Information\n",o+="**Project Name:** ".concat((null===(n=dt.projectId)||void 0===n?void 0:n.projectName)||"N/A","\n"),null!==(t=dt.projectId)&&void 0!==t&&t.projectGoal&&(o+="**Project Goal:** ".concat(dt.projectId.projectGoal,"\n")),null!==(i=dt.projectId)&&void 0!==i&&i.projectDescription&&(o+="**Project Description:** ".concat(dt.projectId.projectDescription,"\n")),o+="\n",o+="## Bill Information\n",o+="**Currency:** ".concat(dt.currency||"AUD","\n"),o+="**Payment Method:** ".concat(dt.paymentMethod||"AUD_TRANSFER","\n"),o+="**Status:** ".concat(dt.status||"PROPOSAL","\n"),o+="\n",o+="## Line Items\n\n",null===(s=dt.lineItems)||void 0===s||s.forEach((e,n)=>{o+="### ".concat(n+1,". ").concat(e.description,"\n"),o+="**Price:** $".concat(e.amount.toFixed(2),"\n"),o+="**Billable:** Yes\n",o+="**Status:** PENDING\n",o+="**Assignee:** Unassigned\n",o+="\n"}),o+="## Agreement\n\n",o+="[Add your agreement text here, or leave this section empty]\n";const l=new Blob([o],{type:"text/markdown"}),r=URL.createObjectURL(l),a=document.createElement("a");a.href=r;const c="bill_".concat(dt.id.substring(0,8),"_line_items.md");a.download=c,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r),Tn({title:"Line items exported",description:"Downloaded ".concat(c),status:"success",duration:3e3,isClosable:!0})},children:"Export (.md)"})}),(0,ke.jsx)("input",{type:"file",ref:lt,onChange:async e=>{var n;const t=null===(n=e.target.files)||void 0===n?void 0:n[0];if(t)if(t.name.endsWith(".md")){ot(!0);try{const e=await t.text();await Un({variables:{billId:Ye,markdown:e},refetchQueries:[{query:rn,variables:{id:Ye}}]}),Tn({title:"Line items imported",description:"Successfully imported line items from ".concat(t.name),status:"success",duration:5e3,isClosable:!0}),Xn(),lt.current&&(lt.current.value="")}catch(vn){Tn({title:"Import failed",description:vn.message||"Failed to import line items",status:"error",duration:7e3,isClosable:!0})}finally{ot(!1)}}else Tn({title:"Invalid file type",description:"Please upload a .md (markdown) file",status:"error",duration:5e3,isClosable:!0})},accept:".md",style:{display:"none"}}),(0,ke.jsx)(B.m,{label:"Import line items from markdown file",children:(0,ke.jsx)(A.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ke.jsx)(ce.s,{transform:"rotate(180deg)"}),onClick:()=>{var e;return null===(e=lt.current)||void 0===e?void 0:e.click()},isLoading:st,children:"Import (.md)"})}),(0,ke.jsx)(B.m,{label:"Download markdown format specification guide",children:(0,ke.jsx)(A.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ke.jsx)(ae.t,{}),onClick:()=>{(0,h.g_)(h.Sd,"FORMAT_SPEC.md"),Tn({title:"Format guide downloaded",description:"Downloaded FORMAT_SPEC.md",status:"success",duration:3e3,isClosable:!0})},children:"Format Guide"})}),(0,ke.jsx)(B.m,{label:"Download blank markdown template",children:(0,ke.jsx)(A.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ke.jsx)(ce.s,{}),onClick:()=>{(0,h.g_)(h.l2,"bill_template.md"),Tn({title:"Template downloaded",description:"Downloaded bill_template.md",status:"success",duration:3e3,isClosable:!0})},children:"Template"})})]})]}),(0,ke.jsx)(S.Z,{variant:"outline",bg:He,borderColor:Je,children:(0,ke.jsx)(R.b,{children:(0,ke.jsxs)(C.a,{overflowX:"auto",width:"100%",children:[(0,ke.jsxs)(K.X,{variant:"simple",size:{base:"sm",md:"md"},children:[(0,ke.jsx)($.d,{children:(0,ke.jsxs)(U.Tr,{children:[(0,ke.jsx)(Y.Th,{color:Ve,children:"Description"}),(0,ke.jsxs)(Y.Th,{isNumeric:!0,color:Ve,children:["Amount (",dt.currency||"AUD",")"]}),(0,ke.jsx)(Y.Th,{color:Ve,children:nn?"Actions":""})]})}),(0,ke.jsx)(O.N,{children:dt.lineItems&&dt.lineItems.map(e=>{const n=Yn===e.id;return(0,ke.jsxs)(U.Tr,{children:[(0,ke.jsx)(L.Td,{maxW:{base:"150px",md:"300px"},overflow:"hidden",textOverflow:"ellipsis",children:n?(0,ke.jsx)(_.p,{value:Ln.description,onChange:e=>_n(n=>(0,o.A)((0,o.A)({},n),{},{description:e.target.value})),size:{base:"sm",md:"md"},bg:"light"===qe?"white":"rgba(255, 255, 255, 0.05)",color:Ze,borderColor:Je,_focus:{borderColor:"light"===qe?"#007AFF":"#3B82F6",boxShadow:"light"===qe?"0 0 0 1px rgba(0, 122, 255, 0.2)":"0 0 0 1px rgba(59, 130, 246, 0.2)"}}):(0,ke.jsx)(I.E,{color:Ze,children:e.description})}),(0,ke.jsx)(L.Td,{isNumeric:!0,children:n?(0,ke.jsx)(_.p,{type:"number",value:Ln.amount,onChange:e=>_n(n=>(0,o.A)((0,o.A)({},n),{},{amount:parseFloat(e.target.value)})),textAlign:"right",size:{base:"sm",md:"md"},bg:"light"===qe?"white":"rgba(255, 255, 255, 0.05)",color:Ze,borderColor:Je,_focus:{borderColor:"light"===qe?"#007AFF":"#3B82F6",boxShadow:"light"===qe?"0 0 0 1px rgba(0, 122, 255, 0.2)":"0 0 0 1px rgba(59, 130, 246, 0.2)"}}):(0,ke.jsxs)(I.E,{color:Ze,children:["$",ut(Number(e.amount))]})}),(0,ke.jsx)(L.Td,{children:nn?(0,ke.jsx)(k.z,{spacing:2,children:n?(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(A.$,{size:"sm",colorScheme:"green",onClick:async()=>{try{await Nn({variables:{billId:dt.id,lineItemId:e.id,description:Ln.description,amount:parseFloat(Ln.amount.toString())},refetchQueries:[{query:rn,variables:{id:dt.id}}]}),On(null),Tn({title:"Line item updated",status:"success",duration:3e3,isClosable:!0})}catch(vn){Tn({title:"Error updating line item",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}},px:{base:2,md:4},children:"Save"}),(0,ke.jsx)(A.$,{size:"sm",onClick:()=>On(null),px:{base:2,md:4},children:"Cancel"})]}):(0,ke.jsxs)(ke.Fragment,{children:[(0,ke.jsx)(M.K,{"aria-label":"Edit line item",icon:(0,ke.jsx)(de.q,{}),size:"sm",colorScheme:"blue",onClick:()=>{console.log("Setting edit ID to:",e.id),On(e.id),_n({description:e.description,amount:e.amount})}}),(0,ke.jsx)(M.K,{"aria-label":"Delete line item",icon:(0,ke.jsx)(me.d,{}),size:"sm",colorScheme:"red",onClick:async()=>{if(window.confirm("Are you sure you want to delete this line item?"))try{await Rn({variables:{billId:dt.id,lineItemId:e.id},refetchQueries:[{query:rn,variables:{id:dt.id}}]}),Tn({title:"Line item deleted",status:"success",duration:3e3,isClosable:!0})}catch(vn){Tn({title:"Error deleting line item",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}}})]})}):(0,ke.jsx)(I.E,{color:Xe,fontSize:"sm",children:"-"})})]},e.id)})})]}),(0,ke.jsxs)(j.T,{align:"stretch",mt:6,bg:He,p:4,borderRadius:"md",border:"1px",borderColor:Je,spacing:2,children:[(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsx)(I.E,{fontSize:"md",color:Ve,children:"Subtotal:"}),(0,ke.jsxs)(I.E,{fontSize:"md",color:Ze,children:["$",void 0!==dt.subtotal?ut(dt.subtotal):ut((null===(we=dt.lineItems)||void 0===we?void 0:we.reduce((e,n)=>e+Number(n.amount),0))||0)," ",dt.currency||"AUD"]})]}),void 0!==dt.taxPercentage&&dt.taxPercentage>0&&(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsxs)(I.E,{fontSize:"md",color:Ve,children:["GST (",dt.taxPercentage,"%):"]}),(0,ke.jsxs)(I.E,{fontSize:"md",color:Ze,children:["$",void 0!==dt.taxAmount?ut(dt.taxAmount):"0.00"," ",dt.currency||"AUD"]})]}),(0,ke.jsx)(z.c,{}),(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsx)(I.E,{fontWeight:"bold",fontSize:"lg",color:Ze,children:"Total:"}),(0,ke.jsxs)(I.E,{fontWeight:"bold",fontSize:"lg",color:Ze,children:["$",dt.totalAmount&&dt.totalAmount>0?ut(dt.totalAmount):ut((null===(Be=dt.lineItems)||void 0===Be?void 0:Be.reduce((e,n)=>e+Number(n.amount),0))||0)," ",dt.currency||"AUD"]})]})]})]})})})]}),!dt.isPaid&&(0,ke.jsx)(C.a,{children:(0,ke.jsx)(S.Z,{variant:"outline",borderColor:"blue.500",borderWidth:"2px",bg:He,boxShadow:"0 4px 20px 0 rgba(59, 130, 246, 0.15)",children:(0,ke.jsx)(R.b,{children:(0,ke.jsx)(Le,{billId:dt.id,amount:dt.totalAmount&&dt.totalAmount>0?dt.totalAmount:(null===(Te=dt.lineItems)||void 0===Te?void 0:Te.reduce((e,n)=>e+Number(n.amount),0))||0,acceptCardPayment:null===(ze=dt.acceptCardPayment)||void 0===ze||ze,acceptCryptoPayment:null!==(Ne=dt.acceptCryptoPayment)&&void 0!==Ne&&Ne,issuerBankDetails:null===wn||void 0===wn||null===(Re=wn.paymentReceivingDetails)||void 0===Re?void 0:Re.bankAccount,issuerWalletAddress:null===wn||void 0===wn||null===(We=wn.paymentReceivingDetails)||void 0===We||null===(Fe=We.cryptoWallets)||void 0===Fe||null===(Ke=Fe.find(e=>"BTC"===e.network))||void 0===Ke?void 0:Ke.walletAddress,cryptoDiscountPercentage:null===wn||void 0===wn||null===($e=wn.paymentReceivingDetails)||void 0===$e?void 0:$e.cryptoDiscountPercentage,onPaymentComplete:()=>{console.log("[BillDetails] Payment completed, refreshing bill data"),Bn.refetchQueries({include:[rn]}),Tn({title:"Payment Successful",description:"Your payment has been processed successfully.",status:"success",duration:5e3,isClosable:!0})}})})})})]})})]})})}),(0,ke.jsxs)(G.aF,{isOpen:Mn,onClose:qn,size:"xl",children:[(0,ke.jsx)(q.m,{}),(0,ke.jsxs)(Q.$,{bg:He,borderColor:Je,borderWidth:"1px",children:[(0,ke.jsx)(H.r,{color:Ze,children:"Create Partial Bill"}),(0,ke.jsx)(J.s,{color:Ze}),(0,ke.jsx)(Z.c,{children:(0,ke.jsxs)(j.T,{spacing:6,align:"stretch",children:[(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(F.l,{color:Ze,mb:3,children:"Percentage of Total"}),(0,ke.jsxs)(k.z,{spacing:4,align:"start",children:[(0,ke.jsxs)(C.a,{flex:1,children:[(0,ke.jsxs)(V.Ap,{value:et>10?et:10,onChange:nt,min:10,max:100,step:1,colorScheme:"blue",children:[(0,ke.jsx)(V.hB,{bg:"gray.600",children:(0,ke.jsx)(V.hJ,{})}),(0,ke.jsx)(V.OQ,{boxSize:6})]}),(0,ke.jsxs)(k.z,{justify:"space-between",mt:2,children:[(0,ke.jsx)(I.E,{fontSize:"sm",color:Xe,children:"10%"}),(0,ke.jsx)(I.E,{fontSize:"sm",color:Xe,children:"50%"}),(0,ke.jsx)(I.E,{fontSize:"sm",color:Xe,children:"100%"})]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:Xe,mt:1,children:"Use slider for rough percentages (10-100%), or type exact decimal in the input \u2192"})]}),(0,ke.jsxs)(C.a,{width:"140px",children:[(0,ke.jsxs)(X.M,{size:"md",children:[(0,ke.jsx)(_.p,{type:"number",value:et,onChange:e=>{const n=parseFloat(e.target.value);!isNaN(n)&&n>=.01&&n<=100&&nt(n)},min:.01,max:100,step:"any",bg:"light"===qe?"white":"rgba(255, 255, 255, 0.05)",borderColor:Je,color:Ze,textAlign:"right"}),(0,ke.jsx)(ee.r0,{bg:"light"===qe?"gray.100":"gray.700",color:Ze,children:"%"})]}),(0,ke.jsx)(I.E,{fontSize:"xs",color:Xe,mt:1,textAlign:"center",children:"Any % (e.g., 11.90688813)"})]})]})]}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(F.l,{color:Ze,children:"Payment Terms (Optional)"}),(0,ke.jsx)(ne.T,{placeholder:"".concat(et,"% upfront payment"),value:tt,onChange:e=>it(e.target.value),bg:"light"===qe?"white":"rgba(255, 255, 255, 0.05)",borderColor:Je,color:Ze,_placeholder:{color:Xe},_hover:{borderColor:Ve},_focus:{borderColor:"light"===qe?"#007AFF":"#3B82F6",boxShadow:"light"===qe?"0 0 0 1px rgba(0, 122, 255, 0.2)":"0 0 0 1px rgba(59, 130, 246, 0.2)"},rows:2})]}),(0,ke.jsxs)(C.a,{p:4,bg:"light"===qe?"gray.50":"rgba(0, 0, 0, 0.3)",borderRadius:"md",children:[(0,ke.jsx)(I.E,{color:Ze,fontWeight:"bold",mb:3,children:"New Bill Preview:"}),(0,ke.jsxs)(j.T,{align:"stretch",spacing:2,children:[null===dt||void 0===dt||null===(Ue=dt.lineItems)||void 0===Ue?void 0:Ue.map((e,n)=>(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsx)(I.E,{color:Ve,fontSize:"sm",noOfLines:1,children:e.description}),(0,ke.jsxs)(I.E,{color:Ze,fontWeight:"bold",children:["$",ut(e.amount*et/100)]})]},n)),(0,ke.jsx)(z.c,{borderColor:Je}),(0,ke.jsxs)(k.z,{justify:"space-between",children:[(0,ke.jsx)(I.E,{color:Ze,fontWeight:"bold",children:"Total:"}),(0,ke.jsxs)(I.E,{color:Ze,fontWeight:"bold",fontSize:"lg",children:["$",(e=>{const n=null!==dt&&void 0!==dt&&dt.totalAmount&&dt.totalAmount>0?dt.totalAmount:(null===dt||void 0===dt||null===(e=dt.lineItems)||void 0===e?void 0:e.reduce((e,n)=>e+Number(n.amount),0))||0;return ut(n*et/100)})()," ",(null===dt||void 0===dt?void 0:dt.currency)||"AUD"]})]})]})]})]})}),(0,ke.jsxs)(te.j,{children:[(0,ke.jsx)(A.$,{variant:"ghost",mr:3,onClick:qn,color:Ze,children:"Cancel"}),(0,ke.jsxs)(A.$,{colorScheme:"blue",onClick:async()=>{try{const e=tt||"".concat(et,"% upfront payment"),{data:n}=await Fn({variables:{id:Cn.bill.id,percentage:et,paymentTerms:e}});Tn({title:"Bill duplicated successfully",description:"Created ".concat(et,"% partial bill"),status:"success",duration:5e3,isClosable:!0}),qn(),Oe("/bill/".concat(n.duplicateBillWithPercentage.id))}catch(vn){console.error("Error duplicating bill:",vn),Tn({title:"Error duplicating bill",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}},children:["Create ",et,"% Bill"]})]})]})]}),(0,ke.jsxs)(G.aF,{isOpen:Qn,onClose:Jn,size:"xl",children:[(0,ke.jsx)(q.m,{}),(0,ke.jsxs)(Q.$,{bg:Qe,color:Ze,children:[(0,ke.jsx)(H.r,{children:"Change Bill Client"}),(0,ke.jsx)(J.s,{}),(0,ke.jsx)(Z.c,{children:(0,ke.jsxs)(j.T,{spacing:4,align:"stretch",children:[(0,ke.jsx)(I.E,{color:Ve,children:"Select a new client for this bill. This will update the billing information."}),(null===Sn||void 0===Sn?void 0:Sn.getClientDetailsByBillId)&&(0,ke.jsxs)(C.a,{p:4,borderRadius:"md",bg:"dark"===qe?"rgba(30, 30, 35, 0.8)":"gray.50",children:[(0,ke.jsx)(I.E,{fontSize:"sm",fontWeight:"bold",color:Ve,mb:2,children:"Current Client:"}),(0,ke.jsxs)(I.E,{color:Ze,children:[Sn.getClientDetailsByBillId.fName," ",Sn.getClientDetailsByBillId.lName]}),(0,ke.jsx)(I.E,{fontSize:"sm",color:Ve,children:Sn.getClientDetailsByBillId.email})]}),(0,ke.jsx)(z.c,{}),(0,ke.jsxs)(C.a,{children:[(0,ke.jsx)(I.E,{fontSize:"sm",fontWeight:"bold",color:Ve,mb:3,children:"Select New Client:"}),(0,ke.jsx)(on.l,{selectedClients:rt,onSelectionChange:at,allowMultiple:!1,placeholder:"Search for a client..."})]})]})}),(0,ke.jsxs)(te.j,{children:[(0,ke.jsx)(A.$,{variant:"ghost",mr:3,onClick:Jn,color:Ze,children:"Cancel"}),(0,ke.jsx)(A.$,{colorScheme:"blue",onClick:async()=>{if(0!==rt.length)try{await $n({variables:{billId:Ye,newClientId:rt[0]}}),Tn({title:"Client changed successfully",status:"success",duration:3e3,isClosable:!0}),await Bn.refetchQueries({include:[gn]}),Jn(),at([])}catch(vn){console.error("Error changing client:",vn),Tn({title:"Error changing client",description:vn instanceof Error?vn.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}else Tn({title:"No client selected",description:"Please select a client to change to",status:"warning",duration:3e3,isClosable:!0})},isDisabled:0===rt.length,children:"Change Client"})]})]})]}),(0,ke.jsx)(se.n,{})]})}},22992:(e,n,t)=>{"use strict";t.d(n,{C:()=>r});t(65043);var i=t(27682),s=t(39985),o=t(70579);const l=i.vv.create({page:{fontFamily:"Helvetica",fontSize:11,paddingTop:30,paddingLeft:60,paddingRight:60,paddingBottom:40,lineHeight:1.5,flexDirection:"column"},header:{flexDirection:"row",marginBottom:20,paddingBottom:20,borderBottomWidth:2,borderBottomColor:"#112233"},headerLeft:{flex:1},headerRight:{flex:1,textAlign:"right"},title:{fontSize:24,marginBottom:10,fontWeight:"bold",color:"#112233"},billInfo:{flexDirection:"row",marginBottom:20},billInfoLeft:{flex:1},billInfoRight:{flex:1},section:{marginBottom:15},sectionTitle:{fontSize:14,fontWeight:"bold",marginBottom:8,color:"#112233",borderBottomWidth:1,borderBottomColor:"#112233",paddingBottom:4},row:{flexDirection:"row",marginBottom:5},label:{fontSize:10,fontWeight:"bold",marginRight:10,color:"#666",width:100},value:{fontSize:10,flex:1},table:{marginTop:15,marginBottom:20},tableHeader:{flexDirection:"row",borderBottomWidth:2,borderBottomColor:"#112233",backgroundColor:"#f5f5f5",paddingTop:8,paddingBottom:8},tableRow:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"#e0e0e0",paddingTop:8,paddingBottom:8},tableCol:{fontSize:10,paddingLeft:8,paddingRight:8},tableColHeader:{fontSize:11,fontWeight:"bold",paddingLeft:8,paddingRight:8,color:"#112233"},descriptionCol:{width:"50%"},dateCol:{width:"25%"},amountCol:{width:"25%",textAlign:"right"},totalSection:{flexDirection:"row",justifyContent:"flex-end",marginTop:15,paddingTop:15,borderTopWidth:2,borderTopColor:"#112233"},totalLabel:{fontSize:14,fontWeight:"bold",marginRight:20,color:"#112233"},totalAmount:{fontSize:14,fontWeight:"bold",color:"#112233",width:100,textAlign:"right"},paymentStatus:{marginTop:20,padding:10,backgroundColor:"#f9f9f9",borderRadius:4},paymentStatusText:{fontSize:12,fontWeight:"bold",textAlign:"center"},paymentPaid:{color:"#22c55e"},paymentUnpaid:{color:"#ef4444"},footer:{marginTop:40,paddingTop:20,borderTopWidth:1,borderTopColor:"#e0e0e0",textAlign:"center",fontSize:9,color:"#666"}}),r=e=>{var n,t,r;let{bill:a,clientData:c,issuerData:d}=e;console.log("[BillPDF] Bill data:",{id:null===a||void 0===a?void 0:a.id,acceptCardPayment:null===a||void 0===a?void 0:a.acceptCardPayment,acceptCryptoPayment:null===a||void 0===a?void 0:a.acceptCryptoPayment,status:null===a||void 0===a?void 0:a.status});const m=e=>{const n=e instanceof Object?e.$date:e;return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},u=e=>e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),h=()=>{var e;return a.totalAmount&&a.totalAmount>0?a.totalAmount:(null===(e=a.lineItems)||void 0===e?void 0:e.length)>0?a.lineItems.reduce((e,n)=>e+Number(n.amount),0):0};return(0,o.jsx)(i.yo,{children:(0,o.jsxs)(i.YW,{size:"A4",style:l.page,children:[(0,o.jsxs)(i.Ss,{style:l.header,children:[(0,o.jsxs)(i.Ss,{style:l.headerLeft,children:[(0,o.jsx)(i.EY,{style:l.title,children:"INVOICE"}),(0,o.jsxs)(i.EY,{children:["Invoice ID: ",(p=a.id,p.substring(0,4))]}),(0,o.jsxs)(i.EY,{children:["Status: ",a.status]})]}),(0,o.jsxs)(i.Ss,{style:l.headerRight,children:[(0,o.jsxs)(i.EY,{children:["Date: ",m(a.createdAt)]}),"SENT"===a.status&&(0,o.jsxs)(i.EY,{children:["Sent: ",m(a.updatedAt)]})]})]}),(0,o.jsxs)(i.Ss,{style:l.billInfo,children:[(0,o.jsx)(i.Ss,{style:l.billInfoLeft,children:(0,o.jsxs)(i.Ss,{style:l.section,children:[(0,o.jsx)(i.EY,{style:l.sectionTitle,children:"Bill From:"}),null!==d&&void 0!==d&&d.getBillIssuerDetails?(0,o.jsxs)(o.Fragment,{children:[(s.Kk.contact.businessName||d.getBillIssuerDetails.businessName)&&(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Business:"}),(0,o.jsx)(i.EY,{style:l.value,children:s.Kk.contact.businessName||d.getBillIssuerDetails.businessName})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Contact:"}),(0,o.jsx)(i.EY,{style:l.value,children:s.Kk.contact.contactName||"".concat(d.getBillIssuerDetails.fName," ").concat(d.getBillIssuerDetails.lName)})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Email:"}),(0,o.jsx)(i.EY,{style:l.value,children:s.Kk.contact.email||d.getBillIssuerDetails.email})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Phone:"}),(0,o.jsx)(i.EY,{style:l.value,children:s.Kk.contact.phone||d.getBillIssuerDetails.phoneNumber})]}),d.getBillIssuerDetails.businessRegistrationNumber&&(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"ABN/ACN:"}),(0,o.jsx)(i.EY,{style:l.value,children:d.getBillIssuerDetails.businessRegistrationNumber})]})]}):(0,o.jsx)(i.EY,{style:l.value,children:"Issuer information not available"})]})}),(0,o.jsx)(i.Ss,{style:l.billInfoRight,children:(0,o.jsxs)(i.Ss,{style:l.section,children:[(0,o.jsx)(i.EY,{style:l.sectionTitle,children:"Bill To:"}),null!==c&&void 0!==c&&c.getClientDetailsByBillId?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Name:"}),(0,o.jsxs)(i.EY,{style:l.value,children:[c.getClientDetailsByBillId.fName," ",c.getClientDetailsByBillId.lName]})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Email:"}),(0,o.jsx)(i.EY,{style:l.value,children:c.getClientDetailsByBillId.email})]}),c.getClientDetailsByBillId.phoneNumber&&(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Phone:"}),(0,o.jsx)(i.EY,{style:l.value,children:c.getClientDetailsByBillId.phoneNumber})]}),c.getClientDetailsByBillId.businessName&&(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Business:"}),(0,o.jsx)(i.EY,{style:l.value,children:c.getClientDetailsByBillId.businessName})]})]}):(0,o.jsx)(i.EY,{style:l.value,children:"Client information not available"})]})})]}),(0,o.jsxs)(i.Ss,{style:l.section,children:[(0,o.jsx)(i.EY,{style:l.sectionTitle,children:"Services & Items"}),(0,o.jsxs)(i.Ss,{style:l.table,children:[(0,o.jsxs)(i.Ss,{style:l.tableHeader,children:[(0,o.jsx)(i.EY,{style:[l.tableColHeader,l.descriptionCol],children:"Description"}),(0,o.jsx)(i.EY,{style:[l.tableColHeader,l.dateCol],children:"Date"}),(0,o.jsx)(i.EY,{style:[l.tableColHeader,l.amountCol],children:"Amount (AUD)"})]}),a.lineItems&&a.lineItems.map((e,n)=>(0,o.jsxs)(i.Ss,{style:l.tableRow,children:[(0,o.jsx)(i.EY,{style:[l.tableCol,l.descriptionCol],children:e.description}),(0,o.jsx)(i.EY,{style:[l.tableCol,l.dateCol],children:m(e.createdAt)}),(0,o.jsxs)(i.EY,{style:[l.tableCol,l.amountCol],children:["$",u(Number(e.amount))]})]},n))]})]}),(0,o.jsxs)(i.Ss,{style:l.totalSection,children:[(0,o.jsxs)(i.EY,{style:l.totalLabel,children:["Total Amount (",a.currency||"AUD","):"]}),(0,o.jsxs)(i.EY,{style:l.totalAmount,children:["$",(()=>{var e;if(a.totalAmount&&a.totalAmount>0)return u(a.totalAmount);if((null===(e=a.lineItems)||void 0===e?void 0:e.length)>0){const e=a.lineItems.reduce((e,n)=>e+Number(n.amount),0);return u(e)}return"0.00"})()," ",a.currency||"AUD"]})]}),(0,o.jsx)(i.Ss,{style:l.paymentStatus,children:(0,o.jsxs)(i.EY,{style:[l.paymentStatusText,a.isPaid?l.paymentPaid:l.paymentUnpaid],children:["Payment Status: ",a.isPaid?"PAID":"UNPAID"]})}),(null===d||void 0===d||null===(n=d.getBillIssuerDetails)||void 0===n?void 0:n.paymentReceivingDetails)&&(0,o.jsxs)(i.Ss,{style:[l.section,{marginBottom:30}],children:[(0,o.jsx)(i.EY,{style:l.sectionTitle,children:"Payment Information"}),d.getBillIssuerDetails.paymentReceivingDetails.bankAccount&&(0,o.jsxs)(i.Ss,{style:{marginBottom:10},children:[(0,o.jsx)(i.EY,{style:{fontSize:11,fontWeight:"bold",marginBottom:5},children:"Bank Transfer:"}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Account Name:"}),(0,o.jsx)(i.EY,{style:l.value,children:d.getBillIssuerDetails.paymentReceivingDetails.bankAccount.accountName})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"BSB:"}),(0,o.jsx)(i.EY,{style:l.value,children:d.getBillIssuerDetails.paymentReceivingDetails.bankAccount.bsb})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Account:"}),(0,o.jsx)(i.EY,{style:l.value,children:d.getBillIssuerDetails.paymentReceivingDetails.bankAccount.accountNumber})]})]}),(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Reference:"}),(0,o.jsxs)(i.EY,{style:l.value,children:["INV-",a.id.substring(0,4).toUpperCase()]})]}),((null===(t=d.getBillIssuerDetails.paymentReceivingDetails.acceptedMethods)||void 0===t?void 0:t.includes("STRIPE"))&&!1!==a.acceptCardPayment||(null===(r=d.getBillIssuerDetails.paymentReceivingDetails.acceptedMethods)||void 0===r?void 0:r.includes("CRYPTO"))&&!0===a.acceptCryptoPayment)&&(0,o.jsxs)(i.Ss,{style:{marginTop:10,marginBottom:15,padding:10,backgroundColor:"#f7f9fc",borderRadius:5,border:"1px solid #e0e0e0"},children:[(0,o.jsx)(i.EY,{style:{fontSize:11,fontWeight:"bold",marginBottom:8,color:"#333"},children:"Online Payment Options"}),((e,n)=>{const t="".concat("https://tommillerservices.com","/bill/").concat(a.id);return(0,o.jsxs)(i.Ss,{children:[(null===(e=d.getBillIssuerDetails.paymentReceivingDetails.acceptedMethods)||void 0===e?void 0:e.includes("STRIPE"))&&!1!==a.acceptCardPayment&&(0,o.jsx)(i.Ss,{style:{marginBottom:5},children:(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Credit/Debit Card:"}),(0,o.jsx)(i.N_,{src:t,style:{fontSize:10,color:"#007AFF",textDecoration:"underline",flex:1},children:"Pay with Visa, Mastercard, or Amex"})]})}),(null===(n=d.getBillIssuerDetails.paymentReceivingDetails.acceptedMethods)||void 0===n?void 0:n.includes("CRYPTO"))&&!0===a.acceptCryptoPayment&&(0,o.jsx)(i.Ss,{style:{marginBottom:5},children:(0,o.jsxs)(i.Ss,{style:l.row,children:[(0,o.jsx)(i.EY,{style:l.label,children:"Bitcoin (BTC):"}),(0,o.jsxs)(i.Ss,{style:{flex:1},children:[(0,o.jsxs)(i.N_,{src:t,style:{fontSize:10,color:"#007AFF",textDecoration:"underline"},children:["Pay with Bitcoin Silent Payments",d.getBillIssuerDetails.paymentReceivingDetails.cryptoDiscountPercentage&&" (".concat(d.getBillIssuerDetails.paymentReceivingDetails.cryptoDiscountPercentage,"% discount)")]}),d.getBillIssuerDetails.paymentReceivingDetails.cryptoDiscountPercentage&&(0,o.jsxs)(i.EY,{style:{fontSize:9,color:"#28a745",marginTop:2},children:["Save $",u(h()*d.getBillIssuerDetails.paymentReceivingDetails.cryptoDiscountPercentage/100)," ",a.currency||"AUD"]})]})]})}),(0,o.jsxs)(i.Ss,{style:{marginTop:8,padding:5,backgroundColor:"#e8f4f8",borderRadius:3},children:[(0,o.jsx)(i.EY,{style:{fontSize:9,color:"#666",marginBottom:3},children:"Payment Link:"}),(0,o.jsx)(i.N_,{src:t,style:{fontSize:9,color:"#007AFF",textDecoration:"underline"},children:t})]})]})})()]}),d.getBillIssuerDetails.paymentReceivingDetails.acceptedMethods&&(0,o.jsxs)(i.Ss,{style:[l.row,{marginTop:10,marginBottom:20}],children:[(0,o.jsx)(i.EY,{style:l.label,children:"All Methods:"}),(0,o.jsx)(i.EY,{style:l.value,children:d.getBillIssuerDetails.paymentReceivingDetails.acceptedMethods.filter(e=>"BANK_TRANSFER"===e||("STRIPE"===e?!1!==a.acceptCardPayment:"CRYPTO"!==e||!0===a.acceptCryptoPayment)).map(e=>{switch(e){case"BANK_TRANSFER":return"Bank Transfer";case"STRIPE":return"Credit Card";case"CRYPTO":return"Bitcoin";case"PAYPAL":return"PayPal";default:return e}}).join(", ")})]})]}),(0,o.jsx)(i.Ss,{style:l.footer,children:(0,o.jsxs)(i.EY,{style:{fontSize:10,color:"#666"},children:["Thank you for your business! \u2022 Generated on ",(new Date).toLocaleDateString()]})})]})});var p}},33715:(e,n,t)=>{"use strict";t.d(n,{l:()=>W});var i,s,o=t(57528),l=t(65043),r=t(33171),a=t(62468),c=t(68655),d=t(23913),m=t(59218),u=t(88787),h=t(85871),p=t(87139),x=t(22107),g=t(98662),b=t(34946),j=t(82459),y=t(35699),f=t(45973),v=t(29244),C=t(76659),S=t(96148),E=t(10202),k=t(48239),P=t(30502),I=t(39081),A=t(58861),D=t(12733),w=t(10585),B=t(70459),T=t(39985),z=t(70579);const N=(0,B.J1)(i||(i=(0,o.A)(["\n  query SearchClients($search: String, $tags: [String!]) {\n    searchClients(search: $search, tags: $tags) {\n      id\n      fName\n      lName\n      email\n      phoneNumber\n      tags\n    }\n  }\n"]))),R=(0,B.J1)(s||(s=(0,o.A)(["\n  query GetAllClientTags {\n    allClientTags\n  }\n"]))),W=e=>{var n;let{selectedClients:t,onSelectionChange:i,allowMultiple:s=!0,placeholder:o="Search clients by name, email, or phone..."}=e;const[B,W]=(0,l.useState)(""),[F,K]=(0,l.useState)([]),[$,U]=(0,l.useState)([0,1]),{data:Y}=((0,P.d)(),(0,w.IT)(R)),{loading:O,data:L,error:_}=(0,w.IT)(N,{variables:{search:B||void 0,tags:F.length>0?F:void 0},skip:!B&&0===F.length}),M=(0,T.oU)("text.secondary"),G=(0,T.oU)("text.muted"),q=(0,T.oU)("border.light"),Q=e=>{s?t.includes(e)?i(t.filter(n=>n!==e)):i([...t,e]):i([e])},H=()=>{i([])},J=t.length,Z=(null===L||void 0===L||null===(n=L.searchClients)||void 0===n?void 0:n.length)||0;return(0,z.jsxs)(E.T,{spacing:4,align:"stretch",children:[(0,z.jsxs)(r.n,{allowMultiple:!0,index:$,onChange:e=>U(e),children:[(0,z.jsxs)(d.A,{border:"none",children:[(0,z.jsxs)(a.J,{px:0,children:[(0,z.jsx)(x.a,{flex:"1",textAlign:"left",children:(0,z.jsx)(I.E,{fontWeight:"medium",children:"Search Clients"})}),(0,z.jsx)(c.Q,{})]}),(0,z.jsx)(m.v,{px:0,children:(0,z.jsxs)(E.T,{spacing:3,align:"stretch",children:[(0,z.jsxs)(f.M,{children:[(0,z.jsx)(v.W,{pointerEvents:"none",children:(0,z.jsx)(D.W,{color:G})}),(0,z.jsx)(y.p,{placeholder:o,value:B,onChange:e=>W(e.target.value),bg:(0,T.QQ)("form","fieldBg"),border:"1px",borderColor:(0,T.QQ)("form","fieldBorder"),_focus:{borderColor:(0,T.QQ)("form","fieldBorderFocus"),boxShadow:(0,T.QQ)("form","fieldShadowFocus")}})]}),O&&(0,z.jsxs)(S.z,{justify:"center",py:4,children:[(0,z.jsx)(C.y,{size:"sm"}),(0,z.jsx)(I.E,{fontSize:"sm",color:M,children:"Searching..."})]}),_&&(0,z.jsxs)(u.F,{status:"error",borderRadius:"md",children:[(0,z.jsx)(h._,{}),"Error searching clients: ",_.message]}),(null===L||void 0===L?void 0:L.searchClients)&&L.searchClients.length>0&&(0,z.jsxs)(x.a,{children:[(0,z.jsxs)(S.z,{justify:"space-between",mb:2,children:[(0,z.jsxs)(I.E,{fontSize:"sm",color:M,children:["Found ",Z," client",1!==Z?"s":""]}),s&&(0,z.jsxs)(S.z,{spacing:2,children:[(0,z.jsx)(g.$,{size:"xs",variant:"link",onClick:()=>{if(null!==L&&void 0!==L&&L.searchClients){const e=L.searchClients.map(e=>e.id);i(e)}},children:"Select All"}),J>0&&(0,z.jsx)(g.$,{size:"xs",variant:"link",onClick:H,children:"Clear"})]})]}),(0,z.jsx)(E.T,{align:"stretch",spacing:1,maxH:"200px",overflowY:"auto",border:"1px",borderColor:q,borderRadius:"md",p:2,children:L.searchClients.map(e=>(0,z.jsx)(x.a,{p:2,borderRadius:"md",_hover:{bg:(0,T.oU)("background.overlay")},children:(0,z.jsxs)(S.z,{justify:"space-between",children:[(0,z.jsxs)(S.z,{spacing:3,flex:1,cursor:"pointer",onClick:()=>Q(e.id),children:[(0,z.jsx)(x.a,{onClick:e=>e.stopPropagation(),children:(0,z.jsx)(b.S,{isChecked:t.includes(e.id),onChange:()=>Q(e.id)})}),(0,z.jsxs)(E.T,{align:"start",spacing:0,children:[(0,z.jsxs)(I.E,{fontSize:"sm",fontWeight:"medium",children:[e.fName," ",e.lName]}),(0,z.jsx)(I.E,{fontSize:"xs",color:G,children:e.email||e.phoneNumber||"No contact info"})]})]}),e.tags&&e.tags.length>0&&(0,z.jsxs)(A.B,{spacing:1,children:[e.tags.slice(0,2).map(e=>(0,z.jsx)(A.Q,{children:(0,z.jsx)(k.vw,{size:"sm",variant:"subtle",colorScheme:"blue",children:(0,z.jsx)(k.d1,{children:e})})},e)),e.tags.length>2&&(0,z.jsx)(A.Q,{children:(0,z.jsxs)(p.E,{fontSize:"xs",colorScheme:"gray",children:["+",e.tags.length-2]})})]})]})},e.id))})]}),(null===L||void 0===L?void 0:L.searchClients)&&0===L.searchClients.length&&(0,z.jsx)(I.E,{fontSize:"sm",color:G,textAlign:"center",py:4,children:"No clients found matching your search"})]})})]}),(0,z.jsxs)(d.A,{border:"none",children:[(0,z.jsxs)(a.J,{px:0,children:[(0,z.jsx)(x.a,{flex:"1",textAlign:"left",children:(0,z.jsxs)(S.z,{children:[(0,z.jsx)(I.E,{fontWeight:"medium",children:"Filter by Tags"}),F.length>0&&(0,z.jsxs)(p.E,{colorScheme:"blue",fontSize:"xs",children:[F.length," selected"]})]})}),(0,z.jsx)(c.Q,{})]}),(0,z.jsx)(m.v,{px:0,children:null!==Y&&void 0!==Y&&Y.allClientTags&&Y.allClientTags.length>0?(0,z.jsxs)(E.T,{align:"stretch",spacing:3,children:[(0,z.jsx)(I.E,{fontSize:"sm",color:M,children:"Select tags to filter clients:"}),(0,z.jsx)(A.B,{spacing:2,children:Y.allClientTags.map(e=>(0,z.jsx)(A.Q,{children:(0,z.jsx)(k.vw,{size:"md",variant:F.includes(e)?"solid":"outline",colorScheme:F.includes(e)?"blue":"gray",cursor:"pointer",onClick:()=>(e=>{K(n=>n.includes(e)?n.filter(n=>n!==e):[...n,e])})(e),_hover:{transform:"scale(1.05)"},children:(0,z.jsx)(k.d1,{children:e})})},e))}),F.length>0&&(0,z.jsx)(g.$,{size:"sm",variant:"ghost",onClick:()=>K([]),children:"Clear Tag Filters"})]}):(0,z.jsx)(I.E,{fontSize:"sm",color:G,textAlign:"center",py:4,children:"No tags available"})})]})]}),J>0&&(0,z.jsxs)(x.a,{children:[(0,z.jsx)(j.c,{my:2}),(0,z.jsxs)(S.z,{justify:"space-between",children:[(0,z.jsxs)(I.E,{fontSize:"sm",color:M,children:[J," client",1!==J?"s":""," selected"]}),(0,z.jsx)(g.$,{size:"xs",variant:"ghost",onClick:H,colorScheme:"red",children:"Clear Selection"})]})]})]})}},39324:(e,n,t)=>{"use strict";t.d(n,{Sd:()=>i,g_:()=>o,l2:()=>s});const i='# Unified Markdown Format Specification\n\n**Version:** 1.0\n**Last Updated:** January 2025\n\nThis document defines the unified markdown format for importing/exporting projects, bills, and proposals.\n\n---\n\n## \ud83d\udcdd Format Overview\n\nThe unified format combines:\n- Project metadata (name, goal, description)\n- Bill metadata (currency, payment method, status)\n- Line items / Tasks (description, price, status, assignee)\n- Agreement text (optional)\n\nThis allows editing proposals in Claude and importing them into the system.\n\n---\n\n## \ud83d\udccb Complete Example\n\n```markdown\n# One Group Website Development Proposal\n\n## Project Information\n**Project Name:** One Group Website Development\n**Project Goal:** Build unified digital platform for Solar, Finance & Property Investment\n**Project Description:** Complete 80-page unified platform representing all three One Group verticals with custom calculators, CRM integration, and SEO optimization.\n\n## Bill Information\n**Currency:** AUD\n**Payment Method:** AUD_TRANSFER\n**Status:** PROPOSAL\n\n## Line Items\n\n### 1. Content Page: onegroupaustralasia.com.au/\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n\n### 2. Content Page: onegroupaustralasia.com.au/about\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n### 3. Custom Logic: onegroupaustralasia.com.au/solar/calculator\n**Price:** $300.00\n**Billable:** Yes\n**Status:** IN_PROGRESS\n**Assignee:** jane@tommillerservices.com\n\n### 4. Project management and coordination\n**Price:** $0.00\n**Billable:** No\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n\n### 5. Internal testing and QA\n**Price:** [ENTER PRICE]\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n## Agreement\n\n[Full agreement text goes here...]\n\n**Between:** Tom Miller Services Pty Ltd ("TMS")\n**And:** One Group ("Client")\n\n[Rest of agreement...]\n```\n\n---\n\n## \ud83d\udd0d Field Specifications\n\n### Project Information Section\n\n| Field | Required | Format | Example |\n|-------|----------|--------|---------|\n| Project Name | Yes | Plain text | `One Group Website Development` |\n| Project Goal | No | Max 17 words | `Build unified digital platform for Solar, Finance & Property` |\n| Project Description | No | Max 200 words | `Complete 80-page unified platform...` |\n\n**Notes:**\n- Project Goal is used for taglines (keep concise)\n- Project Description provides context for the work\n\n---\n\n### Bill Information Section\n\n| Field | Required | Format | Options |\n|-------|----------|--------|---------|\n| Currency | Yes | Uppercase code | `AUD`, `USD` |\n| Payment Method | No | Enum value | `AUD_TRANSFER`, `CARD`, `CRYPTO` |\n| Status | No | Enum value | `PROPOSAL`, `DRAFT`, `SENT` |\n\n**Notes:**\n- Currency affects how prices are parsed\n- If Payment Method is omitted, defaults to `AUD_TRANSFER`\n- If Status is omitted, defaults to `PROPOSAL`\n\n---\n\n### Line Items Section\n\nEach line item uses this format:\n\n```markdown\n### [Number]. [Description]\n**Price:** [Amount]\n**Billable:** [Yes/No]\n**Status:** [Status]\n**Assignee:** [Email or "Unassigned"]\n```\n\n#### Field Details:\n\n| Field | Required | Format | Options/Rules |\n|-------|----------|--------|---------------|\n| Number | No | Integer | Sequential numbering (1, 2, 3...) |\n| Description | Yes | Plain text | Task/line item description |\n| Price | Yes | Number with currency symbol | `$100.00`, `[ENTER PRICE]` (placeholder) |\n| Billable | No | Yes/No | Defaults to `Yes` if omitted |\n| Status | No | Enum | `PENDING`, `IN_PROGRESS`, `COMPLETED` (defaults to `PENDING`) |\n| Assignee | No | Email or "Unassigned" | Must be valid email or literal "Unassigned" |\n\n**Price Format Rules:**\n- With symbol: `$100.00`, `$100`, `$99.50`\n- Without symbol: `100.00`, `100`, `99.50`\n- Placeholder: `[ENTER PRICE]` \u2190 **Fails import** (must add price before importing)\n- Zero price: `$0.00` \u2190 Creates non-billable line item\n\n**Assignee Rules:**\n- Valid email: `tom@tommillerservices.com` \u2190 Looks up user and assigns\n- Invalid email: Creates unassigned task and shows warning\n- "Unassigned": Creates unassigned task\n- Omitted: Creates unassigned task\n\n---\n\n## \ud83d\udd04 Import/Export Behavior\n\n### Export (Project \u2192 Markdown)\n\nWhen exporting a project to markdown:\n1. **Project Info:** Populated from project.projectName, projectGoal, projectDescription\n2. **Bill Info:** Uses default values (Currency from tenant, Status = PROPOSAL)\n3. **Line Items:**\n   - Description from task.description\n   - Price = `[ENTER PRICE]` for billable tasks, `$0.00` for non-billable\n   - Billable from task.billable (defaults to Yes)\n   - Status from task.status\n   - Assignee from task.assignedTo.email (or "Unassigned")\n4. **Agreement:** Not included in export (add manually if needed)\n\n### Import (Markdown \u2192 Bill)\n\nWhen importing markdown to a bill:\n1. **Project Info:** Ignored (bill already linked to project)\n2. **Bill Info:** Updates bill.currency if specified\n3. **Line Items:**\n   - **Replaces all existing line items** (with confirmation modal)\n   - Creates new line items from each `### [Number]. [Description]` section\n   - Parses price and converts to cents for Stripe\n   - Sets billable flag based on price ($0 = non-billable)\n   - Assignee is stored but not enforced (bills don\'t have task assignments)\n4. **Agreement:** Ignored during bill import\n\n---\n\n## \u2705 Validation Rules\n\n### During Export\n- [ ] At least 1 task exists in project\n- [ ] Task descriptions are not empty\n- [ ] All billable tasks marked with price placeholder\n\n### During Import to Bill\n- [ ] Valid markdown structure\n- [ ] At least 1 line item found\n- [ ] All line items have valid prices (no `[ENTER PRICE]` placeholders)\n- [ ] All prices are positive numbers or zero\n- [ ] Currency code is valid (AUD or USD)\n- [ ] Status enum is valid (if provided)\n\n---\n\n## \ud83d\udeab Common Parse Errors\n\n| Error | Cause | Solution |\n|-------|-------|----------|\n| "No line items found" | Missing `## Line Items` section | Add section header |\n| "Invalid price format" | Price has `[ENTER PRICE]` | Replace with actual dollar amount |\n| "Currency not supported" | Invalid currency code | Use `AUD` or `USD` |\n| "Line item missing description" | Empty description after number | Add description text |\n| "Negative price not allowed" | Price is negative | Use positive number or $0.00 |\n\n---\n\n## \ud83c\udfa8 Formatting Tips for Claude Editing\n\n### Adding New Line Items\n```markdown\n### 81. New feature: User authentication module\n**Price:** $500.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n```\n\n### Bulk Price Adjustments\nAsk Claude: "Increase all Content Page items by 20%"\nClaude will update:\n- `**Price:** $100.00` \u2192 `**Price:** $120.00`\n\n### Reassigning Tasks\nAsk Claude: "Assign all calculator tasks to jane@tommillerservices.com"\nClaude will update:\n- `**Assignee:** Unassigned` \u2192 `**Assignee:** jane@tommillerservices.com`\n\n### Marking Tasks Complete\nAsk Claude: "Mark tasks 1-10 as completed"\nClaude will update:\n- `**Status:** PENDING` \u2192 `**Status:** COMPLETED`\n\n---\n\n**Version History:**\n- v1.0 (Jan 2025) - Initial specification\n',s="# Bill Line Items Template\n\n## Project Information\n**Project Name:** [Enter project name]\n**Project Goal:** [Enter project goal - max 17 words]\n**Project Description:** [Enter project description - max 200 words]\n\n## Bill Information\n**Currency:** AUD\n**Payment Method:** AUD_TRANSFER\n**Status:** PROPOSAL\n\n## Line Items\n\n### 1. [Task description]\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** email@example.com\n\n### 2. [Another task description]\n**Price:** $200.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n### 3. [Add more line items as needed]\n**Price:** $150.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n## Agreement\n\n[Add your agreement text here, or leave this section empty]\n",o=(e,n)=>{const t=new Blob([e],{type:"text/markdown"}),i=URL.createObjectURL(t),s=document.createElement("a");s.href=i,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}},50477:()=>{}}]);
//# sourceMappingURL=9893.6bf58a3a.chunk.js.map