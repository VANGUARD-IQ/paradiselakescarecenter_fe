"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[1934],{31934:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Yt});var o,i,r,a,l,s,d=n(89379),c=n(57528),g=n(65043),u=n(44093),h=n(30502),p=n(22107),m=n(98939),x=n(10202),v=n(76659),b=n(39081),f=n(88787),S=n(85871),j=n(83169),C=n(24330),E=n(96148),I=n(27285),y=n(3805),w=n(7807),T=n(34625),k=n(73216),z=n(35475),D=n(70459),A=n(10585),R=n(31881),M=n(52003),G=n(63295),O=n(95214),N=n(60319),P=n(39985),W=n(95494),F=n(78460),$=n(11054),_=n(25722),V=n(15071),H=n(25011),L=n(87139),U=n(35929),B=n(67516),J=n(73225),q=n(76668),Y=n(35699),K=n(61724),Z=n(19077),X=n(73212),Q=n(98662),ee=n(42703),te=n(3109),ne=n(31411),oe=n(14566),ie=n(51794),re=n(10227),ae=n(88019),le=n(33171),se=n(23913),de=n(62468),ce=n(68655),ge=n(59218),ue=n(34946),he=n(56529),pe=n(98971),me=n(12730),xe=n(58584),ve=n(99973),be=n(63856),fe=n(1009),Se=n(70579);const je=(0,D.J1)(o||(o=(0,c.A)(["\n  query GetCalendarGoals($calendarId: String!, $period: String) {\n    calendarGoals(calendarId: $calendarId, period: $period) {\n      id\n      title\n      description\n      category\n      period\n      status\n      startDate\n      endDate\n      progressPercentage\n      currentValue\n      targetValue\n      currentNumericValue\n      targetNumericValue\n      checkpoints {\n        id\n        title\n        description\n        completed\n        completedAt\n        dueDate\n        order\n        weight\n        notes\n      }\n      color\n      icon\n      displayOrder\n      kpiMetric\n      kpiUnit\n      notes\n      tags\n      parentGoalId\n      assignedTo\n    }\n  }\n"]))),Ce=(0,D.J1)(i||(i=(0,c.A)(["\n  mutation CreateCalendarGoal($input: CalendarGoalInput!) {\n    createCalendarGoal(input: $input) {\n      id\n      title\n      progressPercentage\n    }\n  }\n"]))),Ee=(0,D.J1)(r||(r=(0,c.A)(["\n  mutation UpdateCalendarGoal($id: String!, $input: CalendarGoalInput!) {\n    updateCalendarGoal(id: $id, input: $input) {\n      id\n      title\n      progressPercentage\n    }\n  }\n"]))),Ie=(0,D.J1)(a||(a=(0,c.A)(["\n  mutation DeleteCalendarGoal($id: String!) {\n    deleteCalendarGoal(id: $id)\n  }\n"]))),ye=(0,D.J1)(l||(l=(0,c.A)(["\n  query GetClients {\n    clients {\n      id\n      fName\n      lName\n      email\n      businessName\n    }\n  }\n"]))),we=(0,D.J1)(s||(s=(0,c.A)(["\n  mutation UpdateGoalCheckpoint($input: UpdateGoalCheckpointInput!) {\n    updateGoalCheckpoint(input: $input) {\n      id\n      progressPercentage\n      checkpoints {\n        id\n        completed\n      }\n    }\n  }\n"]))),Te={MARKETING:fe.ARf,GROWTH:fe.x_j,OPERATIONS:fe.VSk,TEAM:fe.cfS,FINANCE:fe.z8N,PRODUCT:fe.est,CUSTOMER:fe.JXP,OTHER:fe.Qz2},ke={MARKETING:"#9333EA",GROWTH:"#10B981",OPERATIONS:"#F59E0B",TEAM:"#3B82F6",FINANCE:"#EF4444",PRODUCT:"#8B5CF6",CUSTOMER:"#EC4899",OTHER:"#6B7280"},ze=e=>{var t;let{isOpen:n,onClose:o,calendarId:i,currentMonth:r,initialGoalId:a}=e;const{colorMode:l}=(0,u.G6)(),s=(0,h.d)(),[c,m]=(0,g.useState)([]),[v,f]=(0,g.useState)(null),[S,j]=(0,g.useState)(!1),[C,I]=(0,g.useState)(0),y=((0,P.oU)("background.main",l),(0,P.oU)("light"===l?"background.card":"background.darkSurface",l)),w=(0,P.oU)("light"===l?"background.light":"background.taskCard",l),T=(0,P.oU)("light"===l?"text.primary":"text.primaryDark",l),k=(0,P.oU)("light"===l?"text.secondary":"text.secondaryDark",l),z=(0,P.oU)("light"===l?"text.muted":"text.mutedDark",l),D=(0,P.oU)("border.darkCard",l),{loading:M,data:G,refetch:O}=(0,A.IT)(je,{variables:{calendarId:i,period:"MONTHLY"},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),{data:N}=(0,A.IT)(ye,{context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}});(0,g.useEffect)(()=>{if(null!==G&&void 0!==G&&G.calendarGoals){const e=G.calendarGoals.map(e=>(0,d.A)((0,d.A)({},e),{},{checkpoints:e.checkpoints?e.checkpoints.map(e=>(0,d.A)({},e)):[]}));m(e)}},[G]),(0,g.useEffect)(()=>{if(a&&c.length>0){const e=c.find(e=>e.id===a);e&&(f(e),I(1))}},[a,c]);const[W]=(0,R.n)(Ce,{onCompleted:()=>{s({title:"Goal created",status:"success",duration:3e3}),O(),j(!1),f(null)},onError:e=>{s({title:"Error creating goal",description:e.message,status:"error",duration:5e3})}}),[fe]=(0,R.n)(Ee,{onCompleted:()=>{s({title:"Goal updated",status:"success",duration:3e3}),O(),f(null)}}),[ze]=(0,R.n)(Ie,{onCompleted:()=>{s({title:"Goal deleted",status:"success",duration:3e3}),O()}}),[De]=(0,R.n)(we,{onCompleted:()=>{O()}}),Ae=c.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{}),Re=(()=>{let e=0,t=0;c.forEach(n=>{e+=n.checkpoints.length,t+=n.checkpoints.filter(e=>e.completed).length});const n=e>0?Math.round(t/e*100):0;return{totalGoals:c.length,totalCheckpoints:e,completedCheckpoints:t,overallProgress:n}})();return(0,Se.jsxs)(F.aF,{isOpen:n,onClose:o,size:{base:"full",md:"4xl",lg:"6xl"},children:[(0,Se.jsx)($.m,{}),(0,Se.jsxs)(_.$,{maxH:{base:"100vh",md:"90vh"},m:{base:0,md:4},bg:y,color:T,children:[(0,Se.jsx)(V.r,{children:(0,Se.jsxs)(x.T,{align:"stretch",spacing:2,children:[(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(H.I,{as:pe.C}),(0,Se.jsxs)(b.E,{fontSize:{base:"lg",md:"xl"},children:["".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()]," ").concat(r.getFullYear())," Goals"]})]}),(0,Se.jsxs)(E.z,{flexWrap:"wrap",spacing:2,children:[(0,Se.jsxs)(L.E,{colorScheme:"blue",fontSize:{base:"xs",md:"md"},p:{base:1,md:2},children:[Re.completedCheckpoints," / ",Re.totalCheckpoints," tasks"]}),(0,Se.jsxs)(L.E,{colorScheme:"green",fontSize:{base:"xs",md:"md"},p:{base:1,md:2},children:["Overall: ",Re.overallProgress,"%"]})]})]})}),(0,Se.jsx)(U.s,{}),(0,Se.jsx)(B.c,{overflowY:"auto",children:M?(0,Se.jsx)(b.E,{color:T,children:"Loading goals..."}):(0,Se.jsxs)(x.T,{spacing:4,align:"stretch",children:[(S||v)&&(0,Se.jsx)(p.a,{p:4,borderWidth:1,borderRadius:"md",bg:w,borderColor:D,children:(0,Se.jsxs)(x.T,{spacing:3,children:[(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Goal Title"}),(0,Se.jsx)(Y.p,{value:(null===v||void 0===v?void 0:v.title)||"",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{title:e.target.value}):null),placeholder:"Enter goal title",bg:y,color:T,borderColor:D,_placeholder:{color:z}})]}),(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Assigned To (Optional)"}),(0,Se.jsxs)(K.l,{value:(null===v||void 0===v?void 0:v.assignedTo)||"",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{assignedTo:e.target.value||null}):null),placeholder:"Select a client to assign this goal to",bg:y,color:T,borderColor:D,children:[(0,Se.jsx)("option",{value:"",children:"Not assigned"}),null===N||void 0===N||null===(t=N.clients)||void 0===t?void 0:t.map(e=>(0,Se.jsxs)("option",{value:e.id,children:[e.fName," ",e.lName,e.businessName&&" (".concat(e.businessName,")")]},e.id))]})]}),(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Depends On (Optional)"}),(0,Se.jsxs)(K.l,{value:(null===v||void 0===v?void 0:v.parentGoalId)||"",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{parentGoalId:e.target.value||null}):null),placeholder:"Select a goal this depends on",bg:y,color:T,borderColor:D,children:[(0,Se.jsx)("option",{value:"",children:"No dependency"}),null===c||void 0===c?void 0:c.filter(e=>e.id!==(null===v||void 0===v?void 0:v.id)).map(e=>(0,Se.jsxs)("option",{value:e.id,children:[e.title," (",e.progressPercentage,"% complete)"]},e.id))]}),(0,Se.jsx)(b.E,{fontSize:"xs",color:z,mt:1,children:"This goal will be marked as blocked until the selected goal is 100% complete"})]}),(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Description"}),(0,Se.jsx)(Z.T,{value:(null===v||void 0===v?void 0:v.description)||"",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{description:e.target.value}):null),placeholder:"Enter goal description",bg:y,color:T,borderColor:D,_placeholder:{color:z}})]}),(0,Se.jsxs)(X.r,{columns:{base:1,md:2},spacing:3,w:"full",children:[(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Category"}),(0,Se.jsxs)(K.l,{value:(null===v||void 0===v?void 0:v.category)||"OTHER",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{category:e.target.value,color:ke[e.target.value]}):null),bg:y,color:T,borderColor:D,children:[(0,Se.jsx)("option",{value:"MARKETING",children:"Marketing"}),(0,Se.jsx)("option",{value:"GROWTH",children:"Growth"}),(0,Se.jsx)("option",{value:"OPERATIONS",children:"Operations"}),(0,Se.jsx)("option",{value:"TEAM",children:"Team"}),(0,Se.jsx)("option",{value:"FINANCE",children:"Finance"}),(0,Se.jsx)("option",{value:"PRODUCT",children:"Product"}),(0,Se.jsx)("option",{value:"CUSTOMER",children:"Customer"}),(0,Se.jsx)("option",{value:"OTHER",children:"Other"})]})]}),(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Status"}),(0,Se.jsxs)(K.l,{value:(null===v||void 0===v?void 0:v.status)||"NOT_STARTED",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{status:e.target.value}):null),bg:y,color:T,borderColor:D,children:[(0,Se.jsx)("option",{value:"NOT_STARTED",children:"Not Started"}),(0,Se.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,Se.jsx)("option",{value:"AT_RISK",children:"At Risk"}),(0,Se.jsx)("option",{value:"COMPLETED",children:"Completed"}),(0,Se.jsx)("option",{value:"ON_HOLD",children:"On Hold"})]})]})]}),(0,Se.jsxs)(X.r,{columns:{base:1,md:2},spacing:3,w:"full",children:[(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Current Value"}),(0,Se.jsx)(Y.p,{value:(null===v||void 0===v?void 0:v.currentValue)||"",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{currentValue:e.target.value}):null),placeholder:"e.g., 18 Clients",bg:y,color:T,borderColor:D,_placeholder:{color:z}})]}),(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{color:T,children:"Target Value"}),(0,Se.jsx)(Y.p,{value:(null===v||void 0===v?void 0:v.targetValue)||"",onChange:e=>f(t=>t?(0,d.A)((0,d.A)({},t),{},{targetValue:e.target.value}):null),placeholder:"e.g., 25 New Clients",bg:y,color:T,borderColor:D,_placeholder:{color:z}})]})]}),(0,Se.jsxs)(p.a,{w:"full",children:[(0,Se.jsxs)(E.z,{justify:"space-between",mb:2,children:[(0,Se.jsx)(b.E,{fontWeight:"bold",color:T,children:"Checkpoints / Tasks"}),(0,Se.jsx)(Q.$,{size:"sm",leftIcon:(0,Se.jsx)(me.R,{}),onClick:()=>{if(!v)return;const e={id:"checkpoint-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),title:"",description:"",completed:!1,order:v.checkpoints.length,weight:1};f((0,d.A)((0,d.A)({},v),{},{checkpoints:[...v.checkpoints,e]}))},children:"Add Task"})]}),(0,Se.jsx)(x.T,{spacing:2,align:"stretch",children:null===v||void 0===v?void 0:v.checkpoints.map((e,t)=>(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsx)(Y.p,{value:e.title,onChange:e=>{if(!v)return;const n=v.checkpoints.map((n,o)=>o===t?(0,d.A)((0,d.A)({},n),{},{title:e.target.value}):(0,d.A)({},n));f((0,d.A)((0,d.A)({},v),{},{checkpoints:n}))},placeholder:"Task title",bg:y,color:T,borderColor:D,_placeholder:{color:z}}),(0,Se.jsx)(ee.K,{"aria-label":"Remove task",icon:(0,Se.jsx)(xe.d,{}),size:"sm",colorScheme:"red",onClick:()=>{if(!v)return;const e=v.checkpoints.filter((e,n)=>n!==t);f((0,d.A)((0,d.A)({},v),{},{checkpoints:e}))}})]},t))})]}),(0,Se.jsxs)(E.z,{w:"full",justify:"flex-end",children:[(0,Se.jsx)(Q.$,{variant:"ghost",onClick:()=>{f(null),j(!1)},children:"Cancel"}),(0,Se.jsxs)(Q.$,{colorScheme:"blue",onClick:()=>{if(!v)return;const e=new Date(r.getFullYear(),r.getMonth(),1),t=new Date(r.getFullYear(),r.getMonth()+1,0),n=v.checkpoints.map(e=>({id:e.id,title:e.title,description:e.description||"",completed:e.completed||!1,completedAt:e.completedAt||null,dueDate:e.dueDate||null,order:e.order||0,weight:e.weight||1,notes:e.notes||null})),o={calendarId:i,title:v.title,description:v.description,category:v.category,period:"MONTHLY",status:v.status||"NOT_STARTED",startDate:e.toISOString(),endDate:t.toISOString(),currentValue:v.currentValue,targetValue:v.targetValue,progressPercentage:v.progressPercentage,checkpoints:n,parentGoalId:v.parentGoalId||null,assignedTo:v.assignedTo||null,color:v.color||ke[v.category],icon:v.icon,displayOrder:v.displayOrder};v.id?fe({variables:{id:v.id,input:o},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}):W({variables:{input:o},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}})},children:[null!==v&&void 0!==v&&v.id?"Update":"Create"," Goal"]})]})]})}),(0,Se.jsxs)(te.t,{children:[(0,Se.jsxs)(ne.w,{children:[(0,Se.jsx)(oe.o,{children:"All Goals"}),Object.keys(Ae).map(e=>(0,Se.jsx)(oe.o,{children:(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(H.I,{as:Te[e]}),(0,Se.jsx)(b.E,{children:e.charAt(0)+e.slice(1).toLowerCase()})]})},e))]}),(0,Se.jsxs)(ie.T,{children:[(0,Se.jsx)(re.K,{children:(0,Se.jsx)(x.T,{spacing:4,align:"stretch",children:c.map(e=>(0,Se.jsxs)(p.a,{p:4,borderWidth:1,borderRadius:"md",borderLeftWidth:4,borderLeftColor:e.color||ke[e.category],children:[(0,Se.jsxs)(E.z,{justify:"space-between",mb:2,children:[(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(H.I,{as:Te[e.category],color:e.color}),(0,Se.jsx)(b.E,{fontWeight:"bold",fontSize:"lg",color:T,children:e.title})]}),(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(ee.K,{"aria-label":"Edit goal",icon:(0,Se.jsx)(ve.q,{}),size:"sm",onClick:()=>f((0,d.A)((0,d.A)({},e),{},{checkpoints:e.checkpoints.map(e=>(0,d.A)({},e))}))}),(0,Se.jsx)(ee.K,{"aria-label":"Delete goal",icon:(0,Se.jsx)(xe.d,{}),size:"sm",colorScheme:"red",onClick:()=>{return e.id&&(t=e.id,void(window.confirm("Are you sure you want to delete this goal?")&&ze({variables:{id:t},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}})));var t}})]})]}),e.description&&(0,Se.jsx)(b.E,{color:k,mb:2,children:e.description}),(0,Se.jsxs)(E.z,{spacing:4,mb:2,children:[(0,Se.jsxs)(b.E,{fontSize:"sm",color:T,children:[(0,Se.jsx)("strong",{children:"Current:"})," ",e.currentValue]}),(0,Se.jsx)(H.I,{as:be.v,color:z}),(0,Se.jsxs)(b.E,{fontSize:"sm",color:T,children:[(0,Se.jsx)("strong",{children:"Target:"})," ",e.targetValue]})]}),(0,Se.jsx)(ae.k,{value:e.progressPercentage,size:"sm",colorScheme:e.progressPercentage>=75?"green":e.progressPercentage>=50?"yellow":"red",mb:2}),(0,Se.jsxs)(b.E,{fontSize:"sm",color:k,mb:2,children:["Progress: ",e.progressPercentage,"%"]}),e.checkpoints.length>0&&(0,Se.jsx)(le.n,{allowToggle:!0,children:(0,Se.jsxs)(se.A,{border:"none",children:[(0,Se.jsxs)(de.J,{px:0,children:[(0,Se.jsx)(p.a,{flex:"1",textAlign:"left",children:(0,Se.jsxs)(b.E,{fontSize:"sm",color:T,children:[e.checkpoints.filter(e=>e.completed).length," of ",e.checkpoints.length," tasks completed"]})}),(0,Se.jsx)(ce.Q,{})]}),(0,Se.jsx)(ge.v,{px:0,children:(0,Se.jsx)(x.T,{align:"stretch",spacing:1,children:e.checkpoints.map(t=>(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsx)(ue.S,{isChecked:t.completed,onChange:n=>{return e.id&&t.id&&(o=e.id,i=t.id,r=n.target.checked,void De({variables:{input:{goalId:o,checkpointId:i,completed:r}},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}));var o,i,r}}),(0,Se.jsx)(b.E,{fontSize:"sm",textDecoration:t.completed?"line-through":"none",color:t.completed?z:T,children:t.title})]},t.id))})})]})})]},e.id))})}),Object.entries(Ae).map(e=>{let[t,n]=e;return(0,Se.jsx)(re.K,{children:(0,Se.jsx)(x.T,{spacing:4,align:"stretch",children:n.map(e=>(0,Se.jsxs)(p.a,{p:4,borderWidth:1,borderRadius:"md",borderLeftWidth:4,borderLeftColor:e.color||ke[t],children:[(0,Se.jsx)(b.E,{fontWeight:"bold",color:T,children:e.title}),(0,Se.jsx)(ae.k,{value:e.progressPercentage,size:"sm",mt:2})]},e.id))})},t)})]})]})]})}),(0,Se.jsxs)(he.j,{children:[(0,Se.jsx)(Q.$,{mr:3,onClick:o,children:"Close"}),(0,Se.jsx)(Q.$,{colorScheme:"blue",leftIcon:(0,Se.jsx)(me.R,{}),onClick:()=>{f({title:"",description:"",category:"OTHER",status:"NOT_STARTED",currentValue:"",targetValue:"",progressPercentage:0,checkpoints:[],color:ke.OTHER,icon:"",displayOrder:c.length}),j(!0)},children:"Add New Goal"})]})]})]})};var De,Ae,Re,Me,Ge,Oe=n(91751),Ne=n(47726),Pe=n(82459),We=n(7189),Fe=n(85369),$e=n(80454),_e=n(94877);const Ve=(0,D.J1)(De||(De=(0,c.A)(["\n  mutation SendRSVPResponse($eventId: String!, $response: String!, $fromEmail: String) {\n    sendRSVPResponse(eventId: $eventId, response: $response, fromEmail: $fromEmail) {\n      success\n      message\n      event {\n        id\n        iCalResponseStatus\n      }\n    }\n  }\n"]))),He=(0,D.J1)(Ae||(Ae=(0,c.A)(["\n  query GetEmailSenders {\n    emailSenders\n  }\n"]))),Le=((0,D.J1)(Re||(Re=(0,c.A)(["\n  query GetUserEmailAccounts {\n    userEmailAccounts {\n      id\n      email\n      provider\n      isDefault\n      isActive\n    }\n  }\n"]))),(0,D.J1)(Me||(Me=(0,c.A)(["\n  mutation CancelEvent($id: String!, $reason: String) {\n    cancelEvent(id: $id, reason: $reason)\n  }\n"])))),Ue=(0,D.J1)(Ge||(Ge=(0,c.A)(["\n  mutation UpdateEvent($id: String!, $input: CalendarEventInput!) {\n    updateEvent(id: $id, input: $input) {\n      id\n      categories\n    }\n  }\n"]))),Be=e=>{let{isOpen:t,onClose:n,event:o,onRefresh:i}=e;const{colorMode:r}=(0,u.G6)(),a=(0,P.oU)("light"===r?"background.card":"background.darkSurface",r),l=(0,P.oU)("light"===r?"background.light":"background.taskCard",r),s=((0,P.oU)("light"===r?"text.primary":"text.primaryDark",r),(0,P.oU)("light"===r?"text.secondary":"text.secondaryDark",r)),d=(0,P.oU)("light"===r?"text.muted":"text.mutedDark",r),c=((0,P.oU)("border.darkCard",r),(0,h.d)()),[m,v]=(0,g.useState)(!1),[f,S]=(0,g.useState)(!1),[j,C]=(0,g.useState)(""),[I,y]=(0,g.useState)(o.categories||[]),[w,T]=(0,g.useState)(!1),[k]=(0,R.n)(Ve),[z]=(0,R.n)(Le),[D]=(0,R.n)(Ue);(0,g.useEffect)(()=>{console.log("\ud83d\udcc5 ICalInviteModal event data:",{id:o.id,title:o.title,categories:o.categories,calendarId:o.calendarId,location:o.location})},[o]),(0,g.useEffect)(()=>{y(o.categories||[])},[o.categories]);const{data:M}=(0,A.IT)(He,{context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}});(0,g.useEffect)(()=>{null!==M&&void 0!==M&&M.emailSenders&&M.emailSenders.length>0&&!j&&C(M.emailSenders[0])},[M,j]);const G=async e=>{v(!0),console.log("\ud83d\udce4 Sending RSVP:",{eventId:o.id,response:e,fromEmail:j||"default"});try{var t,r;const s=await k({variables:{eventId:o.id,response:e,fromEmail:j||void 0}});var a,l;if(null===(t=s.data)||void 0===t||null===(r=t.sendRSVPResponse)||void 0===r||!r.success)throw new Error((null===(a=s.data)||void 0===a||null===(l=a.sendRSVPResponse)||void 0===l?void 0:l.message)||"Failed to send RSVP");c({title:"RSVP Sent",description:s.data.sendRSVPResponse.message||"Your response has been sent to the organizer",status:"success",duration:5e3,isClosable:!0}),i&&i(),n()}catch(s){c({title:"Error",description:s.message||"Failed to send RSVP response",status:"error",duration:5e3,isClosable:!0})}finally{v(!1)}},O=e=>{switch(e){case"ACCEPTED":return"green";case"DECLINED":return"red";case"TENTATIVE":return"yellow";default:return"gray"}},N=e=>{try{return(0,$e.GP)(new Date(e),"PPpp")}catch(t){return e}},W="CANCEL"===o.iCalMethod;return(0,Se.jsxs)(F.aF,{isOpen:t,onClose:n,size:"lg",children:[(0,Se.jsx)($.m,{}),(0,Se.jsxs)(_.$,{children:[(0,Se.jsx)(V.r,{children:(0,Se.jsxs)(x.T,{align:"stretch",spacing:2,children:[(0,Se.jsxs)(E.z,{justify:"space-between",children:[(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsx)(b.E,{fontSize:"xs",color:d,children:"Event ID:"}),(0,Se.jsx)(Oe.C,{fontSize:"xs",children:o.id}),(0,Se.jsx)(Ne.m,{label:"Copy Event ID",children:(0,Se.jsx)(ee.K,{"aria-label":"Copy Event ID",icon:(0,Se.jsx)(Fe.paH,{}),size:"xs",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(o.id),c({title:"Event ID copied",status:"success",duration:2e3})}})})]}),(0,Se.jsx)(Ne.m,{label:"Cancel this event (marks as cancelled, doesn't delete)",children:(0,Se.jsx)(ee.K,{"aria-label":"Cancel Event",icon:(0,Se.jsx)(Fe.qbC,{}),size:"sm",colorScheme:"red",variant:"ghost",isLoading:f,onClick:async()=>{if(window.confirm("Are you sure you want to cancel this event? This will mark it as cancelled in your calendar.")){S(!0);try{var e;if(null===(e=(await z({variables:{id:o.id,reason:"User cancelled via iCal invite modal"},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}})).data)||void 0===e||!e.cancelEvent)throw new Error("Failed to cancel event");c({title:"Event cancelled",description:"The event has been marked as cancelled",status:"success",duration:3e3}),i&&i(),n()}catch(t){c({title:"Error cancelling event",description:t.message||"Failed to cancel the event",status:"error",duration:5e3})}finally{S(!1)}}}})})]}),(0,Se.jsxs)(E.z,{spacing:3,children:[(0,Se.jsx)(H.I,{as:Fe.maD,color:"blue.500"}),(0,Se.jsx)(b.E,{children:"Calendar Invitation"}),o.iCalMethod&&(0,Se.jsx)(L.E,{colorScheme:W?"red":"blue",fontSize:"sm",children:o.iCalMethod})]})]})}),(0,Se.jsx)(B.c,{children:(0,Se.jsxs)(te.t,{colorScheme:"blue",size:"sm",children:[(0,Se.jsxs)(ne.w,{children:[(0,Se.jsx)(oe.o,{children:"Event Details"}),o.iCalMeetingLink&&(0,Se.jsx)(oe.o,{children:"Meeting Link"}),o.iCalHtmlBody&&(0,Se.jsx)(oe.o,{children:"Email Preview"}),(o.iCalRawEmail||o.iCalData)&&(0,Se.jsx)(oe.o,{children:"Debug Data"})]}),(0,Se.jsxs)(ie.T,{children:[(0,Se.jsx)(re.K,{children:(0,Se.jsxs)(x.T,{align:"stretch",spacing:4,children:[(null===M||void 0===M?void 0:M.emailSenders)&&M.emailSenders.length>1&&!W&&(0,Se.jsxs)(J.MJ,{children:[(0,Se.jsx)(q.l,{fontSize:"sm",fontWeight:"medium",children:(0,Se.jsxs)(E.z,{spacing:1,children:[(0,Se.jsx)(H.I,{as:Fe.maD}),(0,Se.jsx)(b.E,{children:"Send RSVP from"})]})}),(0,Se.jsx)(K.l,{value:j,onChange:e=>C(e.target.value),size:"sm",borderRadius:"md",children:M.emailSenders.map(e=>(0,Se.jsx)("option",{value:e,children:e},e))})]}),o.iCalResponseStatus&&(0,Se.jsx)(p.a,{p:3,borderRadius:"md",bg:"".concat(O(o.iCalResponseStatus),".50"),borderWidth:1,borderColor:"".concat(O(o.iCalResponseStatus),".200"),children:(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(H.I,{as:(e=>{switch(e){case"ACCEPTED":return Fe.A7C;case"DECLINED":return Fe._Hm;case"TENTATIVE":return Fe.gZZ;default:return Fe.w1Z}})(o.iCalResponseStatus),color:"".concat(O(o.iCalResponseStatus),".500")}),(0,Se.jsxs)(b.E,{fontWeight:"medium",children:["You have ",o.iCalResponseStatus.toLowerCase()," this invitation",j&&" from ".concat(j)]})]})}),(0,Se.jsx)(p.a,{children:(0,Se.jsxs)(b.E,{fontSize:"xl",fontWeight:"bold",color:W?"red.500":"inherit",children:[W&&"\u274c CANCELLED: ",o.title]})}),(o.iCalOrganizerName||o.iCalOrganizerEmail)&&(0,Se.jsxs)(p.a,{p:3,bg:l,borderRadius:"md",children:[(0,Se.jsxs)(E.z,{spacing:2,mb:1,children:[(0,Se.jsx)(H.I,{as:Fe.x$1,color:s}),(0,Se.jsx)(b.E,{fontWeight:"semibold",children:"Organizer"})]}),(0,Se.jsxs)(b.E,{ml:6,children:[o.iCalOrganizerName||"Unknown"," ",o.iCalOrganizerEmail&&(0,Se.jsxs)(b.E,{as:"span",color:s,children:["(",o.iCalOrganizerEmail,")"]})]})]}),(0,Se.jsx)(Pe.c,{}),(0,Se.jsxs)(x.T,{align:"stretch",spacing:3,children:[(0,Se.jsxs)(E.z,{align:"flex-start",children:[(0,Se.jsx)(H.I,{as:Fe.bfZ,color:s,mt:1}),(0,Se.jsxs)(p.a,{flex:1,children:[(0,Se.jsx)(b.E,{fontWeight:"medium",children:"When"}),(0,Se.jsx)(b.E,{fontSize:"sm",color:s,children:N(o.startDateTime)}),(0,Se.jsxs)(b.E,{fontSize:"sm",color:s,children:["to ",N(o.endDateTime)]})]})]}),o.location&&(0,Se.jsxs)(E.z,{align:"flex-start",children:[(0,Se.jsx)(H.I,{as:Fe.vq8,color:s,mt:1}),(0,Se.jsxs)(p.a,{flex:1,children:[(0,Se.jsx)(b.E,{fontWeight:"medium",children:"Where"}),(0,Se.jsx)(b.E,{fontSize:"sm",color:s,children:o.location})]})]}),o.description&&(0,Se.jsxs)(p.a,{children:[(0,Se.jsx)(b.E,{fontWeight:"medium",mb:2,children:"Description"}),(0,Se.jsx)(p.a,{p:3,bg:l,borderRadius:"md",maxH:"200px",overflowY:"auto",children:(0,Se.jsx)(b.E,{fontSize:"sm",whiteSpace:"pre-wrap",children:o.description})})]}),(0,Se.jsxs)(p.a,{children:[(0,Se.jsxs)(E.z,{mb:2,children:[(0,Se.jsx)(H.I,{as:Fe.wJQ,color:s}),(0,Se.jsx)(b.E,{fontWeight:"medium",children:"Event Tags"})]}),(0,Se.jsxs)(p.a,{p:3,bg:l,borderRadius:"md",children:[(0,Se.jsx)(_e.C,{calendarId:o.calendarId||localStorage.getItem("selectedCalendarId")||"",selectedTags:I,onTagsChange:y,placeholder:"Add tags to categorize this event..."}),I.length>0&&I.join(",")!==(o.categories||[]).join(",")&&(0,Se.jsx)(Q.$,{size:"sm",colorScheme:"blue",mt:3,onClick:async()=>{T(!0),console.log("\ud83c\udff7\ufe0f Saving tags:",{eventId:o.id,selectedTags:I,calendarId:o.calendarId||localStorage.getItem("selectedCalendarId")||""});try{const e=await D({variables:{id:o.id,input:{categories:I,title:o.title,startTime:o.startDateTime,endTime:o.endDateTime,calendarId:o.calendarId||localStorage.getItem("selectedCalendarId")||""}},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}});console.log("\u2705 Tags save result:",e),c({title:"Tags updated",status:"success",duration:2e3}),i&&i()}catch(e){c({title:"Error updating tags",description:e.message,status:"error",duration:5e3})}finally{T(!1)}},isLoading:w,children:"Save Tags"})]})]})]}),o.iCalReceivedAt&&(0,Se.jsxs)(E.z,{spacing:2,fontSize:"xs",color:d,children:[(0,Se.jsx)(b.E,{children:"Received:"}),(0,Se.jsx)(b.E,{children:N(o.iCalReceivedAt)}),void 0!==o.iCalSequence&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(b.E,{children:"\u2022"}),(0,Se.jsxs)(b.E,{children:["Update #",o.iCalSequence]})]})]})]})}),o.iCalMeetingLink&&(0,Se.jsx)(re.K,{children:(0,Se.jsx)(x.T,{align:"stretch",spacing:4,children:(0,Se.jsxs)(p.a,{p:4,bg:"blue.50",borderRadius:"md",borderWidth:1,borderColor:"blue.200",children:[(0,Se.jsxs)(E.z,{spacing:3,children:[(0,Se.jsx)(H.I,{as:Fe.bfZ,color:"blue.500"}),(0,Se.jsx)(b.E,{fontWeight:"bold",children:"Join Meeting"})]}),(0,Se.jsx)(We.N,{href:o.iCalMeetingLink,color:"blue.600",isExternal:!0,fontSize:"lg",fontWeight:"medium",mt:3,display:"block",children:o.iCalMeetingLink}),(0,Se.jsx)(Q.$,{as:"a",href:o.iCalMeetingLink,target:"_blank",colorScheme:"blue",size:"lg",mt:4,width:"full",children:"Join Meeting Now"})]})})}),o.iCalHtmlBody&&(0,Se.jsx)(re.K,{children:(0,Se.jsx)(p.a,{borderWidth:1,borderColor:"gray.200",borderRadius:"md",overflow:"hidden",bg:a,children:(0,Se.jsx)(p.a,{p:4,maxH:"500px",overflowY:"auto",dangerouslySetInnerHTML:{__html:o.iCalHtmlBody},sx:{"& a":{color:"blue.500",textDecoration:"underline"},"& img":{maxWidth:"100%",height:"auto"},"& table":{width:"100%"}}})})}),(o.iCalRawEmail||o.iCalData)&&(0,Se.jsx)(re.K,{children:(0,Se.jsxs)(x.T,{align:"stretch",spacing:4,children:[o.iCalRawEmail&&(0,Se.jsxs)(p.a,{children:[(0,Se.jsxs)(E.z,{mb:2,children:[(0,Se.jsx)(b.E,{fontWeight:"bold",fontSize:"sm",children:"Raw Email Metadata:"}),(0,Se.jsx)(ee.K,{icon:(0,Se.jsx)(Fe.paH,{}),size:"xs",onClick:()=>{navigator.clipboard.writeText(o.iCalRawEmail||""),c({title:"Copied to clipboard",status:"success",duration:2e3})},"aria-label":"Copy raw email data"})]}),(0,Se.jsx)(Oe.C,{p:3,borderRadius:"md",fontSize:"xs",maxH:"200px",overflowY:"auto",display:"block",whiteSpace:"pre-wrap",children:JSON.stringify(JSON.parse(o.iCalRawEmail||"{}"),null,2)})]}),o.iCalData&&(0,Se.jsxs)(p.a,{children:[(0,Se.jsxs)(E.z,{mb:2,children:[(0,Se.jsx)(b.E,{fontWeight:"bold",fontSize:"sm",children:"iCal Data:"}),(0,Se.jsx)(ee.K,{icon:(0,Se.jsx)(Fe.paH,{}),size:"xs",onClick:()=>{navigator.clipboard.writeText(o.iCalData||""),c({title:"Copied to clipboard",status:"success",duration:2e3})},"aria-label":"Copy iCal data"})]}),(0,Se.jsx)(Oe.C,{p:3,borderRadius:"md",fontSize:"xs",maxH:"300px",overflowY:"auto",display:"block",whiteSpace:"pre",children:o.iCalData})]})]})})]})]})}),(0,Se.jsx)(he.j,{children:W?(0,Se.jsxs)(E.z,{spacing:3,width:"full",children:[(0,Se.jsx)(b.E,{flex:1,color:"red.500",fontSize:"sm",children:"This event has been cancelled by the organizer"}),(0,Se.jsx)(Q.$,{onClick:n,children:"Close"})]}):(0,Se.jsxs)(E.z,{spacing:3,width:"full",children:[(0,Se.jsx)(Q.$,{leftIcon:(0,Se.jsx)(Fe.A7C,{}),colorScheme:"green",onClick:()=>G("ACCEPTED"),isLoading:m,isDisabled:"ACCEPTED"===o.iCalResponseStatus,flex:1,children:"Accept"}),(0,Se.jsx)(Q.$,{leftIcon:(0,Se.jsx)(Fe.gZZ,{}),colorScheme:"yellow",onClick:()=>G("TENTATIVE"),isLoading:m,isDisabled:"TENTATIVE"===o.iCalResponseStatus,flex:1,children:"Maybe"}),(0,Se.jsx)(Q.$,{leftIcon:(0,Se.jsx)(Fe._Hm,{}),colorScheme:"red",onClick:()=>G("DECLINED"),isLoading:m,isDisabled:"DECLINED"===o.iCalResponseStatus,flex:1,children:"Decline"}),(0,Se.jsx)(Q.$,{variant:"ghost",onClick:n,children:"Close"})]})})]})]})};var Je,qe,Ye,Ke,Ze=n(22205),Xe=n(53407),Qe=n(58861),et=n(48239),tt=n(83290);const nt=(0,D.J1)(Je||(Je=(0,c.A)(["\n  query GetCalendarTags($calendarId: String!) {\n    calendarTags(calendarId: $calendarId) {\n      id\n      name\n      color\n      description\n      usageCount\n    }\n  }\n"]))),ot=(0,tt.i7)(qe||(qe=(0,c.A)(["\n  from { transform: translateX(100%); opacity: 0; }\n  to { transform: translateX(0); opacity: 1; }\n"]))),it=(0,tt.i7)(Ye||(Ye=(0,c.A)(["\n  0% { box-shadow: 0 0 5px rgba(54, 158, 255, 0.5); }\n  50% { box-shadow: 0 0 20px rgba(54, 158, 255, 0.8), 0 0 40px rgba(54, 158, 255, 0.4); }\n  100% { box-shadow: 0 0 5px rgba(54, 158, 255, 0.5); }\n"]))),rt=(0,tt.i7)(Ke||(Ke=(0,c.A)(["\n  0% { transform: translateY(0px); }\n  50% { transform: translateY(-5px); }\n  100% { transform: translateY(0px); }\n"]))),at=e=>{var t;let{events:n,calendarId:o,onFilterChange:i,onTimezoneChange:r,onTagFilterChange:a}=e;const{colorMode:l}=(0,u.G6)(),s=(0,P.oU)("light"===l?"background.card":"background.darkSurface",l),d=(0,P.oU)("light"===l?"background.light":"background.taskCard",l),c=(0,P.oU)("light"===l?"text.primary":"text.primaryDark",l),h=(0,P.oU)("light"===l?"text.secondary":"text.secondaryDark",l),m=(0,P.oU)("light"===l?"text.muted":"text.mutedDark",l),v=(0,P.oU)("border.darkCard",l),[f,S]=(0,g.useState)(!1),[j,C]=(0,g.useState)(new Set),[I,y]=(0,g.useState)(""),[w,T]=(0,g.useState)(new Set),{data:k}=(0,A.IT)(nt,{variables:{calendarId:o},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),z=(null===k||void 0===k?void 0:k.calendarTags)||[],D=[{value:"",label:"No secondary timezone",offset:""},{value:"Europe/London",label:"London",offset:"GMT"},{value:"Europe/Paris",label:"Paris",offset:"CET"},{value:"America/New_York",label:"New York",offset:"EST"},{value:"America/Los_Angeles",label:"Los Angeles",offset:"PST"},{value:"Asia/Tokyo",label:"Tokyo",offset:"JST"},{value:"Asia/Singapore",label:"Singapore",offset:"SGT"},{value:"Asia/Dubai",label:"Dubai",offset:"GST"},{value:"Australia/Sydney",label:"Sydney",offset:"AEDT"},{value:"Pacific/Auckland",label:"Auckland",offset:"NZDT"}],R=[{id:"standard",label:"Standard Events",icon:fe.wIk,color:"blue",description:"Regular calendar events"},{id:"ical_inbound",label:"Inbound iCal",icon:fe.pHD,color:"green",description:"Invites received from others"},{id:"ical_outbound",label:"Outbound iCal",icon:fe.kGk,color:"purple",description:"Invites you sent"},{id:"sms_broadcast",label:"SMS Events",icon:fe.mEP,color:"orange",description:"Events with SMS reminders"},{id:"meeting",label:"Meetings",icon:fe.cfS,color:"teal",description:"Events with multiple attendees"},{id:"reminder",label:"With Reminders",icon:fe.zd,color:"yellow",description:"Events with notifications"},{id:"all_day",label:"All Day Events",icon:fe.Ohp,color:"pink",description:"Full day events"}],{eventCounts:M,tagCounts:G}=(()=>{const e={},t={};return n.forEach(n=>{var o,i,r,a,l,s,d,c,g,u,h,p,m,x;null!==(o=n.extendedProps)&&void 0!==o&&o.isInboundICalInvite||null!==(i=n.extendedProps)&&void 0!==i&&null!==(r=i.metadata)&&void 0!==r&&r["X-EVENT-TYPE"]||(e.standard=(e.standard||0)+1),null!==(a=n.extendedProps)&&void 0!==a&&a.isInboundICalInvite&&(e.ical_inbound=(e.ical_inbound||0)+1),"ICAL_INVITE"===(null===(l=n.extendedProps)||void 0===l||null===(s=l.metadata)||void 0===s?void 0:s["X-EVENT-TYPE"])&&(e.ical_outbound=(e.ical_outbound||0)+1),"SMS_BROADCAST"===(null===(d=n.extendedProps)||void 0===d||null===(c=d.metadata)||void 0===c?void 0:c["X-EVENT-TYPE"])&&(e.sms_broadcast=(e.sms_broadcast||0)+1),(null===(g=n.extendedProps)||void 0===g||null===(u=g.attendees)||void 0===u?void 0:u.length)>0&&(e.meeting=(e.meeting||0)+1),(null===(h=n.extendedProps)||void 0===h||null===(p=h.reminders)||void 0===p?void 0:p.length)>0&&(e.reminder=(e.reminder||0)+1),n.allDay&&(e.all_day=(e.all_day||0)+1),(null===(m=n.extendedProps)||void 0===m||null===(x=m.categories)||void 0===x?void 0:x.length)>0&&n.extendedProps.categories.forEach(e=>{t[e]=(t[e]||0)+1})}),{eventCounts:e,tagCounts:t}})();(0,g.useEffect)(()=>{const e=R.map(e=>e.id);C(new Set(e)),i(new Set(e))},[]),(0,g.useEffect)(()=>{a&&a(new Set)},[z]);return(0,g.useEffect)(()=>{const e=e=>{const t=e.target;f&&!t.closest(".floating-event-filter-container")&&S(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[f]),(0,Se.jsx)(Ze.Z,{children:(0,Se.jsxs)(p.a,{className:"floating-event-filter-container",position:"fixed",right:"20px",top:"60%",transform:"translateY(-50%)",zIndex:997,children:[(0,Se.jsx)(Xe.S,{in:f,animateOpacity:!0,children:(0,Se.jsxs)(p.a,{bg:s,backdropFilter:"blur(20px)",borderRadius:"2xl",border:"1px solid",borderColor:v,p:4,mb:4,minW:"280px",maxW:"320px",maxH:"60vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.8), 0 0 40px rgba(54, 158, 255, 0.1)",animation:"".concat(ot," 0.3s ease-out"),css:{"&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"rgba(54, 158, 255, 0.3)",borderRadius:"2px"}},children:[(0,Se.jsxs)(E.z,{justify:"space-between",mb:4,children:[(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(H.I,{as:fe.K7R,color:"blue.400"}),(0,Se.jsx)(b.E,{fontSize:"sm",fontWeight:"600",color:c,children:"Calendar Settings"})]}),(0,Se.jsxs)(L.E,{colorScheme:"blue",fontSize:"xs",borderRadius:"full",children:[j.size,"/",R.length]})]}),(0,Se.jsxs)(p.a,{mb:4,p:3,bg:d,borderRadius:"lg",border:"1px solid",borderColor:v,children:[(0,Se.jsxs)(E.z,{spacing:2,mb:2,children:[(0,Se.jsx)(H.I,{as:fe.VeH,color:"blue.400",boxSize:4}),(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"600",color:h,children:"Secondary Timezone"})]}),(0,Se.jsx)(K.l,{size:"sm",value:I,onChange:e=>{return t=e.target.value,y(t),void(r&&r(t||null));var t},bg:d,borderColor:v,color:c,fontSize:"xs",_hover:{borderColor:v},_focus:{borderColor:v,boxShadow:"0 0 0 1px ".concat(v)},children:D.map(e=>(0,Se.jsxs)("option",{value:e.value,style:{background:"#1a1a2e"},children:[e.label," ",e.offset&&"(".concat(e.offset,")")]},e.value))}),I&&(0,Se.jsxs)(b.E,{fontSize:"xs",color:m,mt:2,children:["Times will show in both local and ",null===(t=D.find(e=>e.value===I))||void 0===t?void 0:t.label," time"]})]}),(0,Se.jsx)(Pe.c,{borderColor:v,mb:4}),(0,Se.jsxs)(E.z,{spacing:2,mb:3,children:[(0,Se.jsx)(H.I,{as:fe.wIk,color:"blue.400",boxSize:4}),(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"600",color:h,children:"Event Types"})]}),(0,Se.jsx)(p.a,{mb:3,p:2,bg:d,borderRadius:"md",border:"1px solid",borderColor:v,children:(0,Se.jsx)(ue.S,{isChecked:j.size===R.length,isIndeterminate:j.size>0&&j.size<R.length,onChange:()=>{if(j.size===R.length)C(new Set),i(new Set);else{const e=R.map(e=>e.id);C(new Set(e)),i(new Set(e))}},colorScheme:"blue",size:"sm",children:(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"500",color:h,children:"Select All"})})}),(0,Se.jsx)(x.T,{spacing:2,align:"stretch",children:R.map(e=>{const t=M[e.id]||0,n=j.has(e.id);return(0,Se.jsx)(p.a,{p:2,bg:n?d:"transparent",borderRadius:"lg",border:"1px solid",borderColor:n?v:"transparent",transition:"all 0.2s",_hover:{bg:d,borderColor:v},children:(0,Se.jsxs)(E.z,{justify:"space-between",children:[(0,Se.jsx)(ue.S,{isChecked:n,onChange:()=>(e=>{const t=new Set(j);t.has(e)?t.delete(e):t.add(e),C(t),i(t)})(e.id),colorScheme:e.color,size:"sm",children:(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsx)(H.I,{as:e.icon,color:"".concat(e.color,".400"),boxSize:4}),(0,Se.jsxs)(x.T,{align:"start",spacing:0,children:[(0,Se.jsx)(b.E,{fontSize:"sm",color:c,children:e.label}),(0,Se.jsx)(b.E,{fontSize:"xs",color:m,children:e.description})]})]})}),(0,Se.jsx)(L.E,{colorScheme:e.color,fontSize:"xs",variant:n?"solid":"subtle",children:t})]})},e.id)})}),z.length>0&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(Pe.c,{borderColor:v,my:4}),(0,Se.jsxs)(E.z,{spacing:2,mb:3,children:[(0,Se.jsx)(Ne.m,{label:"Filter events by tags. When no tags are selected, all events are shown. Select one or more tags to show only events with those tags.",placement:"left",hasArrow:!0,bg:"gray.700",color:"white",fontSize:"xs",px:3,py:2,borderRadius:"md",maxW:"250px",openDelay:200,children:(0,Se.jsx)(p.a,{display:"inline-flex",children:(0,Se.jsx)(H.I,{as:fe.cnX,color:"blue.400",boxSize:4,cursor:"help"})})}),(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"600",color:h,children:"Custom Tags"})]}),(0,Se.jsx)(p.a,{mb:3,p:2,bg:d,borderRadius:"md",border:"1px solid",borderColor:v,children:(0,Se.jsx)(ue.S,{isChecked:w.size===z.length,isIndeterminate:w.size>0&&w.size<z.length,onChange:()=>{if(w.size===z.length)T(new Set),a&&a(new Set);else{const e=z.map(e=>e.name);T(new Set(e)),a&&a(new Set(e))}},colorScheme:"blue",size:"sm",children:(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"500",color:h,children:"Select All Tags"})})}),(0,Se.jsx)(Qe.B,{spacing:2,children:z.map(e=>{const t=G[e.name]||0,n=w.has(e.name);return(0,Se.jsx)(Qe.Q,{children:(0,Se.jsx)(et.vw,{size:"md",borderRadius:"full",variant:n?"solid":"outline",backgroundColor:n?e.color:"transparent",borderColor:e.color,color:n?"gray.800":c,cursor:"pointer",onClick:()=>(e=>{const t=new Set(w);t.has(e)?t.delete(e):t.add(e),T(t),a&&a(t)})(e.name),_hover:{transform:"scale(1.05)",boxShadow:"0 0 10px ".concat(e.color,"40")},transition:"all 0.2s",children:(0,Se.jsxs)(et.d1,{children:[e.name,t>0&&(0,Se.jsx)(L.E,{ml:2,colorScheme:n?"blackAlpha":"gray",fontSize:"xs",variant:"solid",children:t})]})})},e.id)})})]}),(0,Se.jsx)(p.a,{mt:4,p:3,bg:d,borderRadius:"lg",border:"1px solid",borderColor:v,children:(0,Se.jsxs)(b.E,{fontSize:"xs",color:m,textAlign:"center",children:["Showing ",j.size>0?"".concat(Object.values(M).reduce((e,t)=>e+t,0)," events"):"No events"]})})]})}),(0,Se.jsx)(Ne.m,{label:f?"Close filters":"Filter events",placement:"left",hasArrow:!0,children:(0,Se.jsx)(ee.K,{"aria-label":"Toggle event filters",icon:f?(0,Se.jsx)(fe.yGN,{}):(0,Se.jsx)(fe.K7R,{}),size:"lg",borderRadius:"full",bg:s,color:c,border:"2px solid",borderColor:v,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.8), 0 0 60px rgba(54, 158, 255, 0.2)",onClick:()=>S(!f),position:"relative",_hover:{transform:"scale(1.1)",borderColor:v,animation:"".concat(it," 2s ease infinite")},_active:{transform:"scale(0.95)"},transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",animation:f?void 0:"".concat(rt," 3s ease-in-out infinite"),_before:f?void 0:{content:'""',position:"absolute",top:"-2px",right:"-2px",bottom:"-2px",left:"-2px",background:"linear-gradient(45deg, #369eff, #147fd6, #369eff)",borderRadius:"full",opacity:.3,filter:"blur(10px)",animation:"".concat(it," 3s ease infinite"),zIndex:-1},children:j.size<R.length&&(0,Se.jsx)(L.E,{position:"absolute",top:"-2px",right:"-2px",colorScheme:"red",borderRadius:"full",fontSize:"xs",minW:"20px",h:"20px",display:"flex",alignItems:"center",justifyContent:"center",children:j.size})})})]})})};var lt=n(66037);const st="calendar-scroll-position",dt=(e,t,n)=>{try{const o={calendarId:e,view:t,scrollTime:n,timestamp:Date.now()};localStorage.setItem(st,JSON.stringify(o)),console.log("\ud83d\udcbe Saved scroll position:",o)}catch(o){console.error("Failed to save scroll position:",o)}},ct=e=>{let{calendarId:t,currentView:n,isPreservingView:o,calendarRef:i}=e;const r=(0,h.d)(),a=(0,g.useRef)(!1);(0,g.useEffect)(()=>{if(o||a.current)console.log("\ud83d\udeab Skipping auto-scroll - isPreservingView:",o,"isManualScroll:",a.current);else if("timeGridWeek"===n||"timeGridDay"===n){var e;const o=null===(e=i.current)||void 0===e?void 0:e.getApi();o&&t&&requestAnimationFrame(()=>{setTimeout(()=>{const e=((e,t)=>{try{const n=localStorage.getItem(st);if(!n)return null;const o=JSON.parse(n),i=3e5;return o.calendarId===e&&o.view===t&&Date.now()-o.timestamp<i?(console.log("\ud83d\udcc2 Loaded scroll position:",o),o.scrollTime):null}catch(n){return console.error("Failed to load scroll position:",n),null}})(t,n);let i;if(e)console.log("\ud83d\udcc2 Restoring saved scroll position:",e),i=e;else{const e=new Date;i=new Date(e.getTime()-72e5).toTimeString().slice(0,8),console.log("\ud83d\udcdc Auto-scrolling to default time (2hrs before now):",i)}o.scrollToTime(i)},500)})}},[n,o,t,i]);return{isManualScrollRef:a,handleScrollToNow:()=>{var e;console.log("\ud83d\udd50 Scroll to Now button clicked");const o=null===(e=i.current)||void 0===e?void 0:e.getApi();if(!o)return void console.log("\u274c No calendar API available");const l=new Date;if("timeGridWeek"===n||"timeGridDay"===n){a.current=!0;const e=l.toTimeString().slice(0,8);console.log("\ud83d\udccd Manual scroll to CURRENT time:",e),setTimeout(()=>{const i=document.querySelectorAll('[class*="fc-scroller"]');console.log("\ud83d\udd0d Found FullCalendar scroller elements:",i.length);let s=null;if(i.forEach(e=>{const t=e;console.log("\ud83d\udd0e Checking: ".concat(t.className,", scrollHeight: ").concat(t.scrollHeight,"px, clientHeight: ").concat(t.clientHeight,"px, scrollTop: ").concat(t.scrollTop,"px")),t.clientHeight>0&&t.scrollHeight>t.clientHeight&&(console.log("\u2705 Found VISIBLE scrollable container: ".concat(t.className)),s||(s=t))}),!s){console.error("\u274c No visible scrollable container found! Trying window scroll as fallback...");const o=document.querySelector(".fc-timegrid-now-indicator-line");if(o){const e=o.getBoundingClientRect().top+window.scrollY,t=e-.5*window.innerHeight;console.log("\ud83d\udd34 Found now indicator at ".concat(e,"px, scrolling to ").concat(t,"px (50% down)")),window.scrollTo({top:t,behavior:"smooth"})}else{const e=(60*l.getHours()+l.getMinutes())/60*48;console.log("\u26a0\ufe0f Red line not found, using calculated scroll"),window.scrollTo({top:e,behavior:"smooth"})}return t&&dt(t,n,e),void r({title:"\ud83d\udd50 Scrolled to current time",description:"Positioned at ".concat(e),status:"success",duration:2e3,isClosable:!0})}const d=s;console.log("\ud83d\udccf BEFORE scroll - scrollTop: ".concat(d.scrollTop,"px, scrollHeight: ").concat(d.scrollHeight,"px, clientHeight: ").concat(d.clientHeight,"px"));const c=document.querySelector(".fc-timegrid-now-indicator-line");if(c){const e=c.offsetTop,t=e-.5*d.clientHeight;console.log("\ud83d\udd34 Found now indicator at ".concat(e,"px, scrolling container to ").concat(t,"px (50% down)")),d.scrollTo({top:t,behavior:"smooth"})}else console.log("\u26a0\ufe0f Red line not found, using scrollToTime API"),o.scrollToTime(e);setTimeout(()=>{console.log("\ud83d\udccf AFTER scroll - scrollTop: ".concat(d.scrollTop,"px")),t&&dt(t,n,e)},100),setTimeout(()=>{a.current=!1,console.log("\ud83d\udd13 Manual scroll lock released")},3e3),r({title:"\ud83d\udd50 Scrolled to current time",description:"Positioned at ".concat(e),status:"success",duration:2e3,isClosable:!0})},600)}else r({title:"Scroll to now only works in Week or Day view",status:"info",duration:3e3,isClosable:!0})}}},gt=e=>{var t,n,o,i,r;let{eventContent:a,isMultiCalendar:l,calendarsData:s}=e;const d=null===(t=a.event.extendedProps)||void 0===t?void 0:t.isInboundICalInvite,c=null===(n=a.event.extendedProps)||void 0===n?void 0:n.iCalMethod,g=null===(o=a.event.extendedProps)||void 0===o?void 0:o.iCalResponseStatus,u=()=>{var e,t,n;if(!l)return null;const o=(null===(e=a.event.extendedProps)||void 0===e?void 0:e.calendarId)||(null===(t=a.event._def)||void 0===t||null===(n=t.extendedProps)||void 0===n?void 0:n.calendarId);if(!o)return null;const i=((null===s||void 0===s?void 0:s.getCalendarsByIds)||[]).find(e=>e.id===o);return(null===i||void 0===i?void 0:i.name)||null},h=null===(i=a.event.extendedProps)||void 0===i?void 0:i.metadata,m="ICAL_INVITE"===(null===h||void 0===h?void 0:h["X-EVENT-TYPE"]),x=(null===h||void 0===h?void 0:h["X-EVENT-TYPE"])||"STANDARD",v=d||m;return(0,Se.jsxs)(p.a,{p:1,cursor:"pointer",position:"relative",children:[v&&(0,Se.jsxs)(L.E,{position:"absolute",top:"-2px",right:"-2px",colorScheme:m?"purple":"CANCEL"===c?"red":"ACCEPTED"===g?"green":"DECLINED"===g?"red":"TENTATIVE"===g?"yellow":"blue",fontSize:"9px",px:1,borderRadius:"full",zIndex:2,children:[m?"\ud83d\udce4":"CANCEL"===c?"\u274c":"REPLY"===c?"\ud83d\udcac":"COUNTER"===c?"\ud83d\udd00":"\ud83d\udce8"," iCal"]}),(0,Se.jsxs)(E.z,{spacing:1,align:"flex-start",children:[(0,Se.jsx)(b.E,{fontSize:"xs",flexShrink:0,children:(()=>{if(d)return"\ud83d\udce8";if(m)return"\ud83d\udce4";switch(x){case"SMS_BROADCAST":return"\ud83d\udcac";case"EMAIL_BROADCAST":return"\u2709\ufe0f";case"BOTH_BROADCAST":return"\ud83d\udce2";case"ICAL_INVITE":return"\ud83d\udce4";default:return"\ud83d\udcc5"}})()}),(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"bold",noOfLines:1,color:"white",flex:1,children:a.event.title})]}),d&&(null===(r=a.event.extendedProps)||void 0===r?void 0:r.iCalOrganizerName)&&(0,Se.jsxs)(b.E,{fontSize:"9px",opacity:.8,color:"white",noOfLines:1,children:["from ",a.event.extendedProps.iCalOrganizerName]}),m&&(0,Se.jsx)(b.E,{fontSize:"9px",opacity:.8,color:"white",noOfLines:1,children:"sent by you"}),"timeGridWeek"===a.view.type&&!a.event.allDay&&(0,Se.jsx)(b.E,{fontSize:"xs",opacity:.9,color:"white",children:a.timeText}),l&&u()&&(0,Se.jsx)(b.E,{fontSize:"9px",opacity:.7,color:"white",noOfLines:1,fontStyle:"italic",children:u()})]})};var ut=n(37809);const ht=e=>{var t;let{currentDate:n,secondaryTimezone:o,getTimeInSecondaryTimezone:i,showGoals:r,setShowGoals:a,setSelectedEvent:l,setIsEventModalOpen:s,cardGradientBg:d,cardBorder:c,textSecondary:g,primaryColor:u}=e;const h=(0,k.Zp)();return(0,Se.jsx)(j.Z,{bg:d,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:c,children:(0,Se.jsx)(C.b,{py:2,px:3,children:(0,Se.jsxs)(E.z,{justify:"space-between",align:"center",children:[(0,Se.jsxs)(E.z,{spacing:3,children:[(0,Se.jsx)(b.E,{fontSize:"xs",color:g,children:n.toLocaleDateString()}),(0,Se.jsxs)(E.z,{spacing:1,children:[(0,Se.jsx)(H.I,{as:fe.Ohp,color:u,boxSize:3}),(0,Se.jsx)(b.E,{fontSize:"xs",color:g,children:(new Date).toLocaleTimeString()})]}),o&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(b.E,{fontSize:"xs",color:g,children:"|"}),(0,Se.jsxs)(E.z,{spacing:1,children:[(0,Se.jsxs)(b.E,{fontSize:"xs",color:"cyan.400",children:[null===(t=o.split("/").pop())||void 0===t?void 0:t.replace("_"," "),":"]}),(0,Se.jsx)(b.E,{fontSize:"xs",color:"cyan.300",children:i(new Date,o)})]})]})]}),(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsxs)(Q.$,{leftIcon:(0,Se.jsx)(H.I,{as:r?fe._NO:fe.Vap,boxSize:3}),variant:"ghost",onClick:()=>a(!r),color:u,size:"xs",fontSize:"xs",height:"24px",px:2,_hover:{bg:"rgba(59, 130, 246, 0.1)"},children:[r?"Hide":"Show"," Goals"]}),(0,Se.jsx)(Q.$,{leftIcon:(0,Se.jsx)(ut.g,{boxSize:3}),variant:"ghost",onClick:()=>h("/calendars"),color:u,size:"xs",fontSize:"xs",height:"24px",px:2,_hover:{bg:"rgba(59, 130, 246, 0.1)"},children:"Back"}),(0,Se.jsx)(Q.$,{leftIcon:(0,Se.jsx)(me.R,{boxSize:3}),colorScheme:"blue",onClick:()=>{l(null),s(!0)},size:"xs",fontSize:"xs",height:"24px",px:2,children:"New Event"})]})]})})})};var pt=n(26201),mt=n(5371),xt=n(28846),vt=n(92293);const bt=e=>"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]," ").concat(e.getFullYear()),ft=(e,t)=>{try{return e.toLocaleTimeString("en-US",{timeZone:t,hour:"numeric",minute:"2-digit",hour12:!0})}catch(n){return""}},St=e=>{var t;return(null===(t=e.split("/").pop())||void 0===t?void 0:t.replace("_"," "))||e},jt=(e,t,n)=>{var o,i;if(!e||!t)return null;const r=[],a=n?"00:00":(null===(o=t.settings)||void 0===o?void 0:o.workingHoursStart)||"08:00",l=n?"24:00":(null===(i=t.settings)||void 0===i?void 0:i.workingHoursEnd)||"18:00",[s]=a.split(":").map(Number),[d]=l.split(":").map(Number);for(let c=s;c<d;c++){const t=new Date;t.setHours(c,0,0,0);const n=ft(t,e);r.push((0,Se.jsx)(p.a,{height:"60px",display:"flex",alignItems:"center",justifyContent:"flex-end",pr:2,fontSize:"11px",fontWeight:"500",color:"cyan.400",borderTop:c===s?"none":"1px solid",borderColor:"rgba(54, 158, 255, 0.1)",children:n},c))}return r},Ct=e=>{let{currentDate:t,localGoals:n,clientsData:o,selectedGoalId:i,setSelectedGoalId:r,setIsGoalsModalOpen:a,handleToggleCheckpoint:l,cardGradientBg:s,cardBorder:d,textPrimary:c,textSecondary:g,primaryColor:u}=e;return(0,Se.jsx)(p.a,{position:"sticky",top:"0",zIndex:10,mb:4,children:(0,Se.jsxs)(j.Z,{bg:s,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px solid",borderColor:d,children:[(0,Se.jsx)(pt.a,{pb:2,children:(0,Se.jsxs)(x.T,{align:"stretch",spacing:3,children:[(0,Se.jsxs)(mt.s,{justify:"space-between",align:"center",flexWrap:"wrap",gap:2,children:[(0,Se.jsxs)(E.z,{flex:"1",minW:"200px",children:[(0,Se.jsx)(H.I,{as:vt.G,color:u,boxSize:{base:4,md:5}}),(0,Se.jsxs)(xt.D,{size:{base:"sm",md:"md"},color:c,children:[bt(t)," Goals"]})]}),(0,Se.jsx)(Q.$,{size:{base:"xs",md:"sm"},colorScheme:"blue",onClick:()=>a(!0),children:"Edit Goals"})]}),(0,Se.jsxs)(p.a,{p:3,bg:"rgba(255, 255, 255, 0.02)",borderRadius:"md",border:"1px solid",borderColor:d,children:[(0,Se.jsxs)(E.z,{justify:"space-between",mb:2,children:[(0,Se.jsx)(b.E,{fontSize:"xs",color:g,fontWeight:"semibold",children:"MONTH PROGRESS"}),(0,Se.jsxs)(b.E,{fontSize:"xs",color:u,fontWeight:"bold",children:["Day ",(new Date).getDate()," of ",new Date(t.getFullYear(),t.getMonth()+1,0).getDate()]})]}),(0,Se.jsx)(X.r,{columns:{base:10,sm:15,md:31},spacing:1,width:"100%",children:Array.from({length:new Date(t.getFullYear(),t.getMonth()+1,0).getDate()},(e,t)=>{const n=t+1,o=(new Date).getDate(),i=n<o,r=n===o;return(0,Se.jsxs)(mt.s,{position:"relative",minW:"25px",h:"25px",alignItems:"center",justifyContent:"center",fontSize:{base:"10px",md:"11px"},fontWeight:r?"bold":"normal",color:i?g:r?u:c,bg:r?"rgba(59, 130, 246, 0.2)":i?"rgba(0, 0, 0, 0.2)":"transparent",borderRadius:"sm",border:r?"1px solid":"none",borderColor:u,opacity:i&&!r?.5:1,transition:"all 0.2s",overflow:"hidden",_hover:i?{}:{bg:"rgba(59, 130, 246, 0.1)",transform:"scale(1.1)"},children:[i&&!r&&(0,Se.jsx)(p.a,{position:"absolute",top:"50%",left:"-50%",right:"-50%",height:"1px",bg:g,transform:"rotate(-45deg)"}),n]},n)})}),(0,Se.jsx)(ae.k,{value:(new Date).getDate()/new Date(t.getFullYear(),t.getMonth()+1,0).getDate()*100,size:"xs",colorScheme:"blue",mt:2,borderRadius:"full"})]}),(0,Se.jsxs)(mt.s,{justify:"space-between",align:"center",flexWrap:"wrap",gap:2,children:[n&&n.length>0&&(0,Se.jsxs)(L.E,{colorScheme:"green",fontSize:{base:"xs",md:"sm"},children:[n.reduce((e,t)=>e+t.checkpoints.filter(e=>e.completed).length,0)," / ",n.reduce((e,t)=>e+t.checkpoints.length,0)," tasks"]}),(0,Se.jsxs)(b.E,{fontSize:{base:"xs",md:"sm"},color:g,children:["Progress: ",n&&n.length>0?Math.round(n.reduce((e,t)=>e+t.progressPercentage,0)/n.length):0,"%"]})]})]})}),(0,Se.jsx)(C.b,{pt:2,children:n&&0!==n.length?(0,Se.jsx)(X.r,{columns:{base:1,md:2,lg:4},spacing:4,children:n.map(e=>{var t,i,s,h;const m=e.parentGoalId?n.find(t=>t.id===e.parentGoalId):null,v=m&&m.progressPercentage<100,f=e.assignedTo&&null!==o&&void 0!==o&&o.clients?o.clients.find(t=>t.id===e.assignedTo):null;return(0,Se.jsxs)(p.a,{p:4,bg:"rgba(255, 255, 255, 0.03)",borderRadius:"lg",border:"1px solid",borderColor:v?"orange.500":d,position:"relative",opacity:v?.7:1,transition:"all 0.2s",cursor:"pointer",onClick:()=>{r(e.id),a(!0)},_hover:{bg:"rgba(255, 255, 255, 0.05)",transform:v?"none":"translateY(-2px)",boxShadow:v?"none":"0 4px 12px rgba(0,0,0,0.15)"},children:[m&&(0,Se.jsx)(p.a,{position:"absolute",top:"-10px",left:"10px",bg:v?"orange.500":"green.500",color:"white",fontSize:"10px",px:2,py:.5,borderRadius:"full",fontWeight:"bold",zIndex:1,children:v?"Blocked by: ".concat(m.title.slice(0,20),"..."):"\u2713 Dependency met"}),(0,Se.jsxs)(x.T,{align:"stretch",spacing:3,children:[(0,Se.jsxs)(E.z,{justify:"space-between",children:[(0,Se.jsxs)(E.z,{children:[(0,Se.jsx)(H.I,{as:e.icon||fe.x_j,color:v?"orange.400":e.color||"blue.400",boxSize:5}),(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"bold",color:v?"orange.400":e.color||"blue.400",textTransform:"uppercase",children:e.category})]}),(0,Se.jsxs)(L.E,{colorScheme:v?"orange":e.progressPercentage>=70?"green":e.progressPercentage>=40?"yellow":"red",fontSize:"xs",children:[v?"\ud83d\udd12":""," ",e.progressPercentage,"%"]})]}),(0,Se.jsxs)(x.T,{align:"stretch",spacing:1,children:[(0,Se.jsx)(b.E,{color:c,fontWeight:"semibold",fontSize:"sm",children:e.title}),f&&(0,Se.jsxs)(E.z,{spacing:1,children:[(0,Se.jsx)(H.I,{as:fe.JXP,color:g,boxSize:3}),(0,Se.jsxs)(b.E,{fontSize:"xs",color:g,children:[f.fName," ",f.lName]})]}),(0,Se.jsxs)(E.z,{justify:"space-between",children:[(0,Se.jsxs)(b.E,{fontSize:"xs",color:g,children:["Current: ",e.currentValue||"0"]}),(0,Se.jsxs)(b.E,{fontSize:"xs",color:u,fontWeight:"bold",children:["Target: ",e.targetValue||"1"]})]})]}),(0,Se.jsx)(ae.k,{value:e.progressPercentage||0,size:"sm",colorScheme:e.color?e.color.replace("#","").toLowerCase():"blue",borderRadius:"full",bg:"rgba(255, 255, 255, 0.1)",hasStripe:!0,isAnimated:!0}),(0,Se.jsx)(Pe.c,{borderColor:d}),(0,Se.jsxs)(x.T,{align:"stretch",spacing:1,children:[(e.checkpoints||e.tasks||[]).slice(0,3).map(t=>(0,Se.jsxs)(E.z,{spacing:2,align:"flex-start",children:[(0,Se.jsx)(ue.S,{isChecked:t.completed,onChange:n=>{e.id&&t.id&&l(e.id,t.id,n.target.checked)},size:"sm",colorScheme:e.color?e.color.replace("#","").toLowerCase():"blue",mt:.5}),(0,Se.jsx)(b.E,{fontSize:"xs",color:t.completed?g:c,textDecoration:t.completed?"line-through":"none",flex:"1",wordBreak:"break-word",children:t.title||t.text||"Untitled task"})]},t.id)),((null===(t=e.checkpoints)||void 0===t?void 0:t.length)||(null===(i=e.tasks)||void 0===i?void 0:i.length)||0)>3&&(0,Se.jsxs)(b.E,{fontSize:"xs",color:g,fontStyle:"italic",children:["+",((null===(s=e.checkpoints)||void 0===s?void 0:s.length)||(null===(h=e.tasks)||void 0===h?void 0:h.length)||0)-3," more tasks..."]})]})]})]},e.id)})}):(0,Se.jsxs)(p.a,{textAlign:"center",py:8,children:[(0,Se.jsx)(b.E,{color:g,mb:4,children:"No goals set for this month"}),(0,Se.jsx)(Q.$,{colorScheme:"blue",onClick:()=>a(!0),children:"Add Your First Goal"})]})})]})})};var Et=n(26602),It=n(14261),yt=n(82497);const wt=e=>{var t;let{currentView:n,currentDate:o,isMultiCalendar:i,calendarIds:r,calendar:a,calendarsData:l,linkedEmailData:s,filteredEvents:d,calendarColorMap:c,is24HourView:g,handleToday:u,handleScrollToNow:h,handlePrevious:p,handleNext:m,handleViewChange:v,setIs24HourView:j,updateUrlParams:C,textPrimary:I,textSecondary:y,primaryColor:w,primaryHover:T,cardBorder:z}=e;const D=(0,k.Zp)();return(0,Se.jsxs)(mt.s,{width:"100%",align:"center",justify:"space-between",flexWrap:{base:"wrap",md:"nowrap"},gap:4,children:[(0,Se.jsxs)(E.z,{spacing:{base:2,md:4},flex:"1",align:"center",children:[(0,Se.jsx)(Q.$,{onClick:u,variant:"outline",borderColor:w,color:w,_hover:{bg:"rgba(59, 130, 246, 0.1)"},size:{base:"sm",md:"md"},fontWeight:"medium",children:"Today"}),("timeGridWeek"===n||"timeGridDay"===n)&&(0,Se.jsx)(Q.$,{onClick:h,variant:"ghost",colorScheme:"blue",leftIcon:(0,Se.jsx)(Et.b,{}),size:{base:"sm",md:"md"},fontWeight:"medium",title:"Scroll to current time",children:(0,Se.jsx)(b.E,{display:{base:"none",md:"block"},children:"Now"})}),(0,Se.jsxs)(E.z,{spacing:1,children:[(0,Se.jsx)(ee.K,{"aria-label":"Previous month",icon:(0,Se.jsx)(It.Y,{}),onClick:p,variant:"ghost",color:I,_hover:{bg:"rgba(59, 130, 246, 0.1)"},size:{base:"xs",md:"sm"}}),(0,Se.jsx)(ee.K,{"aria-label":"Next month",icon:(0,Se.jsx)(be.v,{}),onClick:m,variant:"ghost",color:I,_hover:{bg:"rgba(59, 130, 246, 0.1)"},size:{base:"xs",md:"sm"}})]}),(0,Se.jsx)(xt.D,{size:{base:"sm",md:"md"},color:I,fontWeight:"semibold",children:bt(o)}),(0,Se.jsx)(Pe.c,{orientation:"vertical",height:"20px",borderColor:z}),(0,Se.jsxs)(x.T,{align:"start",spacing:0,children:[!i&&(0,Se.jsx)(Se.Fragment,{children:null!==s&&void 0!==s&&s.getLinkedEmailForCalendar?(0,Se.jsxs)(f.F,{status:"info",variant:"subtle",bg:"rgba(59, 130, 246, 0.1)",borderRadius:"md",py:1,px:3,mb:2,children:[(0,Se.jsx)(S._,{boxSize:"14px",color:w}),(0,Se.jsxs)(b.E,{fontSize:"xs",color:I,children:["\ud83d\udce7 Listening for calendar invites on ",(0,Se.jsx)("strong",{children:s.getLinkedEmailForCalendar})]}),(0,Se.jsx)(Ne.m,{label:(0,Se.jsxs)(x.T,{align:"start",spacing:2,p:1,children:[(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"semibold",children:"How Email-to-Calendar Linking Works:"}),(0,Se.jsxs)(b.E,{fontSize:"xs",children:["Email addresses can have a ",(0,Se.jsx)("strong",{children:"primary calendar"})," and ",(0,Se.jsx)("strong",{children:"additional linked calendars"}),"."]}),(0,Se.jsx)(b.E,{fontSize:"xs",children:"When calendar invites (.ics files) are sent to an email address, they automatically appear on all linked calendars."}),(0,Se.jsx)(We.N,{href:"/emails/admin/accounts",color:"blue.300",textDecoration:"underline",fontSize:"xs",fontWeight:"semibold",children:"Manage Email Accounts \u2192"})]}),placement:"bottom",hasArrow:!0,bg:"gray.800",color:"white",borderRadius:"md",p:3,maxW:"350px",children:(0,Se.jsx)(ee.K,{"aria-label":"Email linking info",icon:(0,Se.jsx)(yt.m,{}),size:"xs",variant:"ghost",color:w,ml:2,_hover:{bg:"rgba(59, 130, 246, 0.2)"}})})]}):(0,Se.jsxs)(f.F,{status:"warning",variant:"subtle",bg:"rgba(251, 191, 36, 0.1)",borderRadius:"md",py:1,px:3,mb:2,children:[(0,Se.jsx)(S._,{boxSize:"14px",color:"orange.400"}),(0,Se.jsx)(b.E,{fontSize:"xs",color:I,children:"This calendar is not listening on any emails."}),(0,Se.jsx)(Ne.m,{label:(0,Se.jsxs)(x.T,{align:"start",spacing:2,p:1,children:[(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"semibold",children:"Set Up Email Listening:"}),(0,Se.jsx)(b.E,{fontSize:"xs",children:"To receive calendar invites via email, link this calendar to an email address."}),(0,Se.jsxs)(b.E,{fontSize:"xs",children:["You can set it as the ",(0,Se.jsx)("strong",{children:"primary calendar"})," for an email address, or add it as an ",(0,Se.jsx)("strong",{children:"additional linked calendar"}),"."]}),(0,Se.jsx)(We.N,{href:"/emails/admin/accounts",color:"blue.300",textDecoration:"underline",fontSize:"xs",fontWeight:"semibold",children:"Manage Email Accounts \u2192"})]}),placement:"bottom",hasArrow:!0,bg:"gray.800",color:"white",borderRadius:"md",p:3,maxW:"350px",children:(0,Se.jsx)(ee.K,{"aria-label":"Email linking info",icon:(0,Se.jsx)(yt.m,{}),size:"xs",variant:"ghost",color:"orange.400",ml:2,_hover:{bg:"rgba(251, 191, 36, 0.2)"}})})]})}),i?(0,Se.jsxs)(x.T,{align:"start",spacing:1,children:[(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsx)(pe.C,{color:w,boxSize:4}),(0,Se.jsxs)(b.E,{fontSize:"sm",fontWeight:"semibold",color:I,children:["Multi-Calendar View (",r.length," calendars)"]}),(0,Se.jsxs)(L.E,{colorScheme:"green",size:"sm",children:[d.length," Events"]})]}),(0,Se.jsx)(E.z,{spacing:2,flexWrap:"wrap",children:null===l||void 0===l||null===(t=l.getCalendarsByIds)||void 0===t?void 0:t.map(e=>(0,Se.jsx)(L.E,{px:2,py:1,borderRadius:"md",bg:c.get(e.id)||"#3B82F6",color:"white",fontSize:"xs",cursor:"pointer",_hover:{opacity:.8,transform:"scale(1.05)",transition:"all 0.2s"},onClick:()=>window.open("/calendars/".concat(e.id,"/view"),"_blank"),children:e.name},e.id))})]}):(0,Se.jsxs)(E.z,{spacing:2,children:[(0,Se.jsx)(pe.C,{color:w,boxSize:4}),(0,Se.jsx)(b.E,{fontSize:"sm",fontWeight:"semibold",color:I,children:null===a||void 0===a?void 0:a.name}),(0,Se.jsx)(L.E,{colorScheme:"blue",size:"sm",children:null===a||void 0===a?void 0:a.type}),"PERSONAL"===(null===a||void 0===a?void 0:a.type)&&(0,Se.jsx)(L.E,{colorScheme:"purple",size:"sm",children:"Personal"}),(0,Se.jsxs)(L.E,{colorScheme:"green",size:"sm",children:[d.length," Events"]}),(0,Se.jsx)(Q.$,{size:"xs",variant:"ghost",color:w,onClick:()=>D("/calendars/".concat(null===a||void 0===a?void 0:a.id)),_hover:{bg:"rgba(59, 130, 246, 0.1)"},children:"Settings"})]}),!i&&(null===a||void 0===a?void 0:a.description)&&(0,Se.jsx)(b.E,{fontSize:"xs",color:y,pl:6,children:a.description})]})]}),(0,Se.jsxs)(E.z,{spacing:{base:1,md:2},children:[(0,Se.jsx)(Q.$,{size:{base:"xs",md:"sm"},onClick:()=>v("dayGridMonth"),bg:"dayGridMonth"===n?w:"transparent",color:"dayGridMonth"===n?"white":I,_hover:{bg:"dayGridMonth"===n?T:"rgba(59, 130, 246, 0.1)"},borderRadius:"md",px:{base:2,md:4},children:"Month"}),(0,Se.jsx)(Q.$,{size:{base:"xs",md:"sm"},onClick:()=>v("timeGridWeek"),bg:"timeGridWeek"===n?w:"transparent",color:"timeGridWeek"===n?"white":I,_hover:{bg:"timeGridWeek"===n?T:"rgba(59, 130, 246, 0.1)"},borderRadius:"md",px:{base:2,md:4},children:"Week"}),(0,Se.jsx)(Q.$,{size:{base:"xs",md:"sm"},onClick:()=>v("timeGridDay"),bg:"timeGridDay"===n?w:"transparent",color:"timeGridDay"===n?"white":I,_hover:{bg:"timeGridDay"===n?T:"rgba(59, 130, 246, 0.1)"},borderRadius:"md",px:{base:2,md:4},children:"Day"}),("timeGridWeek"===n||"timeGridDay"===n)&&(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(Pe.c,{orientation:"vertical",height:"20px",borderColor:y,opacity:.3}),(0,Se.jsx)(Q.$,{size:{base:"xs",md:"sm"},onClick:()=>{const e=!g;j(e),C({hours:e?"24":"business"})},bg:g?w:"transparent",color:g?"white":I,_hover:{bg:g?T:"rgba(59, 130, 246, 0.1)"},borderRadius:"md",px:{base:2,md:4},leftIcon:(0,Se.jsx)(H.I,{as:Et.b,boxSize:{base:3,md:4}}),children:g?"Business":"24h"})]})]})]})};var Tt,kt,zt,Dt,At,Rt,Mt,Gt,Ot,Nt,Pt;const Wt=(0,D.J1)(Tt||(Tt=(0,c.A)(["\n  query GetCalendarsByIds($ids: [String!]!) {\n    getCalendarsByIds(ids: $ids) {\n      id\n      name\n      description\n      type\n      color\n      responsibleOwnerId\n      settings {\n        timezone\n        workingHoursStart\n        workingHoursEnd\n        workingDays\n      }\n      isActive\n    }\n  }\n"]))),Ft=(0,D.J1)(kt||(kt=(0,c.A)(["\n  query GetCalendar($id: String!) {\n    calendar(id: $id) {\n      id\n      name\n      description\n      type\n      color\n      responsibleOwnerId\n      settings {\n        timezone\n        workingHoursStart\n        workingHoursEnd\n        workingDays\n      }\n      isActive\n    }\n  }\n"]))),$t=(0,D.J1)(zt||(zt=(0,c.A)(["\n  query GetLinkedEmailForCalendar($calendarId: String!, $tenantId: String) {\n    getLinkedEmailForCalendar(calendarId: $calendarId, tenantId: $tenantId)\n  }\n"]))),_t=(0,D.J1)(Dt||(Dt=(0,c.A)(["\n  query GetMultiCalendarEvents($calendarIds: [String!]!, $startDate: String, $endDate: String) {\n    multiCalendarEvents(calendarIds: $calendarIds, startDate: $startDate, endDate: $endDate) {\n      id\n      calendarId\n      title\n      description\n      startTime\n      endTime\n      isAllDay\n      status\n      color\n      categories\n      location {\n        name\n        address\n      }\n      attendees {\n        clientId\n        email\n        name\n        status\n      }\n      isCancelled\n      isInboundICalInvite\n      iCalMethod\n      iCalResponseStatus\n      iCalOrganizerName\n      iCalOrganizerEmail\n      metadata\n    }\n  }\n"]))),Vt=(0,D.J1)(At||(At=(0,c.A)(["\n  query GetCalendarEvents($calendarId: String!, $startDate: String, $endDate: String) {\n    calendarEvents(calendarId: $calendarId, startDate: $startDate, endDate: $endDate) {\n      id\n      calendarId\n      title\n      description\n      startTime\n      endTime\n      isAllDay\n      status\n      color\n      categories\n      location {\n        name\n        address\n      }\n      attendees {\n        clientId\n        email\n        name\n        status\n      }\n      isCancelled\n      isInboundICalInvite\n      iCalMethod\n      iCalResponseStatus\n      iCalOrganizerName\n      iCalOrganizerEmail\n      metadata\n    }\n  }\n"]))),Ht=(0,D.J1)(Rt||(Rt=(0,c.A)(["\n  query GetCurrentMonthGoals($calendarId: String!) {\n    currentMonthGoals(calendarId: $calendarId) {\n      id\n      title\n      description\n      category\n      progressPercentage\n      currentValue\n      targetValue\n      checkpoints {\n        id\n        title\n        completed\n      }\n      color\n      parentGoalId\n      assignedTo\n    }\n  }\n"]))),Lt=(0,D.J1)(Mt||(Mt=(0,c.A)(["\n  query GetClients {\n    clients {\n      id\n      fName\n      lName\n      businessName\n    }\n  }\n"]))),Ut=(0,D.J1)(Gt||(Gt=(0,c.A)(["\n  query GetExternalCalendars {\n    getExternalCalendars {\n      id\n      name\n      type\n      iCalUrl\n      color\n      sharedFromName\n      sharedFromEmail\n      isActive\n    }\n  }\n"]))),Bt=(0,D.J1)(Ot||(Ot=(0,c.A)(["\n  mutation UpdateGoalCheckpoint($input: UpdateGoalCheckpointInput!) {\n    updateGoalCheckpoint(input: $input) {\n      id\n      progressPercentage\n      checkpoints {\n        id\n        completed\n      }\n    }\n  }\n"]))),Jt=(0,D.J1)(Nt||(Nt=(0,c.A)(["\n  query GetCalendarTags($calendarId: String!) {\n    calendarTags(calendarId: $calendarId) {\n      id\n      name\n      color\n      description\n      usageCount\n    }\n  }\n"]))),qt=(0,D.J1)(Pt||(Pt=(0,c.A)(["\n  mutation UpdateEvent($id: String!, $input: CalendarEventInput!) {\n    updateEvent(id: $id, input: $input) {\n      id\n      title\n      startTime\n      endTime\n    }\n  }\n"]))),Yt=()=>{var e,t,n,o,i,r;const{id:a}=(0,k.g)(),{colorMode:l}=((0,k.Zp)(),(0,u.G6)()),[s,c]=((0,h.d)(),(0,z.ok)()),D=(0,g.createRef)(),F=(0,g.useMemo)(()=>{const e=s.get("calendars");return e?e.split(",").filter(Boolean):a?[a]:[]},[a,s]),$=F.length>1,_=(0,P.oU)("background.main",l),V=(0,P.oU)("background.cardGradient",l),H=(0,P.oU)("border.darkCard",l),L=(0,P.oU)("light"===l?"text.primary":"text.primaryDark",l),U=(0,P.oU)("light"===l?"text.secondary":"text.secondaryDark",l),B=(0,P.oU)("primary",l),J=(0,P.oU)("primaryHover",l),[q,Y]=(0,g.useState)((()=>{const e=s.get("view");return["dayGridMonth","timeGridWeek","timeGridDay"].includes(e||"")?e:"dayGridMonth"})()),[K,Z]=(0,g.useState)((()=>{const e=s.get("date");if(e){const t=new Date(e);return isNaN(t.getTime())?new Date:t}return new Date})()),[X,Q]=(0,g.useState)(window.innerWidth<768),[ee,te]=(0,g.useState)((()=>{const e=s.get("hours");return!e||"24"===e})()),[ne,oe]=(0,g.useState)([]),[ie,re]=(0,g.useState)(!1),[ae,le]=(0,g.useState)(null),{selectedEvent:se,setSelectedEvent:de,isEventModalOpen:ce,setIsEventModalOpen:ge,isCreateModalOpen:ue,setIsCreateModalOpen:he,newEventDate:pe,setNewEventDate:me,selectedTimeRange:xe,setSelectedTimeRange:ve,isICalModalOpen:be,setIsICalModalOpen:fe,selectedICalInvite:je,setSelectedICalInvite:Ce,isGoalsModalOpen:Ee,setIsGoalsModalOpen:Ie,openCreateModal:ye,openEditModal:we,openICalModal:Te}=(()=>{const[e,t]=(0,g.useState)(null),[n,o]=(0,g.useState)(!1),[i,r]=(0,g.useState)(!1),[a,l]=(0,g.useState)(""),[s,d]=(0,g.useState)(null),[c,u]=(0,g.useState)(!1),[h,p]=(0,g.useState)(null),[m,x]=(0,g.useState)(!1),[v,b]=(0,g.useState)(!1);return{selectedEvent:e,setSelectedEvent:t,isEventModalOpen:n,setIsEventModalOpen:o,isCreateModalOpen:i,setIsCreateModalOpen:r,newEventDate:a,setNewEventDate:l,selectedTimeRange:s,setSelectedTimeRange:d,isICalModalOpen:c,setIsICalModalOpen:u,selectedICalInvite:h,setSelectedICalInvite:p,isGoalsModalOpen:m,setIsGoalsModalOpen:x,isExternalCalendarModalOpen:v,setIsExternalCalendarModalOpen:b,openCreateModal:(e,t)=>{e?(l(e),d(null)):t&&(d(t),l("")),r(!0)},openEditModal:e=>{t(e),o(!0)},openICalModal:e=>{p(e),u(!0)},closeAllModals:()=>{r(!1),o(!1),u(!1),x(!1),b(!1),t(null),l(""),d(null),p(null)}}})(),[ke,De]=(0,g.useState)(!1),[Ae,Re]=(0,g.useState)(null),[Me,Ge]=(0,g.useState)(new Set),[Oe,Ne]=(0,g.useState)(new Map),{isManualScrollRef:Pe,handleScrollToNow:We}=ct({calendarId:a,currentView:q,isPreservingView:ke,calendarRef:D}),Fe=(0,g.useMemo)(()=>{const e=new Date;return e.setMonth(e.getMonth()-3),e.toISOString()},[]),$e=(0,g.useMemo)(()=>{const e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString()},[]),{loading:_e,error:Ve,data:He}=(0,A.IT)($?Wt:Ft,{variables:$?{ids:F}:{id:F[0]},skip:0===F.length,context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}},onCompleted:e=>{const t=new Map,n=$?e.getCalendarsByIds:[e.calendar],o=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316"];null===n||void 0===n||n.forEach((e,n)=>{e&&t.set(e.id,e.color||o[n%o.length])}),Ne(t)}}),Le=_e,Ue=Ve,Je=He,qe=$?null===He||void 0===He||null===(e=He.getCalendarsByIds)||void 0===e?void 0:e[0]:null===He||void 0===He?void 0:He.calendar;(0,lt.r)(N.calendarsModuleConfig,null!==qe&&void 0!==qe&&qe.name?"".concat(qe.name," - Calendar"):$?"Multi-Calendar View":void 0);const{data:Ye,refetch:Ke}=(0,A.IT)(Jt,{variables:{calendarId:F[0]},skip:0===F.length||$,context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}},fetchPolicy:"cache-and-network"}),{loading:Ze,error:Xe,data:Qe,refetch:et}=(0,A.IT)($?_t:Vt,{variables:$?{calendarIds:F,startDate:Fe,endDate:$e}:{calendarId:F[0],startDate:Fe,endDate:$e},skip:0===F.length,context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),{data:tt}=(0,A.IT)($t,{variables:{calendarId:F[0],tenantId:localStorage.getItem("tenantId")||""},skip:0===F.length||$,context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),{data:nt,refetch:ot}=(0,A.IT)(Ht,{variables:{calendarId:F[0]},skip:0===F.length||$,context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),{data:it}=(0,A.IT)(Lt,{skip:0===F.length||$,context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),{data:rt,refetch:st}=(0,A.IT)(Ut,{context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),[dt]=(0,R.n)(Bt,{onCompleted:()=>{ot()},context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}}}),[ut]=(0,R.n)(qt,{context:{headers:{"x-tenant-id":localStorage.getItem("tenantId")||""}},onCompleted:()=>{console.log("\u2705 Event updated successfully")},onError:e=>{console.error("\u274c Failed to update event:",e),alert("Failed to move event. Please try again."),et()}}),{activeEventFilters:pt,setActiveEventFilters:mt,activeTagFilters:xt,setActiveTagFilters:vt,filteredEvents:bt}=(e=>{let{eventsData:t,tagsData:n,isMultiCalendar:o,calendarColorMap:i}=e;const[r,a]=(0,g.useState)(new Set),[l,s]=(0,g.useState)(new Set),d=(0,g.useMemo)(()=>{const e=o?null===t||void 0===t?void 0:t.multiCalendarEvents:null===t||void 0===t?void 0:t.calendarEvents;if(!e)return[];console.log("\ud83d\udcc5 Transforming events:",e.length),console.log("\ud83d\udcca Active filters:",Array.from(r)),console.log("\ud83c\udff7\ufe0f Active tag filters:",Array.from(l)),console.log("\ud83c\udfa8 Available tags:",null===n||void 0===n?void 0:n.calendarTags);const a=new Map;null!==n&&void 0!==n&&n.calendarTags&&n.calendarTags.forEach(e=>{a.set(e.name,e.color)}),console.log("\ud83c\udfa8 Tag color map:",Object.fromEntries(a));const s=e.filter(e=>!e.isCancelled).map(e=>{let t=e.color||"#3B82F6";if(o&&e.calendarId&&(t=i.get(e.calendarId)||t),e.categories&&e.categories.length>0){const n=e.categories[0],o=a.get(n);o?(t=o,console.log('\ud83c\udfa8 Event "'.concat(e.title,'" with tag "').concat(n,'" gets color: ').concat(o))):console.log('\u26a0\ufe0f Event "'.concat(e.title,'" has tag "').concat(n,'" but no color found in map'))}return{id:e.id,title:e.title,start:e.startTime,end:e.endTime,allDay:e.isAllDay,backgroundColor:t,borderColor:t,extendedProps:{description:e.description,status:e.status,location:e.location,attendees:e.attendees,isInboundICalInvite:e.isInboundICalInvite,iCalMethod:e.iCalMethod,iCalResponseStatus:e.iCalResponseStatus,iCalOrganizerName:e.iCalOrganizerName,iCalOrganizerEmail:e.iCalOrganizerEmail,metadata:e.metadata,reminders:e.reminders,categories:e.categories||[],calendarId:e.calendarId}}}),d=r.size>0;return s.filter(e=>{var t,n,o,i,a,s,c,g,u,h,p;const m=null===(t=e.extendedProps)||void 0===t||null===(n=t.metadata)||void 0===n?void 0:n["X-EVENT-TYPE"],x=!(null!==(o=e.extendedProps)&&void 0!==o&&o.isInboundICalInvite)&&(!m||"PUBLIC_BOOKING"===m),v=null===(i=e.extendedProps)||void 0===i?void 0:i.isInboundICalInvite,b="ICAL_INVITE"===m,f="SMS_BROADCAST"===m,S=(null===(a=e.extendedProps)||void 0===a||null===(s=a.attendees)||void 0===s?void 0:s.length)>0,j=(null===(c=e.extendedProps)||void 0===c||null===(g=c.reminders)||void 0===g?void 0:g.length)>0,C=e.allDay;console.log('\ud83d\udd0d Filtering event "'.concat(e.title,'":'),{isStandard:x,isInboundICal:v,isOutboundICal:b,isSMSBroadcast:f,isMeeting:S,hasReminders:j,isAllDay:C,metadata:null===(u=e.extendedProps)||void 0===u?void 0:u.metadata,activeFilters:Array.from(r),shouldFilterByType:d});const E=!d||x&&r.has("standard")||v&&r.has("ical_inbound")||b&&r.has("ical_outbound")||f&&r.has("sms_broadcast")||S&&r.has("meeting")||j&&r.has("reminder")||C&&r.has("all_day");console.log("  \u2192 passesTypeFilter: ".concat(E));const I=(null===(h=e.extendedProps)||void 0===h?void 0:h.categories)||[],y=0===l.size||I.some(e=>l.has(e));return l.size>0&&null!==(p=e.title)&&void 0!==p&&p.includes("poker")&&console.log("\ud83c\udfaf Debug poker event:",{title:e.title,eventTags:I,activeTagFilters:Array.from(l),passesTagFilter:y,passesTypeFilter:E}),E&&y})},[t,r,l,n,o,i]);return{activeEventFilters:r,setActiveEventFilters:a,activeTagFilters:l,setActiveTagFilters:s,filteredEvents:d}})({eventsData:Qe,tagsData:Ye,isMultiCalendar:$,calendarColorMap:Oe}),{handleDatesSet:Et,handleDateClick:It,handleSelect:yt,handleEventDrop:Tt,handleEventResize:kt,handleEventClick:zt}=(e=>{let{currentView:t,calendarRef:n,eventsData:o,isMultiCalendar:i,calendarIds:r,updateEvent:a,setNewEventDate:l,setSelectedTimeRange:s,setIsCreateModalOpen:d,setSelectedEvent:c,setIsEventModalOpen:g,setSelectedICalInvite:u,setIsICalModalOpen:h}=e;return{handleDatesSet:e=>{},handleDateClick:e=>{if("dayGridMonth"===t){const t=e.dateStr||e.date.toISOString();l(t),s(null),d(!0),console.log("\ud83d\udcc5 Date clicked for new event:",t)}},handleSelect:e=>{var t;console.log("\u23f0 Time range selected:",{start:e.start,end:e.end,view:e.view.type,allDay:e.allDay});const o=!0===e.allDay,i=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(o,"T").concat(i,":").concat(r)};s({start:i(e.start),end:i(e.end),isAllDay:o}),l(""),d(!0);const r=null===(t=n.current)||void 0===t?void 0:t.getApi();r&&r.unselect()},handleEventDrop:async e=>{var t,n,l;console.log("\ud83d\udcc5 Event dropped:",{event:e.event.title,newStart:e.event.start,newEnd:e.event.end,oldEvent:e.oldEvent,allDay:e.event.allDay});const s=i?null===o||void 0===o?void 0:o.multiCalendarEvents:null===o||void 0===o?void 0:o.calendarEvents,d=null===s||void 0===s?void 0:s.find(t=>t.id===e.event.id);if(!d)return console.error("Event not found in data"),void e.revert();const c={calendarId:d.calendarId||r[0],title:d.title,description:d.description,startTime:e.event.start.toISOString(),endTime:e.event.end?e.event.end.toISOString():e.event.start.toISOString(),isAllDay:e.event.allDay,location:(null===(t=d.location)||void 0===t?void 0:t.address)||(null===(n=d.location)||void 0===n?void 0:n.name),status:d.status,visibility:d.visibility,categories:d.categories||[],attendees:(null===(l=d.attendees)||void 0===l?void 0:l.map(e=>({clientId:e.clientId,email:e.email,name:e.name,role:e.role||"REQ_PARTICIPANT",status:e.status||"NEEDS_ACTION",isOrganizer:e.isOrganizer||!1,rsvpRequired:e.rsvpRequired||!1})))||[],reminders:d.reminders||[],metadata:d.metadata||{}};try{await a({variables:{id:e.event.id,input:c}}),console.log("\u2705 Event moved successfully")}catch(g){console.error("\u274c Failed to update event:",g),e.revert()}},handleEventResize:async e=>{var t,n,l;console.log("\ud83d\udcc5 Event resized:",{event:e.event.title,newStart:e.event.start,newEnd:e.event.end,oldEvent:e.oldEvent});const s=i?null===o||void 0===o?void 0:o.multiCalendarEvents:null===o||void 0===o?void 0:o.calendarEvents,d=null===s||void 0===s?void 0:s.find(t=>t.id===e.event.id);if(!d)return console.error("Event not found in data"),void e.revert();const c={calendarId:d.calendarId||r[0],title:d.title,description:d.description,startTime:e.event.start.toISOString(),endTime:e.event.end?e.event.end.toISOString():e.event.start.toISOString(),isAllDay:e.event.allDay,location:(null===(t=d.location)||void 0===t?void 0:t.address)||(null===(n=d.location)||void 0===n?void 0:n.name),status:d.status,visibility:d.visibility,categories:d.categories||[],attendees:(null===(l=d.attendees)||void 0===l?void 0:l.map(e=>({clientId:e.clientId,email:e.email,name:e.name,role:e.role||"REQ_PARTICIPANT",status:e.status||"NEEDS_ACTION",isOrganizer:e.isOrganizer||!1,rsvpRequired:e.rsvpRequired||!1})))||[],reminders:d.reminders||[],metadata:d.metadata||{}};try{await a({variables:{id:e.event.id,input:c}}),console.log("\u2705 Event resized successfully")}catch(g){console.error("\u274c Failed to resize event:",g),e.revert()}},handleEventClick:e=>{var t;const n=e.event;console.log("\ud83d\udcc5 Calendar event clicked:",{id:n.id,title:n.title,start:n.start,end:n.end,description:n.extendedProps.description,isInboundICalInvite:n.extendedProps.isInboundICalInvite,iCalMethod:n.extendedProps.iCalMethod});const i=null===o||void 0===o||null===(t=o.calendarEvents)||void 0===t?void 0:t.find(e=>e.id===n.id);if(console.log("\ud83d\udd0d Full event data from query:",i),i)if(i.isInboundICalInvite){var a,l;const e={id:i.id,title:i.title,description:i.description,startDateTime:i.startTime,endDateTime:i.endTime,location:(null===(a=i.location)||void 0===a?void 0:a.address)||(null===(l=i.location)||void 0===l?void 0:l.name),iCalMethod:i.iCalMethod,iCalOrganizerEmail:i.iCalOrganizerEmail,iCalOrganizerName:i.iCalOrganizerName,iCalResponseStatus:i.iCalResponseStatus,iCalReceivedAt:i.iCalReceivedAt,iCalSequence:i.iCalSequence,isInboundICalInvite:i.isInboundICalInvite,categories:i.categories||[],calendarId:i.calendarId||r[0]};u(e),h(!0)}else{var s;const e={id:i.id,title:i.title,description:i.description,startTime:i.startTime,endTime:i.endTime,allDay:i.isAllDay,location:(null===(s=i.location)||void 0===s?void 0:s.name)||"",status:i.status,color:i.color,attendees:i.attendees||[],metadata:i.metadata,visibility:i.visibility,reminders:i.reminders,categories:i.categories||[]};c(e),g(!0)}}}})({currentView:q,calendarRef:D,eventsData:Qe,isMultiCalendar:$,calendarIds:F,updateEvent:ut,setNewEventDate:me,setSelectedTimeRange:ve,setIsCreateModalOpen:he,setSelectedEvent:de,setIsEventModalOpen:ge,setSelectedICalInvite:Ce,setIsICalModalOpen:fe}),Dt=e=>{if(!e||0===e.length)return 0;const t=e.filter(e=>e.completed).length;return Math.round(t/e.length*100)};(0,g.useEffect)(()=>{if(null!==nt&&void 0!==nt&&nt.currentMonthGoals){const e=nt.currentMonthGoals.map(e=>(0,d.A)((0,d.A)({},e),{},{progressPercentage:Dt(e.checkpoints||[])}));oe(e)}},[nt]),(0,g.useEffect)(()=>{var e;if(ke)return;const t=null===(e=D.current)||void 0===e?void 0:e.getApi(),n=null===Je||void 0===Je?void 0:Je.calendar;if(t&&n){const e=s.get("view");if(e&&["dayGridMonth","timeGridWeek","timeGridDay"].includes(e)&&(t.changeView(e),"timeGridWeek"===e||"timeGridDay"===e)){const e=new Date;setTimeout(()=>{const n=new Date(e.getTime()-72e5);t.scrollToTime(n.toTimeString().slice(0,8))},200)}const n=s.get("date");if(n){const e=new Date(n);isNaN(e.getTime())||t.gotoDate(e)}}},[Je,ke]),(0,g.useEffect)(()=>{const e=()=>{Q(window.innerWidth<768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,g.useEffect)(()=>{const e=()=>{console.log("\ud83d\udd04 Window focused, refetching tags..."),Ke&&Ke()};window.addEventListener("focus",e);const t=setInterval(()=>{console.log("\ud83d\udd04 Periodic tag refresh..."),Ke&&Ke()},3e4);return()=>{window.removeEventListener("focus",e),clearInterval(t)}},[Ke]);const At=e=>{const t=new URLSearchParams(s);void 0!==e.view&&t.set("view",e.view),void 0!==e.date&&t.set("date",e.date),void 0!==e.hours&&("business"===e.hours?t.delete("hours"):t.set("hours",e.hours)),c(t)},{handlePrevious:Rt,handleNext:Mt,handleToday:Gt,handleViewChange:Ot}=(e=>{let{currentView:t,calendarRef:n,setCurrentDate:o,setCurrentView:i,updateUrlParams:r,is24HourView:a}=e;return{handlePrevious:()=>{var e;const i=null===(e=n.current)||void 0===e?void 0:e.getApi();if(i){let e=null;if("timeGridWeek"===t||"timeGridDay"===t){const t=document.querySelector(".fc-scroller-liquid-absolute");if(t){const n=t.scrollTop,o=Math.floor(n/60),i=Math.floor(n%60*60/60);e="".concat(String(o).padStart(2,"0"),":").concat(String(i).padStart(2,"0"),":00")}}i.prev();const n=i.getDate();o(n),r({date:n.toISOString().split("T")[0]}),!e||"timeGridWeek"!==t&&"timeGridDay"!==t||setTimeout(()=>{i.scrollToTime(e)},100)}},handleNext:()=>{var e;const i=null===(e=n.current)||void 0===e?void 0:e.getApi();if(i){let e=null;if("timeGridWeek"===t||"timeGridDay"===t){const t=document.querySelector(".fc-scroller-liquid-absolute");if(t){const n=t.scrollTop,o=Math.floor(n/60),i=Math.floor(n%60*60/60);e="".concat(String(o).padStart(2,"0"),":").concat(String(i).padStart(2,"0"),":00")}}i.next();const n=i.getDate();o(n),r({date:n.toISOString().split("T")[0]}),!e||"timeGridWeek"!==t&&"timeGridDay"!==t||setTimeout(()=>{i.scrollToTime(e)},100)}},handleToday:()=>{var e;const i=null===(e=n.current)||void 0===e?void 0:e.getApi();if(i){i.today();const e=new Date;o(e),r({date:e.toISOString().split("T")[0]}),"timeGridWeek"!==t&&"timeGridDay"!==t||setTimeout(()=>{const t=new Date(e.getTime()-72e5);i.scrollToTime(t.toTimeString().slice(0,8))},200)}},handleViewChange:e=>{var t;const l=null===(t=n.current)||void 0===t?void 0:t.getApi();if(l){const t=new Date;l.gotoDate(t),l.changeView(e),i(e),o(t),r({view:e,date:t.toISOString().split("T")[0],hours:a?"24":"business"})}}}})({currentView:q,calendarRef:D,setCurrentDate:Z,setCurrentView:Y,updateUrlParams:At,is24HourView:ee});return Le||Ze?(0,Se.jsxs)(p.a,{bg:_,minH:"100vh",display:"flex",flexDirection:"column",children:[!ie&&(0,Se.jsx)(M.m,{}),!ie&&(0,Se.jsx)(O.y,{moduleConfig:N.calendarsModuleConfig}),(0,Se.jsx)(m.m,{maxW:"container.xl",py:8,flex:"1",children:(0,Se.jsxs)(x.T,{spacing:4,align:"center",justify:"center",minH:"400px",children:[(0,Se.jsx)(v.y,{size:"xl",color:B}),(0,Se.jsxs)(b.E,{color:U,children:["Loading calendar",$?"s":"","..."]})]})}),(0,Se.jsx)(G.n,{})]}):Ue||Xe||!$&&(null===Je||void 0===Je||!Je.calendar)||$&&(null===He||void 0===He||!He.getCalendarsByIds||0===He.getCalendarsByIds.length)?(0,Se.jsxs)(p.a,{bg:_,minH:"100vh",display:"flex",flexDirection:"column",children:[!ie&&(0,Se.jsx)(M.m,{}),!ie&&(0,Se.jsx)(O.y,{moduleConfig:N.calendarsModuleConfig}),(0,Se.jsx)(m.m,{maxW:"container.xl",py:8,flex:"1",children:(0,Se.jsxs)(f.F,{status:"error",borderRadius:"md",children:[(0,Se.jsx)(S._,{}),(0,Se.jsx)(b.E,{children:(null===Ue||void 0===Ue?void 0:Ue.message)||(null===Xe||void 0===Xe?void 0:Xe.message)||"Calendar(s) not found"})]})}),(0,Se.jsx)(G.n,{})]}):(console.log("\ud83d\udcca Calendar(s) loaded:",$?null===He||void 0===He||null===(t=He.getCalendarsByIds)||void 0===t?void 0:t.length:1),console.log("\ud83d\udcc5 Events loaded:",bt.length),(0,Se.jsxs)(p.a,{bg:_,minH:"100vh",display:"flex",flexDirection:"column",children:[!ie&&(0,Se.jsx)(M.m,{}),!ie&&(0,Se.jsx)(O.y,{moduleConfig:N.calendarsModuleConfig}),(0,Se.jsx)(m.m,{maxW:"100%",py:{base:1,md:2},px:{base:2,md:4},flex:"1",children:(0,Se.jsxs)(x.T,{spacing:6,align:"stretch",children:[(0,Se.jsx)(ht,{currentDate:K,secondaryTimezone:Ae,getTimeInSecondaryTimezone:ft,showGoals:ie,setShowGoals:re,setSelectedEvent:de,setIsEventModalOpen:ge,cardGradientBg:V,cardBorder:H,textSecondary:U,primaryColor:B}),ie&&(0,Se.jsx)(Ct,{currentDate:K,localGoals:ne,clientsData:it,selectedGoalId:ae,setSelectedGoalId:le,setIsGoalsModalOpen:Ie,handleToggleCheckpoint:(e,t,n)=>{oe(o=>o.map(o=>{if(o.id===e){const e=o.checkpoints.map(e=>e.id===t?(0,d.A)((0,d.A)({},e),{},{completed:n}):e);return(0,d.A)((0,d.A)({},o),{},{checkpoints:e,progressPercentage:Dt(e)})}return o})),dt({variables:{input:{goalId:e,checkpointId:t,completed:n}}})},cardGradientBg:V,cardBorder:H,textPrimary:L,textSecondary:U,primaryColor:B}),(0,Se.jsx)(j.Z,{bg:V,backdropFilter:"blur(10px)",border:"1px solid",borderColor:H,children:(0,Se.jsx)(C.b,{children:(0,Se.jsxs)(x.T,{spacing:4,children:[(0,Se.jsx)(wt,{currentView:q,currentDate:K,isMultiCalendar:$,calendarIds:F,calendar:qe,calendarsData:He,linkedEmailData:tt,filteredEvents:bt,calendarColorMap:Oe,is24HourView:ee,handleToday:Gt,handleScrollToNow:We,handlePrevious:Rt,handleNext:Mt,handleViewChange:Ot,setIs24HourView:te,updateUrlParams:At,textPrimary:L,textSecondary:U,primaryColor:B,primaryHover:J,cardBorder:H}),(0,Se.jsxs)(E.z,{align:"stretch",spacing:0,width:"100%",children:[Ae&&("timeGridWeek"===q||"timeGridDay"===q)&&(0,Se.jsxs)(p.a,{bg:"rgba(0, 0, 0, 0.3)",borderRadius:"lg 0 0 lg",borderRight:"2px solid",borderColor:"rgba(54, 158, 255, 0.2)",minW:"80px",position:"relative",children:[(0,Se.jsx)(p.a,{height:"40px",display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid",borderColor:"rgba(54, 158, 255, 0.2)",bg:"rgba(54, 158, 255, 0.1)",children:(0,Se.jsx)(b.E,{fontSize:"xs",fontWeight:"600",color:"cyan.400",children:St(Ae)})}),(0,Se.jsx)(p.a,{mt:"60px",children:jt(Ae,qe,ee)})]}),(0,Se.jsx)(p.a,{flex:"1",bg:"rgba(255, 255, 255, 0.03)",borderRadius:!Ae||"timeGridWeek"!==q&&"timeGridDay"!==q?"lg":"0 lg lg 0",p:{base:2,md:4},overflow:"visible",sx:(0,d.A)({".fc":{fontFamily:P.Kk.fonts.body},".fc-toolbar-title":{color:L,fontSize:{base:"md",md:"xl"},fontWeight:"bold"},"@media (max-width: 768px)":{".fc-daygrid-day-frame":{minHeight:"50px"},".fc-daygrid-event":{fontSize:"0.65rem",padding:"0px 2px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".fc-daygrid-day-number":{fontSize:"0.7rem",padding:"2px"},".fc-daygrid-more-link":{fontSize:"0.65rem"},".fc-timegrid":{fontSize:"0.75rem"},".fc-timegrid-slot-label":{fontSize:"0.75rem",padding:"2px 4px",fontWeight:"500"},".fc-timegrid-slot-label-cushion":{fontSize:"0.75rem"},".fc-timegrid-event":{fontSize:"0.7rem",padding:"2px 4px",borderRadius:"3px"},".fc-timegrid-event .fc-event-title":{fontSize:"0.7rem",fontWeight:"600",overflow:"visible",whiteSpace:"normal",wordBreak:"break-word"},".fc-timegrid-event .fc-event-time":{fontSize:"0.65rem",display:"block",marginBottom:"2px"},".fc-timegrid-event-harness":{marginRight:"1px",marginLeft:"1px"},".fc-timegrid-axis":{width:"45px"},".fc-timegrid-axis-cushion":{fontSize:"0.7rem",padding:"0 2px"},".fc-timeGridWeek-view .fc-col-header-cell-cushion":{fontSize:"0.7rem",padding:"4px 2px",fontWeight:"600"},".fc-timeGridWeek-view .fc-daygrid-day-top":{fontSize:"0.75rem"},".fc-timeGridWeek-view .fc-timegrid-col":{minWidth:"50px"},".fc-timeGridWeek-view .fc-timegrid-now-indicator-arrow":{display:"none"},".fc-timeGridWeek-view .fc-timegrid-slots":{fontSize:"0.75rem"},".fc-timeGridWeek-view .fc-timegrid-slot":{height:"40px"},".fc-timeGridDay-view .fc-timegrid-slot-label":{fontSize:"0.7rem"},".fc-timeGridDay-view .fc-timegrid-event":{fontSize:"0.75rem",padding:"4px"},".fc-timeGridDay-view .fc-timegrid-axis":{width:"40px"},".fc-timeGridDay-view .fc-col-header":{fontSize:"0.8rem",fontWeight:"bold"},".fc-timeGridDay-view .fc-timegrid-col":{minWidth:"auto"},".fc-timeGridDay-view .fc-event-title":{fontSize:"0.75rem",fontWeight:"500"},".fc-timeGridDay-view .fc-event-time":{fontSize:"0.65rem"},".fc-event":{fontSize:"0.7rem",borderRadius:"2px"},".fc-event-title":{fontWeight:"normal"},".fc-col-header-cell":{fontSize:"0.7rem",padding:"4px 2px",fontWeight:"600"},".fc-scrollgrid":{fontSize:"0.85rem"},".fc-more-popover":{fontSize:"0.75rem",maxWidth:"200px"},".fc-now-indicator":{borderWidth:"1px"}},".fc-col-header-cell":{backgroundColor:"rgba(59, 130, 246, 0.1)",color:"#000000",fontWeight:"600",borderColor:H},".fc-col-header-cell-cushion":{color:"#000000",fontWeight:"600"},".fc-daygrid-day":{backgroundColor:"transparent",borderColor:H},".fc-daygrid-day-number":{color:L},".fc-daygrid-day.fc-day-today":{backgroundColor:"rgba(59, 130, 246, 0.2)",border:"2px solid",borderColor:B},".fc-daygrid-day.fc-day-today .fc-daygrid-day-number":{backgroundColor:B,color:"white",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",margin:"2px"},".fc-daygrid-event":{borderRadius:"4px",padding:"2px 4px"},".fc-timegrid-slot":{borderColor:H},".fc-timegrid-slot-label":{color:U},".fc-event":{cursor:"pointer",transition:"all 0.2s"},".fc-event:hover":{transform:"scale(1.02)",boxShadow:"0 4px 12px rgba(0,0,0,0.2)"},".fc-button":{display:"none"},".fc-toolbar":{display:"none"},".fc-scrollgrid":{borderColor:H},".fc-theme-standard td, .fc-theme-standard th":{borderColor:H},".fc-highlight":{background:"rgba(59, 130, 246, 0.2)",border:"2px solid rgba(59, 130, 246, 0.5)"}},ee&&{".fc-timegrid-slot":{height:"25px !important",minHeight:"25px !important"},".fc-timegrid-slot-lane":{height:"25px !important"},".fc-timegrid-col.fc-day":{minHeight:"600px !important"},'.fc-timegrid-slot[data-time^="00:"], .fc-timegrid-slot[data-time^="01:"], .fc-timegrid-slot[data-time^="02:"], .fc-timegrid-slot[data-time^="03:"], .fc-timegrid-slot[data-time^="04:"], .fc-timegrid-slot[data-time^="05:"], .fc-timegrid-slot[data-time^="06:"], .fc-timegrid-slot[data-time^="21:"], .fc-timegrid-slot[data-time^="22:"], .fc-timegrid-slot[data-time^="23:"]':{backgroundColor:"rgba(0, 0, 0, 0.03)"}}),children:(0,Se.jsx)(I.A,{ref:D,plugins:[T.A,y.A,w.Ay],initialView:q,initialDate:K.toISOString().split("T")[0],headerToolbar:!1,events:bt,eventClick:zt,dateClick:It,datesSet:Et,eventContent:e=>(0,Se.jsx)(gt,{eventContent:e,isMultiCalendar:$,calendarsData:He}),height:"auto",slotMinTime:ee?"00:00":X?"07:00":(null===qe||void 0===qe||null===(n=qe.settings)||void 0===n?void 0:n.workingHoursStart)||"08:00",slotMaxTime:ee?"24:00":X?"20:00":(null===qe||void 0===qe||null===(o=qe.settings)||void 0===o?void 0:o.workingHoursEnd)||"18:00",firstDay:1,nowIndicator:!0,eventDisplay:"block",dayMaxEvents:X?2:3,moreLinkText:X?"+":"more",slotDuration:"timeGridDay"===q||"timeGridWeek"===q?"00:10:00":"00:30:00",slotLabelInterval:X?"02:00":"01:00",snapDuration:"00:10:00",selectable:"timeGridWeek"===q||"timeGridDay"===q,selectMirror:!0,select:yt,unselectAuto:!1,editable:!0,droppable:!0,eventDrop:Tt,eventResize:kt,eventResizableFromStart:!0,slotLabelFormat:{hour:"numeric",minute:"2-digit",hour12:!X},expandRows:!0,stickyHeaderDates:!X,allDaySlot:!X||"timeGridWeek"!==q,eventMinHeight:X?25:20,slotEventOverlap:!0,eventOverlap:!0,eventMaxStack:$?4:2,businessHours:{daysOfWeek:[1,2,3,4,5],startTime:(null===qe||void 0===qe||null===(i=qe.settings)||void 0===i?void 0:i.workingHoursStart)||"09:00",endTime:(null===qe||void 0===qe||null===(r=qe.settings)||void 0===r?void 0:r.workingHoursEnd)||"17:00"}})})]})]})})})]})}),(0,Se.jsx)(at,{events:bt,calendarId:F[0]||"",onFilterChange:mt,onTimezoneChange:Re,onTagFilterChange:vt}),ce&&(0,Se.jsx)(W.A,{isOpen:ce,onClose:()=>{ge(!1),de(null)},onSuccess:async()=>{var e;De(!0);const t=null===(e=D.current)||void 0===e?void 0:e.getApi(),n=(null===t||void 0===t?void 0:t.view.type)||q,o=(null===t||void 0===t?void 0:t.getDate())||K,i=ee,r=window.scrollY,a=window.scrollX;let l=null;if("timeGridWeek"===n||"timeGridDay"===n){const e=document.querySelector(".fc-scroller-liquid-absolute");if(e){const t=e.scrollTop,n=Math.floor(t/60),o=Math.floor(t%60*60/60);l="".concat(String(n).padStart(2,"0"),":").concat(String(o).padStart(2,"0"),":00")}}ge(!1),de(null),await et(),setTimeout(()=>{var e;const t=null===(e=D.current)||void 0===e?void 0:e.getApi();t&&(t.changeView(n),t.gotoDate(o),Y(n),Z(o),te(i),!l||"timeGridWeek"!==n&&"timeGridDay"!==n||t.scrollToTime(l),window.scrollTo(a,r)),setTimeout(()=>De(!1),500)},200)},calendarId:F[0]||"",event:se}),ue&&(0,Se.jsx)(W.A,{isOpen:ue,onClose:()=>{he(!1),me(""),ve(null)},onSuccess:async()=>{var e;De(!0);const t=null===(e=D.current)||void 0===e?void 0:e.getApi(),n=(null===t||void 0===t?void 0:t.view.type)||q,o=(null===t||void 0===t?void 0:t.getDate())||K,i=ee,r=window.scrollY,a=window.scrollX;let l=null;if("timeGridWeek"===n||"timeGridDay"===n){const e=document.querySelector(".fc-scroller-liquid-absolute");if(e){const t=e.scrollTop,n=Math.floor(t/60),o=Math.floor(t%60*60/60);l="".concat(String(n).padStart(2,"0"),":").concat(String(o).padStart(2,"0"),":00")}}he(!1),me(""),ve(null),await et(),setTimeout(()=>{var e;const t=null===(e=D.current)||void 0===e?void 0:e.getApi();t&&(t.changeView(n),t.gotoDate(o),Y(n),Z(o),te(i),!l||"timeGridWeek"!==n&&"timeGridDay"!==n||t.scrollToTime(l),window.scrollTo(a,r)),setTimeout(()=>De(!1),500)},200)},calendarId:F[0]||"",initialDate:pe,initialTimeRange:xe||void 0}),Ee&&(0,Se.jsx)(ze,{isOpen:Ee,onClose:()=>{Ie(!1),le(null),ot()},calendarId:F[0]||"",currentMonth:K,initialGoalId:ae}),be&&je&&(0,Se.jsx)(Be,{isOpen:be,onClose:()=>{fe(!1),Ce(null)},event:je,onRefresh:()=>{et()}})]}))}}}]);
//# sourceMappingURL=1934.b34efa29.chunk.js.map