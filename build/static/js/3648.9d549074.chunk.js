"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[3648],{43648:(e,r,o)=>{o.r(r),o.d(r,{default:()=>xr});var n=o(89379),i=o(57528),t=o(65043),s=o(73216),a=o(35475),l=o(70459),d=o(10585),c=o(86011),p=o(31881);const u=(e,r)=>{const o=new Blob([e],{type:"text/markdown"}),n=URL.createObjectURL(o),i=document.createElement("a");i.href=n,i.download=r,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)};var m,g,b,h,x,f,j=o(30502),v=o(22107),y=o(98939),k=o(68659),C=o(10202),E=o(76659),w=o(39081),S=o(96148),T=o(98662),P=o(83169),I=o(26201),N=o(35699),D=o(28846),A=o(42703),z=o(87139),R=o(24330),F=o(73212),U=o(47726),$=o(19077),O=o(61724),L=o(27024),M=o(25011),_=o(57371),G=o(82459),W=o(5371),B=o(33572),Q=o(78460),K=o(11054),J=o(25722),Y=o(35929),V=o(67516),q=o(83290),H=o(17200),Z=o(52003),X=o(63295),ee=o(95214),re=o(39985),oe=o(26312),ne=o(66037),ie=o(1009),te=o(72515),se=o(99973),ae=o(58584),le=o(58797),de=o(55206),ce=o(15071),pe=o(73225),ue=o(76668),me=o(98481),ge=o(37575),be=o(2332),he=o(8987),xe=o(26424),fe=o(29066),je=o(26163),ve=o(70579);be.EA.workerSrc="//unpkg.com/pdfjs-dist@".concat(be.rE,"/build/pdf.worker.min.mjs");const ye=(0,l.J1)(m||(m=(0,i.A)(["\n  mutation CreateTask($input: TaskInput!) {\n    createTask(input: $input) {\n      id\n      description\n      status\n      projectId\n      assignedTo {\n        id\n        email\n      }\n      media {\n        url\n        description\n        fileType\n      }\n      billed\n      billable\n    }\n  }\n"]))),ke=(0,l.J1)(g||(g=(0,i.A)(["\n  mutation UpdateTask($id: ID!, $input: TaskInput!) {\n    updateTask(id: $id, input: $input) {\n      id\n      description\n      status\n      projectId\n      assignedTo {\n        id\n        email\n      }\n      media {\n        url\n        description\n        fileType\n      }\n      billed\n      billable\n    }\n  }\n"]))),Ce=(0,l.J1)(b||(b=(0,i.A)(["\n  mutation UploadFile($file: Upload!) {\n    uploadToPinata(file: $file)\n  }\n"]))),Ee=(0,l.J1)(h||(h=(0,i.A)(["\n  query GetClients {\n    clients {\n      id\n      fName\n      lName\n      email\n      businessName\n    }\n  }\n"]))),we=(0,l.J1)(x||(x=(0,i.A)(["\n  mutation ImproveDescription($text: String!, $context: String) {\n    improveDescription(text: $text, context: $context)\n  }\n"]))),Se=(0,l.J1)(f||(f=(0,i.A)(["\n  mutation ImproveTagline($text: String!, $context: String) {\n    improveTagline(text: $text, context: $context)\n  }\n"]))),Te=e=>{var r,o;let{isOpen:i,onClose:s,projectId:a,onTaskUpdated:l,existingTask:c}=e;console.log("TaskModal initialization:",{existingTask:c,isNewTask:!c});const{user:u}=(0,fe.A)(),m="6760ec476be9cc253e78285c",[g,b]=(0,t.useState)(()=>null!==c&&void 0!==c&&c.assignedTo?c.assignedTo.map(e=>e.id):null!==u&&void 0!==u&&u.id?[u.id]:[m]),[h,x]=(0,t.useState)((null===c||void 0===c?void 0:c.description)||""),[f,y]=(0,t.useState)((null===c||void 0===c?void 0:c.status)||"PENDING"),[k,E]=(0,t.useState)((null===c||void 0===c||null===(r=c.media)||void 0===r?void 0:r.map(e=>({url:(0,je.jV)(e.url),description:e.description||"",fileType:e.fileType||"image/*"})))||[]),[P,I]=(0,t.useState)((null===c||void 0===c?void 0:c.billed)||!1),[D,z]=(0,t.useState)(void 0===(null===c||void 0===c?void 0:c.billable)||c.billable),[R,L]=(0,t.useState)(!1),[M,G]=(0,t.useState)(null),W=(0,j.d)(),[q,{loading:H}]=(0,p.n)(ye),[Z,{loading:X}]=(0,p.n)(ke),[ee]=(0,p.n)(Ce),[re]=(0,p.n)(we),[oe]=(0,p.n)(Se),[ne,ie]=(0,t.useState)(!1),[te,se]=(0,t.useState)(0),{data:ae,loading:le}=(0,d.IT)(Ee),[de,be]=(0,t.useState)(null);(0,t.useEffect)(()=>{var e,r;c?(x(c.description),y(c.status),b((null===(e=c.assignedTo)||void 0===e?void 0:e.map(e=>e.id))||[]),E((null===(r=c.media)||void 0===r?void 0:r.map(e=>({url:(0,je.jV)(e.url),description:e.description||"",fileType:e.fileType||"image/*"})))||[]),I(c.billed),z(void 0===c.billable||c.billable)):(x(""),y("PENDING"),b(null!==u&&void 0!==u&&u.id?[u.id]:[m]),E([]),I(!1),z(!0));be(null)},[c,i,u]),(0,t.useEffect)(()=>{console.log("TaskModal - Component mounted or updated"),console.log("Current photos:",k),console.log("Existing task:",c)},[k,c]);const Te=()=>{x(""),y("PENDING"),b([]),E([]),I(!1),z(!0),be(null),L(!1),G(null),s()},Pe=e=>{let r=e.trim();(r.startsWith('"')&&r.endsWith('"')||r.startsWith("'")&&r.endsWith("'"))&&(r=r.slice(1,-1));const o=[/^Here is the improved [^:]*:\s*/i,/^Improved [^:]*:\s*/i,/^The improved [^:]*:\s*/i];for(const n of o)r=r.replace(n,"");return r.trim()},Ie=e=>'Please improve this task description to be an actionable, professional task in maximum 30 words. Start with action verbs like "Build", "Configure", "Implement", "Develop", "Create", "Setup", etc. Focus on WHAT needs to be done, not WHY. This is a specific task description that will be shown to the client to demonstrate concrete work being completed. Make it sound technical, specific, and valuable. Return ONLY the improved task description without any preamble, explanation, or quotes. Original description: "'.concat(e,'"'),Ne=e=>'Please improve this file description to be concise and descriptive in maximum 10 words. This describes evidence/proof of work for a task. Make it clear what the file shows. Return ONLY the improved description without any preamble, explanation, or quotes. Original description: "'.concat(e,'"'),De=(e,r)=>{var o;console.log("\ud83c\udfa8 === MEDIA RENDERING DEBUG ===",{index:r,photo:{url:e.url,fileType:e.fileType,description:e.description},normalizedUrl:(0,je.jV)(e.url),urlAnalysis:{isPDF:"application/pdf"===e.fileType||e.url.toLowerCase().includes("pdf"),isVideo:"video/mp4"===e.fileType||e.url.endsWith(".mp4"),isImage:null===(o=e.fileType)||void 0===o?void 0:o.startsWith("image/"),hasFileType:!!e.fileType,fileTypeValue:e.fileType||"NO_FILETYPE_SET"},urlPatterns:{endsWithPDF:e.url.endsWith(".pdf"),endsWithMP4:e.url.endsWith(".mp4"),endsWithJPG:e.url.endsWith(".jpg")||e.url.endsWith(".jpeg"),endsWithPNG:e.url.endsWith(".png"),endsWithGIF:e.url.endsWith(".gif"),containsIPFS:e.url.includes("ipfs"),containsGateway:e.url.includes("gateway")}});const i=(0,je.jV)(e.url);return"application/pdf"===e.fileType||e.url.toLowerCase().includes("pdf")?(console.log("\ud83d\udcc4 Rendering as PDF:",{normalizedUrl:i,fileType:e.fileType}),(0,ve.jsx)(v.a,{maxH:"100px",overflow:"hidden",cursor:"pointer",onClick:()=>be((0,n.A)((0,n.A)({},e),{},{url:i})),children:(0,ve.jsx)(he.A,{file:i,onLoadSuccess:e=>{let{numPages:o}=e;console.log("\u2705 PDF loaded successfully:",{url:i,numPages:o,index:r})},onLoadError:e=>{console.error("\u274c PDF load error:",{error:e,url:i,index:r,errorMessage:(null===e||void 0===e?void 0:e.message)||"Unknown error"})},children:(0,ve.jsx)(xe.A,{pageNumber:1,height:100,scale:.5})})})):"video/mp4"===e.fileType||e.url.endsWith(".mp4")?(console.log("\ud83c\udfa5 Rendering as VIDEO:",{normalizedUrl:i,fileType:e.fileType}),(0,ve.jsx)(v.a,{maxH:"100px",overflow:"hidden",children:(0,ve.jsx)("video",{src:i,controls:!0,style:{width:"100%",maxHeight:"100px",objectFit:"contain"},onLoadStart:()=>console.log("\ud83c\udfa5 Video load started:",{normalizedUrl:i,index:r}),onLoadedData:()=>console.log("\u2705 Video data loaded:",{normalizedUrl:i,index:r}),onError:e=>{console.error("\u274c Video load error:",{event:e,url:i,index:r,target:e.currentTarget.src})},children:"Your browser does not support the video tag."})})):(console.log("\ud83d\uddbc\ufe0f Rendering as IMAGE (default):",{normalizedUrl:i,fileType:e.fileType||"UNDEFINED",willRenderAs:"Image component"}),(0,ve.jsx)(v.a,{maxH:"100px",overflow:"hidden",children:(0,ve.jsx)(B._,{src:i,alt:"Upload ".concat(r+1),maxH:"100px",objectFit:"contain",onLoad:()=>{console.log("\u2705 Image loaded successfully:",{url:i,index:r,fileType:e.fileType})},onError:o=>{const n=o.currentTarget;console.error("\u274c IMAGE LOAD ERROR:",{url:i,originalUrl:e.url,index:r,fileType:e.fileType||"NO_FILETYPE",imgSrc:n.src,imgComplete:n.complete,imgNaturalWidth:n.naturalWidth,imgNaturalHeight:n.naturalHeight,error:o,suggestions:["Check if URL is accessible","Check CORS settings","Check if normalizeMediaUrl is working","Check network tab for 404/403 errors","Check if file actually exists at URL"]})}})}))};return(0,ve.jsxs)(Q.aF,{isOpen:i,onClose:Te,size:"xl",children:[(0,ve.jsx)(K.m,{}),(0,ve.jsxs)(J.$,{children:[(0,ve.jsx)(ce.r,{children:c?"Edit Task":"Add New Task"}),(0,ve.jsx)(Y.s,{}),(0,ve.jsx)(V.c,{pb:6,children:(0,ve.jsxs)(C.T,{spacing:4,children:[(0,ve.jsxs)(pe.MJ,{isRequired:!0,children:[(0,ve.jsxs)(S.z,{justify:"space-between",align:"center",mb:2,children:[(0,ve.jsx)(ue.l,{mb:0,children:"Description*"}),(0,ve.jsxs)(S.z,{spacing:2,children:[(0,ve.jsx)(U.m,{label:(0,ve.jsxs)(v.a,{p:2,maxW:"600px",children:[(0,ve.jsx)(w.E,{fontWeight:"bold",fontSize:"sm",mb:2,children:"AI Context:"}),(0,ve.jsx)(w.E,{fontSize:"xs",whiteSpace:"pre-wrap",children:Ie(h||"[your task description]")})]}),placement:"top",hasArrow:!0,bg:"gray.700",color:"white",children:(0,ve.jsx)(T.$,{size:"sm",variant:"outline",colorScheme:"purple",isDisabled:!h.trim(),isLoading:R,onClick:async()=>{const e=h;if(e.trim()){L(!0);try{const r=Ie(e),{data:o}=await re({variables:{text:e,context:r}});null!==o&&void 0!==o&&o.improveDescription&&(x(Pe(o.improveDescription)),W({title:"\u2728 Task description improved!",description:"Claude has enhanced your task description",status:"success",duration:3e3}))}catch(r){console.error("Error improving task description:",r),W({title:"Improvement failed",description:r instanceof Error?r.message:"Failed to improve task description. Please try again.",status:"error",duration:5e3})}finally{L(!1)}}else W({title:"No text to improve",description:"Please enter a task description first",status:"warning",duration:3e3})},leftIcon:(0,ve.jsx)(w.E,{children:"\u2728"}),children:"AI Improve"})}),(0,ve.jsx)(A.K,{"aria-label":"Copy AI context",icon:(0,ve.jsx)(w.E,{children:"\ud83d\udccb"}),size:"sm",variant:"ghost",isDisabled:!h.trim(),onClick:()=>{h.trim()&&(navigator.clipboard.writeText(Ie(h)),W({title:"AI context copied!",description:"The full context has been copied to your clipboard",status:"success",duration:2e3}))},title:"Copy AI context to clipboard"})]})]}),(0,ve.jsx)($.T,{value:h,onChange:e=>x(e.target.value),placeholder:"Enter task description (e.g., 'Build user login system') - AI will make it professional...",rows:4})]}),(0,ve.jsxs)(pe.MJ,{children:[(0,ve.jsx)(ue.l,{children:"Status"}),(0,ve.jsxs)(O.l,{value:f,onChange:e=>y(e.target.value),bg:"COMPLETED"===f||"IN_PROGRESS"===f?"green.50":"orange.50",borderColor:"COMPLETED"===f||"IN_PROGRESS"===f?"green.400":"orange.400",children:[(0,ve.jsx)("option",{value:"PENDING",style:{backgroundColor:"var(--chakra-colors-orange-50)"},children:"Pending"}),(0,ve.jsx)("option",{value:"IN_PROGRESS",style:{backgroundColor:"var(--chakra-colors-green-50)"},children:"In Progress"}),(0,ve.jsx)("option",{value:"COMPLETED",style:{backgroundColor:"var(--chakra-colors-green-50)"},children:"Completed"})]})]}),(0,ve.jsxs)(pe.MJ,{children:[(0,ve.jsx)(ue.l,{children:"Assign To"}),(0,ve.jsx)(O.l,{value:g[0]||"",onChange:e=>b(e.target.value?[e.target.value]:[]),placeholder:"Select client",isDisabled:le,children:null===ae||void 0===ae||null===(o=ae.clients)||void 0===o?void 0:o.map(e=>(0,ve.jsxs)("option",{value:e.id,children:[e.businessName?"".concat(e.businessName," - "):"",e.fName," ",e.lName," (",e.email,")",e.id===(null===u||void 0===u?void 0:u.id)?" (You)":""]},e.id))})]}),(0,ve.jsxs)(pe.MJ,{children:[(0,ve.jsx)(ue.l,{children:"Task Evidence"}),(0,ve.jsx)(N.p,{type:"file",accept:"image/*,video/mp4,application/pdf",onChange:async e=>{if(!e.target.files||!e.target.files[0])return;const r=e.target.files[0];if(["image/jpeg","image/png","image/gif","application/pdf","video/mp4"].includes(r.type)){ie(!0),se(0);try{const e=setInterval(()=>{se(r=>r>=95?(clearInterval(e),r):r+5)},100),{data:o}=await ee({variables:{file:r}});if(clearInterval(e),se(100),o.uploadToPinata){const e={url:(0,je.jV)(o.uploadToPinata),description:"",fileType:r.type};E([...k,e]),W({title:"File uploaded",status:"success",duration:3e3})}}catch(o){console.error("File upload error:",o),W({title:"Upload failed",description:o instanceof Error?o.message:"Failed to upload file",status:"error",duration:5e3})}finally{ie(!1),se(0)}}else W({title:"Invalid file type",description:"Please upload an image, PDF, or MP4 file",status:"error",duration:3e3})},disabled:ne}),(0,ve.jsx)(pe.eK,{children:"Upload images, videos, or PDFs as proof of work (screenshots, recordings, documents, etc.)"}),ne&&(0,ve.jsxs)(v.a,{mt:2,children:[(0,ve.jsxs)(w.E,{children:["Uploading... ",te.toFixed(2),"%"]}),(0,ve.jsx)(_.k,{value:te,size:"sm",colorScheme:"blue"})]})]}),k.length>0&&(0,ve.jsx)(F.r,{columns:2,spacing:4,w:"full",children:k.map((e,r)=>{var o,n;return(0,ve.jsxs)(v.a,{borderWidth:1,p:2,borderRadius:"md",position:"relative",children:[De(e,r),(0,ve.jsx)(C.T,{spacing:2,mt:2,align:"stretch",children:(0,ve.jsxs)(S.z,{spacing:2,align:"flex-start",children:[(0,ve.jsx)($.T,{size:"sm",placeholder:"File description (max 10 words)",value:e.description,onChange:e=>((e,r)=>{const o=[...k];o[e].description=r,E(o)})(r,e.target.value),flex:1,rows:2,resize:"vertical"}),(0,ve.jsxs)(C.T,{spacing:1,children:[(0,ve.jsx)(U.m,{label:(0,ve.jsxs)(v.a,{p:2,maxW:"500px",children:[(0,ve.jsx)(w.E,{fontWeight:"bold",fontSize:"sm",mb:2,children:"AI Context:"}),(0,ve.jsx)(w.E,{fontSize:"xs",whiteSpace:"pre-wrap",children:Ne(e.description||"[your file description]")})]}),placement:"top",hasArrow:!0,bg:"gray.700",color:"white",children:(0,ve.jsx)(T.$,{size:"sm",variant:"outline",colorScheme:"purple",isDisabled:!(null!==(o=e.description)&&void 0!==o&&o.trim()),isLoading:M===r,onClick:()=>(async e=>{const r=k[e].description||"";if(r.trim()){G(e);try{const o=Ne(r),{data:n}=await re({variables:{text:r,context:o}});if(null!==n&&void 0!==n&&n.improveDescription){const r=[...k];r[e].description=Pe(n.improveDescription),E(r),W({title:"\u2728 File description improved!",description:"Claude has enhanced your file description",status:"success",duration:3e3})}}catch(o){console.error("Error improving file description:",o),W({title:"Improvement failed",description:o instanceof Error?o.message:"Failed to improve file description. Please try again.",status:"error",duration:5e3})}finally{G(null)}}else W({title:"No description to improve",description:"Please enter a file description first",status:"warning",duration:3e3})})(r),minW:"auto",px:2,children:"\u2728"})}),(0,ve.jsx)(A.K,{"aria-label":"Copy AI context",icon:(0,ve.jsx)(w.E,{fontSize:"xs",children:"\ud83d\udccb"}),size:"xs",variant:"ghost",isDisabled:!(null!==(n=e.description)&&void 0!==n&&n.trim()),onClick:()=>{var r;null!==(r=e.description)&&void 0!==r&&r.trim()&&(navigator.clipboard.writeText(Ne(e.description)),W({title:"AI context copied!",description:"The file description context has been copied",status:"success",duration:2e3}))},title:"Copy AI context"})]})]})}),(0,ve.jsx)(A.K,{"aria-label":"Remove file",icon:(0,ve.jsx)(ge.U,{}),size:"sm",position:"absolute",right:2,top:2,onClick:()=>(e=>{E(k.filter((r,o)=>o!==e))})(r),bg:"red.500",color:"white",_hover:{bg:"red.600"}})]},r)})}),(0,ve.jsxs)(S.z,{spacing:6,width:"full",children:[(0,ve.jsxs)(pe.MJ,{flex:1,children:[(0,ve.jsx)(ue.l,{children:"Billable"}),(0,ve.jsx)(me.d,{isChecked:D,onChange:e=>{z(e.target.checked),e.target.checked||I(!1)},colorScheme:"green"}),(0,ve.jsx)(pe.eK,{children:"Is this task billable?"})]}),(0,ve.jsxs)(pe.MJ,{flex:1,children:[(0,ve.jsx)(ue.l,{children:"Billed"}),(0,ve.jsx)(me.d,{isChecked:P,onChange:e=>I(e.target.checked),isDisabled:!D,colorScheme:"purple"}),(0,ve.jsx)(pe.eK,{children:D?"Mark if this task has been billed":"Non-billable task"})]})]}),(0,ve.jsxs)(S.z,{spacing:4,width:"full",justify:"flex-end",children:[(0,ve.jsx)(T.$,{onClick:Te,children:"Cancel"}),(0,ve.jsx)(T.$,{colorScheme:"blue",onClick:async()=>{try{const e={description:h.trim(),projectId:a,status:f,assignedTo:g.length>0?g:void 0,media:k.length>0?k.map(e=>({url:e.url,description:e.description||void 0,fileType:e.fileType||"image/*"})):void 0,billed:P||void 0,billable:D};console.log("".concat(c?"Updating":"Creating"," task with input:"),e);const{data:r}=c?await Z({variables:{id:c.id,input:e}}):await q({variables:{input:e}});W({title:"Task ".concat(c?"updated":"created"),status:"success",duration:3e3}),null===l||void 0===l||l(),Te()}catch(e){console.error("".concat(c?"Update":"Create"," task error:"),e),W({title:"Error",description:e instanceof Error?e.message:"Failed to ".concat(c?"update":"create"," task"),status:"error",duration:5e3})}},isLoading:H||X,disabled:!h,children:c?"Update Task":"Create Task"})]})]})})]}),de&&(0,ve.jsxs)(Q.aF,{isOpen:!!de,onClose:()=>be(null),size:"6xl",children:[(0,ve.jsx)(K.m,{}),(0,ve.jsxs)(J.$,{maxW:"90vw",maxH:"90vh",children:[(0,ve.jsx)(Y.s,{zIndex:"popover"}),(0,ve.jsx)(V.c,{p:0,children:(0,ve.jsx)(v.a,{height:"85vh",overflow:"auto",children:(0,ve.jsx)(he.A,{file:(0,je.jV)(de.url),children:(0,ve.jsx)(xe.A,{pageNumber:1,width:.8*window.innerWidth})})})})]})]})]})};var Pe,Ie,Ne,De=o(45973),Ae=o(80006);const ze=[{name:"Australia",code:"+61",flag:"\ud83c\udde6\ud83c\uddfa"},{name:"United States",code:"+1",flag:"\ud83c\uddfa\ud83c\uddf8"},{name:"United Kingdom",code:"+44",flag:"\ud83c\uddec\ud83c\udde7"},{name:"Canada",code:"+1",flag:"\ud83c\udde8\ud83c\udde6"},{name:"New Zealand",code:"+64",flag:"\ud83c\uddf3\ud83c\uddff"},{name:"Germany",code:"+49",flag:"\ud83c\udde9\ud83c\uddea"},{name:"France",code:"+33",flag:"\ud83c\uddeb\ud83c\uddf7"},{name:"Japan",code:"+81",flag:"\ud83c\uddef\ud83c\uddf5"},{name:"Singapore",code:"+65",flag:"\ud83c\uddf8\ud83c\uddec"}],Re=(0,l.J1)(Pe||(Pe=(0,i.A)(["\n  mutation CreateClient($input: ClientInput!) {\n    createClient(input: $input) {\n      id\n      fName\n      lName\n      email\n      phoneNumber\n      createdAt\n      updatedAt\n    }\n  }\n"]))),Fe=(0,l.J1)(Ie||(Ie=(0,i.A)(["\n  mutation UpdateProject($id: ID!, $input: ProjectUpdateInput!) {\n    updateProject(id: $id, input: $input) {\n      id\n      projectName\n      projectGoal\n      members {\n        id\n        fName\n        lName\n        email\n      }\n    }\n  }\n"]))),Ue=(0,l.J1)(Ne||(Ne=(0,i.A)(["\n  query GetProject($id: ID!) {\n    project(id: $id) {\n      id\n      members {\n        id\n        fName\n        lName\n        email\n      }\n    }\n  }\n"]))),$e=e=>{let{isOpen:r,onClose:o,projectId:i,onMemberAdded:s}=e;(0,re.oU)("background.main"),(0,re.oU)("background.cardGradient");const a=(0,re.oU)("border.darkCard"),l=(0,re.oU)("text.primaryDark"),c=(0,re.oU)("text.secondaryDark"),u=(0,re.oU)("text.mutedDark"),[m,g]=(0,t.useState)(ze[0]),[b,h]=(0,t.useState)(""),[x,f]=(0,t.useState)(""),[v,y]=(0,t.useState)({firstName:"",lastName:"",email:"",phoneNumber:""}),k=(0,j.d)(),[E,{loading:P}]=(0,p.n)(Re,{refetchQueries:["GetClients"]}),[I]=(0,p.n)(Fe),{data:D}=(0,d.IT)(Ue,{variables:{id:i},skip:!i});(0,t.useEffect)(()=>{if(!b.trim())return f(""),void y(e=>(0,n.A)((0,n.A)({},e),{},{phoneNumber:""}));let e=b.trim();e=e.replace(/[\s\-\(\)]/g,""),e.startsWith("+")&&(e=e.substring(1));const r=m.code.substring(1);e.startsWith(r)&&(e=e.substring(r.length));const o=m.code+e;f(o),y(e=>(0,n.A)((0,n.A)({},e),{},{phoneNumber:o}))},[m,b]);const A=e=>{const{name:r,value:o}=e.target;y(e=>(0,n.A)((0,n.A)({},e),{},{[r]:o}))},z=()=>{y({firstName:"",lastName:"",email:"",phoneNumber:""}),h(""),f(""),g(ze[0])},R=()=>{z(),o()};return(0,ve.jsxs)(Q.aF,{isOpen:r,onClose:R,size:"md",children:[(0,ve.jsx)(K.m,{bg:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(10px)"}),(0,ve.jsxs)(J.$,{bg:"rgba(30, 30, 30, 0.98)",backdropFilter:"blur(20px)",borderColor:a,border:"1px solid",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.5)",children:[(0,ve.jsx)(ce.r,{borderBottom:"1px",borderColor:a,children:(0,ve.jsx)(w.E,{color:l,fontFamily:re.Kk.fonts.heading,children:"Add New Team Member"})}),(0,ve.jsx)(Y.s,{color:c,_hover:{color:l,bg:"rgba(255, 255, 255, 0.1)"}}),(0,ve.jsx)(V.c,{pb:6,children:(0,ve.jsxs)(C.T,{spacing:4,align:"stretch",children:[(0,ve.jsx)(w.E,{fontSize:"sm",color:c,children:"Create a new client and add them to this project as a team member."}),(0,ve.jsxs)(pe.MJ,{isRequired:!0,children:[(0,ve.jsxs)(ue.l,{color:l,children:["First Name",(0,ve.jsx)(w.E,{as:"span",color:"red.400",children:"*"})]}),(0,ve.jsx)(N.p,{name:"firstName",value:v.firstName,onChange:A,placeholder:"Enter first name",bg:"rgba(0, 0, 0, 0.2)",border:"1px",borderColor:a,color:l,borderRadius:"lg",_placeholder:{color:u},_focus:{borderColor:c,boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.1)"},_hover:{borderColor:c}})]}),(0,ve.jsxs)(pe.MJ,{isRequired:!0,children:[(0,ve.jsxs)(ue.l,{color:l,children:["Last Name",(0,ve.jsx)(w.E,{as:"span",color:"red.400",children:"*"})]}),(0,ve.jsx)(N.p,{name:"lastName",value:v.lastName,onChange:A,placeholder:"Enter last name",bg:"rgba(0, 0, 0, 0.2)",border:"1px",borderColor:a,color:l,borderRadius:"lg",_placeholder:{color:u},_focus:{borderColor:c,boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.1)"},_hover:{borderColor:c}})]}),(0,ve.jsxs)(pe.MJ,{isRequired:!0,children:[(0,ve.jsxs)(ue.l,{color:l,children:["Email",(0,ve.jsx)(w.E,{as:"span",color:"red.400",children:"*"})]}),(0,ve.jsx)(N.p,{name:"email",type:"email",value:v.email,onChange:A,placeholder:"Enter email address",bg:"rgba(0, 0, 0, 0.2)",border:"1px",borderColor:a,color:l,borderRadius:"lg",_placeholder:{color:u},_focus:{borderColor:c,boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.1)"},_hover:{borderColor:c}})]}),(0,ve.jsxs)(pe.MJ,{isRequired:!0,children:[(0,ve.jsxs)(ue.l,{color:l,children:["Phone Number",(0,ve.jsx)(w.E,{as:"span",color:"red.400",children:"*"})]}),(0,ve.jsxs)(C.T,{spacing:2,align:"stretch",children:[(0,ve.jsx)(O.l,{value:m.code,onChange:e=>(e=>{const r=ze.find(r=>r.code===e);r&&(g(r),h(""))})(e.target.value),bg:"rgba(0, 0, 0, 0.2)",border:"1px",borderColor:a,color:l,borderRadius:"lg",_focus:{borderColor:c,boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.1)"},_hover:{borderColor:c},children:ze.map(e=>(0,ve.jsxs)("option",{value:e.code,style:{backgroundColor:"#2a2a2a",color:"#E5E5E5"},children:[e.flag," ",e.name," (",e.code,")"]},e.code))}),(0,ve.jsxs)(De.M,{children:[(0,ve.jsx)(Ae.G6,{bg:"rgba(0, 0, 0, 0.3)",borderColor:a,color:l,children:m.code}),(0,ve.jsx)(N.p,{type:"tel",value:b,onChange:e=>{h(e.target.value)},placeholder:"Enter phone number",bg:"rgba(0, 0, 0, 0.2)",border:"1px",borderColor:a,color:l,_placeholder:{color:u},_focus:{borderColor:c,boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.1)"},_hover:{borderColor:c}})]}),x&&(0,ve.jsxs)(pe.eK,{color:c,children:["Formatted: ",x]})]})]}),(0,ve.jsxs)(S.z,{spacing:3,pt:4,children:[(0,ve.jsx)(T.$,{variant:"outline",onClick:R,flex:1,borderColor:a,color:l,bg:"rgba(0, 0, 0, 0.2)",_hover:{borderColor:c,bg:"rgba(255, 255, 255, 0.05)"},children:"Cancel"}),(0,ve.jsx)(T.$,{bg:(0,re.oU)("components.button.primaryBg"),color:"white",_hover:{bg:(0,re.oU)("components.button.primaryHover"),transform:"translateY(-2px)"},onClick:async()=>{if(!v.firstName.trim()||!v.lastName.trim()||!v.email.trim())return void k({title:"Missing Information",description:"Please fill in all required fields",status:"error",duration:3e3});if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v.email))if(x&&x.match(/^\+[1-9]\d{1,14}$/))try{var e,r;const{data:n}=await E({variables:{input:{fName:v.firstName.trim(),lName:v.lastName.trim(),email:v.email.trim(),phoneNumber:x}}});if(null===n||void 0===n||!n.createClient)throw new Error("Failed to create client");const t=[...(null===D||void 0===D||null===(e=D.project)||void 0===e||null===(r=e.members)||void 0===r?void 0:r.map(e=>e.id))||[],n.createClient.id];await I({variables:{id:i,input:{members:t}}}),k({title:"Success!",description:"".concat(v.firstName," ").concat(v.lastName," has been created and added to the project"),status:"success",duration:5e3}),z(),s(),o()}catch(n){console.error("Error creating and adding member:",n),k({title:"Error",description:n instanceof Error?n.message:"Failed to create and add member",status:"error",duration:5e3})}else k({title:"Invalid Phone Number",description:"Please enter a valid phone number",status:"error",duration:3e3});else k({title:"Invalid Email",description:"Please enter a valid email address",status:"error",duration:3e3})},isLoading:P,loadingText:"Creating...",flex:1,boxShadow:"0 2px 4px rgba(0, 122, 255, 0.2)",children:"Create & Add Member"})]})]})})]})]})};var Oe,Le,Me,_e,Ge,We,Be,Qe,Ke,Je,Ye,Ve,qe,He,Ze,Xe,er;be.EA.workerSrc="//unpkg.com/pdfjs-dist@".concat(be.rE,"/build/pdf.worker.min.mjs");const rr=(0,q.i7)(Oe||(Oe=(0,i.A)(["\n  0% {\n    transform: translate(-50%, -50%) scale(1);\n    opacity: 0.1;\n  }\n  50% {\n    transform: translate(-50%, -50%) scale(1.05);\n    opacity: 0.2;\n  }\n  100% {\n    transform: translate(-50%, -50%) scale(1);\n    opacity: 0.1;\n  }\n"]))),or=(0,l.J1)(Le||(Le=(0,i.A)(["\n  query GetProject($id: ID!) {\n    project(id: $id) {\n      id\n      projectName\n      projectGoal\n      projectDescription\n      progress\n      createdAt\n      updatedAt\n      billingClient {\n        id\n        fName\n        lName\n        email\n      }\n      members {\n        id\n        fName\n        lName\n        email\n      }\n      tasks {\n        id\n        description\n        status\n        order\n        assignedTo {\n          id\n          fName\n          lName\n          email\n          profilePhoto\n        }\n        media {\n          url\n          description\n          fileType\n        }\n        billed\n        billable\n      }\n      bills {\n        id\n      }\n    }\n  }\n"]))),nr=(0,l.J1)(Me||(Me=(0,i.A)(["\n  query PublicGetProject($id: ID!) {\n    publicProject(id: $id) {\n      id\n      projectName\n      projectGoal\n      projectDescription\n      progress\n      createdAt\n      updatedAt\n      billingClient {\n        id\n        fName\n        lName\n        email\n      }\n      members {\n        id\n        fName\n        lName\n        email\n      }\n      tasks {\n        id\n        description\n        status\n        order\n        assignedTo {\n          id\n          fName\n          lName\n          email\n          profilePhoto\n        }\n        media {\n          url\n          description\n          fileType\n        }\n        billed\n        billable\n      }\n      bills {\n        id\n      }\n    }\n  }\n"]))),ir=(0,l.J1)(_e||(_e=(0,i.A)(["\n  mutation UpdateProject($id: ID!, $input: ProjectUpdateInput!) {\n    updateProject(id: $id, input: $input) {\n      id\n      projectName\n      projectGoal\n      members {\n        id\n        fName\n        lName\n        email\n      }\n    }\n  }\n"]))),tr=(0,l.J1)(Ge||(Ge=(0,i.A)(["\n  mutation UpdateTaskStatus($taskId: ID!, $status: TaskStatus!) {\n    updateTaskStatus(taskId: $taskId, status: $status) {\n      id\n      description\n      status\n      assignedTo {\n        id\n        email\n      }\n    }\n  }\n"]))),sr=((0,l.J1)(We||(We=(0,i.A)(["\n  mutation DeleteFile($url: String!) {\n    deleteFromPinata(url: $url)\n  }\n"]))),(0,l.J1)(Be||(Be=(0,i.A)(["\n  mutation CreateDraftBillWithTasks($projectId: ID!) {\n    createDraftBillWithTasks(projectId: $projectId) {\n      id\n      lineItems {\n        id\n        description\n        amount\n \n      }\n      service {\n        id\n        client {\n          id\n          fName\n          lName\n        }\n      }\n   \n      isPaid\n    }\n  }\n"])))),ar=(0,l.J1)(Qe||(Qe=(0,i.A)(["\n  mutation DeleteTask($id: ID!) {\n    deleteTask(id: $id)\n  }\n"]))),lr=(0,l.J1)(Ke||(Ke=(0,i.A)(["\n  mutation UpdateProjectProgress($id: ID!, $input: UpdateProjectProgressInput!) {\n    updateProjectProgress(id: $id, input: $input) {\n      id\n      progress\n      projectName\n      projectGoal\n    }\n  }\n"]))),dr=(0,l.J1)(Je||(Je=(0,i.A)(["\n  mutation ImproveDescription($text: String!, $context: String) {\n    improveDescription(text: $text, context: $context)\n  }\n"]))),cr=(0,l.J1)(Ye||(Ye=(0,i.A)(["\n  mutation ImproveTagline($text: String!, $context: String) {\n    improveTagline(text: $text, context: $context)\n  }\n"]))),pr=(0,l.J1)(Ve||(Ve=(0,i.A)(["\n  mutation UpdateTaskOrder($taskId: ID!, $order: Int!) {\n    updateTaskOrder(taskId: $taskId, order: $order) {\n      id\n      order\n    }\n  }\n"]))),ur=(0,l.J1)(qe||(qe=(0,i.A)(["\n  query GetClients {\n    clients {\n      id\n      fName\n      lName\n      email\n      businessName\n    }\n  }\n"]))),mr=(0,l.J1)(He||(He=(0,i.A)(["\n  mutation DeleteTaskMedia($taskId: ID!, $photoUrl: String!) {\n    deleteTaskMedia(taskId: $taskId, photoUrl: $photoUrl)\n  }\n"]))),gr=(0,l.J1)(Ze||(Ze=(0,i.A)(["\n  query ExportProjectTasksToMarkdown($projectId: ID!) {\n    exportProjectTasksToMarkdown(projectId: $projectId)\n  }\n"]))),br=(0,l.J1)(Xe||(Xe=(0,i.A)(["\n  mutation ImportTasksFromMarkdown($projectId: ID!, $markdown: String!) {\n    importTasksFromMarkdown(projectId: $projectId, markdown: $markdown) {\n      id\n      projectName\n    }\n  }\n"]))),hr=(0,l.J1)(er||(er=(0,i.A)(["\n  mutation AppendTasksFromMarkdown($projectId: ID!, $markdown: String!) {\n    appendTasksFromMarkdown(projectId: $projectId, markdown: $markdown) {\n      id\n      projectName\n    }\n  }\n"]))),xr=()=>{var e,r,o;(0,ne.H)("Project Details");const{id:i}=(0,s.g)(),{loading:l,isAuthenticated:m,user:g}=(0,fe.A)(),b=((0,s.Zp)(),(0,j.d)()),[h,x]=(0,t.useState)(!1),[f,q]=(0,t.useState)(!1),[ce,pe]=(0,t.useState)(null),[ue,me]=(0,t.useState)(!1),[ge,be]=(0,t.useState)(""),[ye,ke]=(0,t.useState)(""),[Ce,Ee]=(0,t.useState)(""),[we,Se]=(0,t.useState)(null),[Pe,Ie]=(0,t.useState)({}),[Ne,De]=(0,t.useState)([]),[Ae,ze]=(0,t.useState)(""),[Re,Fe]=(0,t.useState)(!1),[Ue,Oe]=(0,t.useState)(!1),[Le,Me]=(0,t.useState)(!1),[_e,Ge]=(0,t.useState)(!1),We=(0,re.oU)("background.main"),Be=(0,re.oU)("background.cardGradient"),Qe=(0,re.oU)("border.darkCard"),Ke=(0,re.oU)("text.primaryDark"),Je=(0,re.oU)("text.secondaryDark"),Ye=(0,re.oU)("text.mutedDark"),Ve=m?or:nr,{loading:qe,error:He,data:Ze,refetch:Xe}=(0,d.IT)(Ve,{variables:{id:i},onCompleted:e=>{console.log("Project data loaded:",e);const r=(null===e||void 0===e?void 0:e.project)||(null===e||void 0===e?void 0:e.publicProject);null!==r&&void 0!==r&&r.tasks&&De([...r.tasks].sort((e,r)=>e.order-r.order))},onError:e=>{console.error("Project data error:",e)}}),{data:er,loading:xr}=(0,d.IT)(ur),fr=null===g||void 0===g||null===(e=g.permissions)||void 0===e?void 0:e.includes("PROJECTS_ADMIN"),[jr,{loading:vr}]=(0,c._)(gr,{fetchPolicy:"network-only",onCompleted:e=>{if(null!==e&&void 0!==e&&e.exportProjectTasksToMarkdown){const r=e.exportProjectTasksToMarkdown,o=(null===_r||void 0===_r?void 0:_r.projectName)||"project",n="".concat(o.replace(/[^a-z0-9]/gi,"_").toLowerCase(),"_tasks.md"),i=new Blob([r],{type:"text/markdown"}),t=URL.createObjectURL(i),s=document.createElement("a");s.href=t,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),b({title:"Tasks exported",description:"Downloaded ".concat(n),status:"success",duration:3e3,isClosable:!0})}},onError:e=>{b({title:"Export failed",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),yr=(0,t.useRef)(null),kr=(0,t.useRef)(null),[Cr,Er]=(0,t.useState)(!1),[wr,Sr]=(0,t.useState)(!1),[Tr]=(0,p.n)(br,{onCompleted:()=>{b({title:"Tasks imported successfully",description:"All tasks have been replaced with imported data",status:"success",duration:3e3,isClosable:!0}),Er(!1),Xe()},onError:e=>{b({title:"Import failed",description:e.message,status:"error",duration:5e3,isClosable:!0}),Er(!1)}}),[Pr]=(0,p.n)(hr,{onCompleted:()=>{b({title:"Tasks appended successfully",description:"Additional tasks added to project (existing tasks preserved)",status:"success",duration:3e3,isClosable:!0}),Sr(!1),Xe()},onError:e=>{b({title:"Append failed",description:e.message,status:"error",duration:5e3,isClosable:!0}),Sr(!1)}}),[Ir]=(0,p.n)(ir),[Nr]=(0,p.n)(dr),[Dr]=(0,p.n)(cr),[Ar]=(0,p.n)(mr,{onCompleted:e=>console.log("Task media deleted:",e),onError:e=>console.error("Task media deletion error:",e)}),[zr]=(0,p.n)(tr,{onCompleted:e=>console.log("Task status updated:",e),onError:e=>console.error("Task status update error:",e),update:(e,r)=>{let{data:o}=r;if(null!==o&&void 0!==o&&o.updateTaskStatus){const r=o.updateTaskStatus;try{const o=e.readQuery({query:or,variables:{id:i}});if(null!==o&&void 0!==o&&o.project){const t=o.project.tasks.map(e=>e.id===r.id?(0,n.A)((0,n.A)({},e),{},{status:r.status}):e);e.writeQuery({query:or,variables:{id:i},data:{project:(0,n.A)((0,n.A)({},o.project),{},{tasks:t})}}),De(e=>e.map(e=>e.id===r.id?(0,n.A)((0,n.A)({},e),{},{status:r.status}):e))}}catch(He){console.error("Error updating cache:",He)}}}}),[Rr]=(0,p.n)(sr),[Fr]=(0,p.n)(ar),[Ur]=(0,p.n)(lr,{onCompleted:()=>{b({title:"Progress Updated",status:"success",duration:3e3,isClosable:!0})},onError:e=>{b({title:"Error updating progress",description:e.message,status:"error",duration:5e3,isClosable:!0})}}),[$r]=(0,p.n)(pr);(0,t.useEffect)(()=>{console.log("Add task modal state:",f),console.log("Selected image:",ce)},[f,ce]),(0,t.useEffect)(()=>{console.log("Project ID:",i),console.log("Loading state:",qe),console.log("Current project data:",null===Ze||void 0===Ze?void 0:Ze.project),He&&console.error("Query error:",He)},[i,qe,Ze,He]),(0,t.useEffect)(()=>{const e=(null===Ze||void 0===Ze?void 0:Ze.project)||(null===Ze||void 0===Ze?void 0:Ze.publicProject);e&&(be(e.projectName),ke(e.projectGoal),Ee(e.projectDescription||""),e.tasks&&De([...e.tasks].sort((e,r)=>e.order-r.order)))},[null===Ze||void 0===Ze?void 0:Ze.project,null===Ze||void 0===Ze?void 0:Ze.publicProject]);const Or=e=>{let r=e.trim();(r.startsWith('"')&&r.endsWith('"')||r.startsWith("'")&&r.endsWith("'"))&&(r=r.slice(1,-1));const o=[/^Here is the improved [^:]*:\s*/i,/^Improved [^:]*:\s*/i,/^The improved [^:]*:\s*/i];for(const n of o)r=r.replace(n,"");return r.trim()},Lr=(e,r)=>'Please create a single, concise project goal for "'.concat(r||"this project",'" in maximum 17 words. Focus on the key outcome or value proposition. Return ONLY the improved goal without any preamble, explanation, or quotes. Current goal: "').concat(e,'"'),Mr=(e,r)=>'Please create a compelling project description for "'.concat(r||"this project",'" in maximum 70 words. This should expand on the goal to explain what the project does, who it\'s for, and what makes it unique. Be specific and value-focused. Return ONLY the improved description without any preamble, explanation, or quotes. Current description: "').concat(e,'"');if(l||qe)return(0,ve.jsxs)(v.a,{bg:We,minHeight:"100vh",display:"flex",flexDirection:"column",children:[(0,ve.jsx)(Z.m,{}),(0,ve.jsx)(ee.y,{moduleConfig:oe.default}),(0,ve.jsx)(y.m,{maxW:"container.xl",py:8,flex:"1",children:(0,ve.jsx)(k.o,{h:"50vh",children:(0,ve.jsxs)(C.T,{spacing:6,children:[(0,ve.jsx)(E.y,{size:"xl",color:"blue.500",thickness:"4px"}),(0,ve.jsx)(w.E,{children:"Loading project data..."})]})})}),(0,ve.jsx)(X.n,{})]});if(He)return console.error("GraphQL Error:",He),(0,ve.jsxs)(w.E,{children:["Error: ",He.message]});const _r=(null===Ze||void 0===Ze?void 0:Ze.project)||(null===Ze||void 0===Ze?void 0:Ze.publicProject);return _r?(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)("style",{children:"\n                    @keyframes shimmer {\n                        0% { transform: translateX(-100%); }\n                        100% { transform: translateX(100%); }\n                    }\n                    @keyframes pulse {\n                        0%, 100% { opacity: 1; }\n                        50% { opacity: 0.5; }\n                    }\n                "}),(0,ve.jsxs)(v.a,{bg:We,minHeight:"100vh",display:"flex",flexDirection:"column",children:[(0,ve.jsx)(Z.m,{}),(0,ve.jsx)(ee.y,{moduleConfig:oe.default}),(0,ve.jsxs)(y.m,{maxW:"container.xl",py:8,flex:"1",children:[(0,ve.jsxs)(S.z,{justify:"space-between",mb:4,wrap:"wrap",spacing:4,children:[(0,ve.jsx)(v.a,{})," ",(0,ve.jsx)(S.z,{spacing:4,children:(0,ve.jsx)(T.$,{as:a.N_,to:"/project/".concat(i,"/timeline"),bg:(0,re.oU)("status.info"),color:(0,re.oU)("text.inverse"),_hover:{bg:(0,re.oU)("secondary")},leftIcon:(0,ve.jsx)(ie.Ohp,{}),fontFamily:re.Kk.fonts.body,children:"Timeline View"})})]}),(0,ve.jsx)(H.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,ve.jsxs)(C.T,{spacing:8,align:"stretch",children:[(0,ve.jsxs)(P.Z,{bg:Be,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:Qe,borderRadius:"xl",overflow:"hidden",children:[(0,ve.jsx)(I.a,{bg:"rgba(0, 0, 0, 0.2)",borderBottom:"1px",borderColor:Qe,children:(0,ve.jsxs)(C.T,{align:"start",spacing:4,children:[(0,ve.jsxs)(S.z,{justify:"space-between",width:"full",children:[ue?(0,ve.jsx)(N.p,{value:ge,onChange:e=>be(e.target.value),size:"lg",variant:"unstyled",fontWeight:"bold",fontSize:{base:"xl",md:"2xl"},width:"full",color:Ke,fontFamily:re.Kk.fonts.heading}):(0,ve.jsx)(D.D,{size:{base:"md",md:"lg"},wordBreak:"break-word",pr:{base:2,md:4},color:Ke,fontFamily:re.Kk.fonts.heading,children:_r.projectName}),fr&&(0,ve.jsx)(A.K,{"aria-label":"Edit project",icon:ue?(0,ve.jsx)(te.S,{}):(0,ve.jsx)(se.q,{}),onClick:ue?async()=>{try{await Ir({variables:{id:i,input:{projectName:ge,projectGoal:ye,projectDescription:Ce}}}),me(!1),Xe()}catch(He){console.error("Error updating project:",He)}}:()=>me(!0),variant:"ghost",flexShrink:0,color:Ke,_hover:{bg:"rgba(255, 255, 255, 0.05)"}})]}),(0,ve.jsxs)(S.z,{spacing:4,flexWrap:"wrap",gap:2,children:[(0,ve.jsxs)(z.E,{colorScheme:"blue",px:2,py:1,borderRadius:"full",children:["Project #",i]}),(0,ve.jsxs)(w.E,{color:Je,fontSize:{base:"sm",md:"md"},whiteSpace:{base:"normal",md:"nowrap"},fontFamily:re.Kk.fonts.body,children:["Created: ",new Date(_r.createdAt).toLocaleDateString()]}),fr&&(0,ve.jsx)(T.$,{size:"sm",colorScheme:"green",onClick:()=>window.open("/bills/new?projectId=".concat(i),"_blank"),leftIcon:(0,ve.jsx)(w.E,{children:"\ud83d\udcb0"}),children:"Create New Bill"})]})]})}),(0,ve.jsxs)(R.b,{p:8,children:[(0,ve.jsxs)(F.r,{columns:{base:1,md:2},spacing:8,children:[(0,ve.jsxs)(C.T,{align:"stretch",spacing:6,children:[(0,ve.jsxs)(v.a,{children:[(0,ve.jsxs)(S.z,{justify:"space-between",align:"center",mb:2,children:[(0,ve.jsx)(w.E,{fontWeight:"bold",color:re.Kk.colors.text.inverse,fontFamily:re.Kk.fonts.body,children:"Project Goal"}),ue&&(0,ve.jsxs)(S.z,{spacing:2,children:[(0,ve.jsx)(U.m,{label:(0,ve.jsxs)(v.a,{p:2,maxW:"500px",children:[(0,ve.jsx)(w.E,{fontWeight:"bold",fontSize:"sm",mb:2,children:"AI Context:"}),(0,ve.jsx)(w.E,{fontSize:"xs",whiteSpace:"pre-wrap",children:Lr(ye||"[your project goal]",ge)})]}),placement:"top",hasArrow:!0,bg:"gray.700",color:"white",children:(0,ve.jsx)(T.$,{size:"sm",variant:"outline",colorScheme:"purple",isDisabled:!ye.trim(),isLoading:Le,onClick:async()=>{if(ye.trim()){Me(!0);try{const e=Lr(ye,ge),{data:r}=await Dr({variables:{text:ye,context:e}});null!==r&&void 0!==r&&r.improveTagline&&(ke(Or(r.improveTagline)),b({title:"\u2728 Project goal improved!",status:"success",duration:3e3}))}catch(He){console.error("Error improving project goal:",He),b({title:"Failed to improve project goal",description:He instanceof Error?He.message:"Please try again",status:"error",duration:5e3})}finally{Me(!1)}}else b({title:"Please enter a project goal first",status:"warning",duration:3e3})},leftIcon:(0,ve.jsx)(w.E,{children:"\u2728"}),children:"AI Improve"})}),(0,ve.jsx)(A.K,{"aria-label":"Copy AI context",icon:(0,ve.jsx)(w.E,{children:"\ud83d\udccb"}),size:"sm",variant:"ghost",isDisabled:!ye.trim(),onClick:()=>{ye.trim()&&(navigator.clipboard.writeText(Lr(ye,ge)),b({title:"AI context copied!",description:"The project goal context has been copied to your clipboard",status:"success",duration:2e3}))},title:"Copy AI context to clipboard"})]})]}),ue?(0,ve.jsx)($.T,{value:ye,onChange:e=>ke(e.target.value),size:"sm",bg:(0,re.QQ)("form","fieldBg"),border:"1px",borderColor:(0,re.QQ)("form","fieldBorder"),borderRadius:"lg",_focus:{borderColor:(0,re.QQ)("form","fieldBorderFocus"),boxShadow:(0,re.QQ)("form","fieldShadowFocus")},fontFamily:re.Kk.fonts.body,placeholder:"Project goal (max 17 words)",rows:2}):(0,ve.jsx)(w.E,{color:re.Kk.colors.text.inverse,fontFamily:re.Kk.fonts.body,children:_r.projectGoal})]}),(0,ve.jsxs)(v.a,{children:[(0,ve.jsxs)(S.z,{justify:"space-between",align:"center",mb:2,children:[(0,ve.jsx)(w.E,{fontWeight:"bold",color:re.Kk.colors.text.inverse,fontFamily:re.Kk.fonts.body,children:"Project Description"}),ue&&(0,ve.jsxs)(S.z,{spacing:2,children:[(0,ve.jsx)(U.m,{label:(0,ve.jsxs)(v.a,{p:2,maxW:"600px",children:[(0,ve.jsx)(w.E,{fontWeight:"bold",fontSize:"sm",mb:2,children:"AI Context:"}),(0,ve.jsx)(w.E,{fontSize:"xs",whiteSpace:"pre-wrap",children:Mr(Ce||"[your project description]",ge)})]}),placement:"top",hasArrow:!0,bg:"gray.700",color:"white",children:(0,ve.jsx)(T.$,{size:"sm",variant:"outline",colorScheme:"purple",isDisabled:!Ce.trim()&&!ge.trim(),isLoading:_e,onClick:async()=>{if(Ce.trim()||ge.trim()){Ge(!0);try{const e=Mr(Ce||ge,ge),{data:r}=await Nr({variables:{text:Ce||ge,context:e}});null!==r&&void 0!==r&&r.improveDescription&&(Ee(Or(r.improveDescription)),b({title:"\u2728 Project description improved!",status:"success",duration:3e3}))}catch(He){console.error("Error improving project description:",He),b({title:"Failed to improve project description",description:He instanceof Error?He.message:"Please try again",status:"error",duration:5e3})}finally{Ge(!1)}}else b({title:"Please enter a project name or description first",status:"warning",duration:3e3})},leftIcon:(0,ve.jsx)(w.E,{children:"\u2728"}),children:"AI Improve"})}),(0,ve.jsx)(A.K,{"aria-label":"Copy AI context",icon:(0,ve.jsx)(w.E,{children:"\ud83d\udccb"}),size:"sm",variant:"ghost",isDisabled:!Ce.trim()&&!ge.trim(),onClick:()=>{(Ce.trim()||ge.trim())&&(navigator.clipboard.writeText(Mr(Ce||ge,ge)),b({title:"AI context copied!",description:"The project description context has been copied to your clipboard",status:"success",duration:2e3}))},title:"Copy AI context to clipboard"})]})]}),ue?(0,ve.jsx)($.T,{value:Ce,onChange:e=>Ee(e.target.value),size:"sm",bg:(0,re.QQ)("form","fieldBg"),border:"1px",borderColor:(0,re.QQ)("form","fieldBorder"),borderRadius:"lg",_focus:{borderColor:(0,re.QQ)("form","fieldBorderFocus"),boxShadow:(0,re.QQ)("form","fieldShadowFocus")},fontFamily:re.Kk.fonts.body,placeholder:"Project description (max 70 words)",rows:3}):(0,ve.jsx)(w.E,{color:re.Kk.colors.text.inverse,fontFamily:re.Kk.fonts.body,children:_r.projectDescription||"No description provided"})]}),(0,ve.jsxs)(v.a,{children:[(0,ve.jsx)(w.E,{fontWeight:"bold",mb:2,color:Ke,fontFamily:re.Kk.fonts.body,children:"Client"}),fr&&ue?(0,ve.jsx)(O.l,{value:_r.billingClient.id,onChange:async e=>{const r=e.target.value;try{await Ir({variables:{id:i,input:{billingClient:r}}}),Xe(),b({title:"Client updated successfully",status:"success",duration:3e3,isClosable:!0})}catch(He){console.error("Error updating client:",He),b({title:"Error updating client",description:He instanceof Error?He.message:"Unknown error",status:"error",duration:5e3,isClosable:!0})}},size:"sm",bg:"rgba(20, 20, 20, 0.95)",color:"#FFFFFF",borderColor:Qe,_hover:{borderColor:(0,re.oU)("primary")},_focus:{borderColor:(0,re.oU)("primary"),bg:"rgba(20, 20, 20, 0.95)"},sx:{option:{backgroundColor:"#2a2a2a",color:"#E5E5E5",_hover:{backgroundColor:"#3a3a3a"}}},children:null===er||void 0===er||null===(r=er.clients)||void 0===r?void 0:r.map(e=>(0,ve.jsxs)("option",{value:e.id,style:{backgroundColor:"#2a2a2a",color:"#E5E5E5"},children:[e.fName," ",e.lName," (",e.email,")"]},e.id))}):(0,ve.jsxs)(S.z,{children:[(0,ve.jsx)(L.e,{size:"sm",name:"".concat(_r.billingClient.fName," ").concat(_r.billingClient.lName),bg:(0,re.oU)("primary")}),(0,ve.jsxs)(C.T,{align:"start",spacing:0,children:[(0,ve.jsxs)(w.E,{color:Ke,fontFamily:re.Kk.fonts.body,children:[_r.billingClient.fName," ",_r.billingClient.lName]}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,fontFamily:re.Kk.fonts.body,children:_r.billingClient.email})]})]})]}),(0,ve.jsxs)(v.a,{children:[(0,ve.jsxs)(S.z,{justify:"space-between",mb:2,children:[(0,ve.jsxs)(w.E,{fontWeight:"bold",color:Ke,fontFamily:re.Kk.fonts.body,children:["Team Members (",_r.members.length+1,")"]}),fr&&(0,ve.jsxs)(S.z,{spacing:2,children:[(0,ve.jsx)(T.$,{size:"sm",colorScheme:"blue",variant:"outline",onClick:()=>Fe(!0),leftIcon:(0,ve.jsx)(ie.cfS,{}),children:"Add Existing"}),(0,ve.jsx)(T.$,{size:"sm",colorScheme:"green",variant:"outline",onClick:()=>Oe(!0),leftIcon:(0,ve.jsx)(ie.cfS,{}),children:"Create New Member"})]})]}),(0,ve.jsxs)(C.T,{align:"stretch",spacing:2,children:[(0,ve.jsx)(S.z,{p:3,bg:"rgba(0, 122, 255, 0.1)",backdropFilter:"blur(10px)",borderRadius:"md",border:"2px",borderColor:"rgba(0, 122, 255, 0.3)",justify:"space-between",transition:"all 0.3s",_hover:{bg:"rgba(0, 122, 255, 0.15)",borderColor:(0,re.oU)("primary")},children:(0,ve.jsxs)(S.z,{children:[(0,ve.jsx)(L.e,{size:"sm",name:"".concat(_r.billingClient.fName," ").concat(_r.billingClient.lName),bg:(0,re.oU)("primary")}),(0,ve.jsxs)(C.T,{align:"start",spacing:0,children:[(0,ve.jsxs)(w.E,{fontSize:"sm",fontWeight:"medium",color:Ke,children:[_r.billingClient.fName," ",_r.billingClient.lName,(0,ve.jsx)(z.E,{ml:2,colorScheme:"blue",size:"sm",children:"Client"})]}),(0,ve.jsx)(w.E,{fontSize:"xs",color:Je,children:_r.billingClient.email})]})]})}),_r.members.map(e=>(0,ve.jsxs)(S.z,{p:3,bg:"rgba(255, 255, 255, 0.02)",backdropFilter:"blur(10px)",borderRadius:"md",border:"1px",borderColor:Qe,justify:"space-between",transition:"all 0.3s",_hover:{bg:"rgba(255, 255, 255, 0.05)",borderColor:Je},children:[(0,ve.jsxs)(S.z,{children:[(0,ve.jsx)(L.e,{size:"sm",name:"".concat(e.fName," ").concat(e.lName),bg:(0,re.oU)("primary")}),(0,ve.jsxs)(C.T,{align:"start",spacing:0,children:[(0,ve.jsxs)(w.E,{fontSize:"sm",fontWeight:"medium",color:Ke,children:[e.fName," ",e.lName]}),(0,ve.jsx)(w.E,{fontSize:"xs",color:Je,children:e.email})]})]}),fr&&(0,ve.jsx)(A.K,{"aria-label":"Remove member",icon:(0,ve.jsx)(ae.d,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this member from the project?"))try{var r;const o=((null===(r=_r.members)||void 0===r?void 0:r.map(e=>e.id))||[]).filter(r=>r!==e);await Ir({variables:{id:i,input:{members:o}}}),Xe(),b({title:"Member removed successfully",status:"success",duration:3e3,isClosable:!0})}catch(He){console.error("Error removing member:",He),b({title:"Error removing member",description:He instanceof Error?He.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}})(e.id),title:e.id===(null===g||void 0===g?void 0:g.id)?"Remove yourself from project":"Remove member from project"})]},e.id)),fr&&Re&&(0,ve.jsx)(C.T,{p:4,bg:"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(10px)",borderRadius:"md",border:"1px",borderColor:Qe,spacing:3,children:(0,ve.jsxs)(S.z,{width:"full",spacing:3,children:[(0,ve.jsx)(O.l,{value:Ae,onChange:e=>ze(e.target.value),placeholder:"Select client to add",isDisabled:xr,bg:(0,re.QQ)("form","fieldBg"),color:Ke,border:"1px",borderColor:(0,re.QQ)("form","fieldBorder"),borderRadius:"lg",_focus:{borderColor:(0,re.QQ)("form","fieldBorderFocus"),boxShadow:(0,re.QQ)("form","fieldShadowFocus")},_placeholder:{color:Je},size:"sm",flex:1,sx:{option:{backgroundColor:"#2a2a2a",color:"#E5E5E5",_hover:{backgroundColor:"#3a3a3a"}}},children:null===er||void 0===er||null===(o=er.clients)||void 0===o?void 0:o.map(e=>(0,ve.jsxs)("option",{value:e.id,style:{backgroundColor:"#2a2a2a",color:"#E5E5E5"},children:[e.businessName?"".concat(e.businessName," - "):"",e.fName," ",e.lName," (",e.email,")"]},e.id))}),(0,ve.jsx)(T.$,{size:"sm",colorScheme:"green",onClick:async()=>{var e;if(!Ae)return void b({title:"Please select a client",status:"warning",duration:3e3,isClosable:!0});if(null===(e=_r.members)||void 0===e?void 0:e.some(e=>e.id===Ae))b({title:"Client is already a member",status:"warning",duration:3e3,isClosable:!0});else try{var r;const e=[...(null===(r=_r.members)||void 0===r?void 0:r.map(e=>e.id))||[],Ae];await Ir({variables:{id:i,input:{members:e}}}),ze(""),Fe(!1),Xe(),b({title:"Member added successfully",status:"success",duration:3e3,isClosable:!0})}catch(He){console.error("Error adding member:",He),b({title:"Error adding member",description:He instanceof Error?He.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}},isDisabled:!Ae,children:"Add"}),(0,ve.jsx)(T.$,{size:"sm",variant:"ghost",onClick:()=>{Fe(!1),ze("")},children:"Cancel"})]})}),0===_r.members.length&&(0,ve.jsx)(w.E,{fontSize:"sm",color:Ye,textAlign:"center",py:4,children:"No team members assigned to this project"})]})]})]}),(0,ve.jsxs)(C.T,{align:"stretch",spacing:3,children:[(0,ve.jsxs)(S.z,{justify:"space-between",p:4,bg:"linear-gradient(135deg, rgba(0, 122, 255, 0.08) 0%, rgba(0, 122, 255, 0.03) 100%)",backdropFilter:"blur(10px)",borderRadius:"lg",border:"2px",borderColor:"rgba(0, 122, 255, 0.2)",transition:"all 0.3s",_hover:{borderColor:"rgba(0, 122, 255, 0.4)",transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(0, 122, 255, 0.1)"},children:[(0,ve.jsxs)(S.z,{spacing:3,children:[(0,ve.jsx)(v.a,{p:2,bg:"rgba(0, 122, 255, 0.2)",borderRadius:"md",children:(0,ve.jsx)(M.I,{as:ie.cfS,boxSize:4,color:(0,re.oU)("primary")})}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,fontFamily:re.Kk.fonts.body,children:"Team Size"})]}),(0,ve.jsxs)(C.T,{spacing:0,align:"end",children:[(0,ve.jsx)(w.E,{fontWeight:"bold",fontSize:"2xl",color:Ke,fontFamily:re.Kk.fonts.body,children:_r.members.length+1}),(0,ve.jsx)(w.E,{fontSize:"xs",color:Ye,children:"members"})]})]}),(0,ve.jsxs)(S.z,{justify:"space-between",p:4,bg:"linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(34, 197, 94, 0.03) 100%)",backdropFilter:"blur(10px)",borderRadius:"lg",border:"2px",borderColor:"rgba(34, 197, 94, 0.2)",transition:"all 0.3s",_hover:{borderColor:"rgba(34, 197, 94, 0.4)",transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(34, 197, 94, 0.1)"},children:[(0,ve.jsxs)(S.z,{spacing:3,children:[(0,ve.jsx)(v.a,{p:2,bg:"rgba(34, 197, 94, 0.2)",borderRadius:"md",children:(0,ve.jsx)(M.I,{as:ie.A3x,boxSize:4,color:"green.400"})}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,fontFamily:re.Kk.fonts.body,children:"Progress"})]}),(0,ve.jsxs)(C.T,{spacing:0,align:"end",children:[(0,ve.jsxs)(w.E,{fontWeight:"bold",fontSize:"2xl",color:Ke,fontFamily:re.Kk.fonts.body,children:[_r.tasks.filter(e=>"COMPLETED"===e.status).length,"/",_r.tasks.length]}),(0,ve.jsx)(w.E,{fontSize:"xs",color:Ye,children:"tasks done"})]})]})]})]}),(0,ve.jsxs)(v.a,{mt:4,p:4,children:[(0,ve.jsxs)(S.z,{mb:2,justify:"space-between",children:[(0,ve.jsx)(w.E,{fontWeight:"semibold",color:Ke,fontFamily:re.Kk.fonts.body,children:"Overall Progress"}),fr&&(0,ve.jsx)(O.l,{size:"sm",value:_r.progress||0,onChange:async e=>{const r=parseInt(e.target.value);try{await Ur({variables:{id:i,input:{progress:r}}})}catch(He){console.error("Error updating progress:",He)}},width:"100px",bg:(0,re.QQ)("form","fieldBg"),border:"1px",borderColor:(0,re.QQ)("form","fieldBorder"),borderRadius:"lg",_focus:{borderColor:(0,re.QQ)("form","fieldBorderFocus"),boxShadow:(0,re.QQ)("form","fieldShadowFocus")},fontFamily:re.Kk.fonts.body,children:Array.from({length:11},(e,r)=>10*r).map(e=>(0,ve.jsxs)("option",{value:e,children:[e,"%"]},e))})]}),(0,ve.jsx)(_.k,{value:_r.progress||0,size:"lg",borderRadius:"full",colorScheme:"green",hasStripe:!0,isAnimated:!0}),(0,ve.jsxs)(w.E,{mt:2,fontSize:"sm",color:Je,textAlign:"right",fontFamily:re.Kk.fonts.body,children:[_r.progress||0,"% Complete"]})]})]})]}),fr&&(0,ve.jsx)(v.a,{textAlign:"center",py:8,px:4,position:"relative",bg:"linear-gradient(135deg, rgba(0, 122, 255, 0.1) 0%, rgba(90, 200, 250, 0.05) 100%)",borderRadius:"xl",border:"2px dashed",borderColor:"rgba(0, 122, 255, 0.3)",transition:"all 0.3s",_hover:{borderColor:"rgba(0, 122, 255, 0.5)",bg:"linear-gradient(135deg, rgba(0, 122, 255, 0.15) 0%, rgba(90, 200, 250, 0.08) 100%)",transform:"scale(1.02)"},children:(0,ve.jsxs)(C.T,{spacing:3,children:[(0,ve.jsx)(w.E,{fontSize:"2xl",color:(0,re.oU)("primary"),children:"\u2795"}),(0,ve.jsx)(T.$,{bg:(0,re.QQ)("button","primaryBg"),color:(0,re.oU)("text.inverse"),_hover:{bg:(0,re.QQ)("button","primaryHover"),transform:"translateY(-2px)",boxShadow:"0 8px 24px rgba(0, 122, 255, 0.4)"},size:"lg",width:{base:"full",md:"60%"},height:"65px",fontSize:"xl",fontWeight:"bold",leftIcon:(0,ve.jsx)(ie.A3x,{size:24}),onClick:()=>{Se(null),q(!0)},boxShadow:"0 4px 16px rgba(0, 122, 255, 0.3)",fontFamily:re.Kk.fonts.body,transition:"all 0.3s",children:"Add Your First Task"}),(0,ve.jsx)(w.E,{fontSize:"md",color:Ke,fontFamily:re.Kk.fonts.body,fontWeight:"medium",children:"Break down your project into actionable steps"}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,fontFamily:re.Kk.fonts.body,children:"Each task can have its own status, media attachments, and progress tracking"})]})}),(0,ve.jsxs)(P.Z,{bg:Be,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:Qe,borderRadius:"xl",overflow:"hidden",children:[(0,ve.jsx)(I.a,{borderBottom:"2px",borderColor:Qe,bg:"rgba(0, 122, 255, 0.05)",py:5,children:(0,ve.jsxs)(C.T,{align:"stretch",spacing:3,children:[(0,ve.jsxs)(S.z,{justify:"space-between",children:[(0,ve.jsxs)(S.z,{spacing:3,children:[(0,ve.jsx)(w.E,{fontSize:"2xl",children:"\ud83d\udccb"}),(0,ve.jsxs)(C.T,{align:"start",spacing:0,children:[(0,ve.jsx)(D.D,{size:"lg",color:Ke,children:"Project Tasks"}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,children:"Track your progress and manage deliverables"})]})]}),fr&&Ne.length>0&&(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)(T.$,{size:"sm",bg:"rgba(0, 122, 255, 0.2)",color:(0,re.oU)("primary"),border:"1px",borderColor:"rgba(0, 122, 255, 0.3)",_hover:{bg:"rgba(0, 122, 255, 0.3)",borderColor:(0,re.oU)("primary")},leftIcon:(0,ve.jsx)(ie.GGD,{}),onClick:()=>{Se(null),q(!0)},children:"Add Task"}),(0,ve.jsx)(U.m,{label:"Export all tasks to markdown file for bulk editing",children:(0,ve.jsx)(T.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ve.jsx)(le.s,{}),onClick:()=>jr({variables:{projectId:i}}),isLoading:vr,children:"Export Tasks (.md)"})}),(0,ve.jsx)("input",{type:"file",ref:yr,onChange:async e=>{var r;const o=null===(r=e.target.files)||void 0===r?void 0:r[0];if(o)if(o.name.endsWith(".md")){Er(!0);try{const e=new FileReader;e.onload=async e=>{var r;const o=null===(r=e.target)||void 0===r?void 0:r.result;await Tr({variables:{projectId:i,markdown:o}})},e.readAsText(o)}catch(He){b({title:"Error reading file",description:He.message,status:"error",duration:3e3,isClosable:!0}),Er(!1)}e.target.value=""}else b({title:"Invalid file type",description:"Please upload a .md (markdown) file",status:"error",duration:3e3,isClosable:!0})},accept:".md",style:{display:"none"}}),(0,ve.jsx)(U.m,{label:"Import tasks from markdown file (REPLACES all existing tasks)",children:(0,ve.jsx)(T.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ve.jsx)(le.s,{transform:"rotate(180deg)"}),onClick:()=>{var e;return null===(e=yr.current)||void 0===e?void 0:e.click()},isLoading:Cr,children:"Import (.md)"})}),(0,ve.jsx)("input",{type:"file",ref:kr,onChange:async e=>{var r;const o=null===(r=e.target.files)||void 0===r?void 0:r[0];if(o)if(o.name.endsWith(".md")){Sr(!0);try{const e=new FileReader;e.onload=async e=>{var r;const o=null===(r=e.target)||void 0===r?void 0:r.result;await Pr({variables:{projectId:i,markdown:o}})},e.readAsText(o)}catch(He){b({title:"Error reading file",description:He.message,status:"error",duration:3e3,isClosable:!0}),Sr(!1)}e.target.value=""}else b({title:"Invalid file type",description:"Please upload a .md (markdown) file",status:"error",duration:3e3,isClosable:!0})},accept:".md",style:{display:"none"}}),(0,ve.jsx)(U.m,{label:"Import additional tasks from markdown file (ADDS to existing tasks)",children:(0,ve.jsx)(T.$,{size:"sm",bg:"rgba(59, 130, 246, 0.2)",color:"blue.400",border:"1px",borderColor:"rgba(59, 130, 246, 0.3)",_hover:{bg:"rgba(59, 130, 246, 0.3)",borderColor:"blue.400"},leftIcon:(0,ve.jsx)(ie.GGD,{}),onClick:()=>{var e;return null===(e=kr.current)||void 0===e?void 0:e.click()},isLoading:wr,children:"Import Additional (.md)"})}),(0,ve.jsx)(U.m,{label:"Download markdown format specification guide",children:(0,ve.jsx)(T.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ve.jsx)(de.t,{}),onClick:()=>{u('# Unified Markdown Format Specification\n\n**Version:** 1.0\n**Last Updated:** January 2025\n\nThis document defines the unified markdown format for importing/exporting projects, bills, and proposals.\n\n---\n\n## \ud83d\udcdd Format Overview\n\nThe unified format combines:\n- Project metadata (name, goal, description)\n- Bill metadata (currency, payment method, status)\n- Line items / Tasks (description, price, status, assignee)\n- Agreement text (optional)\n\nThis allows editing proposals in Claude and importing them into the system.\n\n---\n\n## \ud83d\udccb Complete Example\n\n```markdown\n# One Group Website Development Proposal\n\n## Project Information\n**Project Name:** One Group Website Development\n**Project Goal:** Build unified digital platform for Solar, Finance & Property Investment\n**Project Description:** Complete 80-page unified platform representing all three One Group verticals with custom calculators, CRM integration, and SEO optimization.\n\n## Bill Information\n**Currency:** AUD\n**Payment Method:** AUD_TRANSFER\n**Status:** PROPOSAL\n\n## Line Items\n\n### 1. Content Page: onegroupaustralasia.com.au/\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n\n### 2. Content Page: onegroupaustralasia.com.au/about\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n### 3. Custom Logic: onegroupaustralasia.com.au/solar/calculator\n**Price:** $300.00\n**Billable:** Yes\n**Status:** IN_PROGRESS\n**Assignee:** jane@tommillerservices.com\n\n### 4. Project management and coordination\n**Price:** $0.00\n**Billable:** No\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n\n### 5. Internal testing and QA\n**Price:** [ENTER PRICE]\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n## Agreement\n\n[Full agreement text goes here...]\n\n**Between:** Tom Miller Services Pty Ltd ("TMS")\n**And:** One Group ("Client")\n\n[Rest of agreement...]\n```\n\n---\n\n## \ud83d\udd0d Field Specifications\n\n### Project Information Section\n\n| Field | Required | Format | Example |\n|-------|----------|--------|---------|\n| Project Name | Yes | Plain text | `One Group Website Development` |\n| Project Goal | No | Max 17 words | `Build unified digital platform for Solar, Finance & Property` |\n| Project Description | No | Max 200 words | `Complete 80-page unified platform...` |\n\n**Notes:**\n- Project Goal is used for taglines (keep concise)\n- Project Description provides context for the work\n\n---\n\n### Bill Information Section\n\n| Field | Required | Format | Options |\n|-------|----------|--------|---------|\n| Currency | Yes | Uppercase code | `AUD`, `USD` |\n| Payment Method | No | Enum value | `AUD_TRANSFER`, `CARD`, `CRYPTO` |\n| Status | No | Enum value | `PROPOSAL`, `DRAFT`, `SENT` |\n\n**Notes:**\n- Currency affects how prices are parsed\n- If Payment Method is omitted, defaults to `AUD_TRANSFER`\n- If Status is omitted, defaults to `PROPOSAL`\n\n---\n\n### Line Items Section\n\nEach line item uses this format:\n\n```markdown\n### [Number]. [Description]\n**Price:** [Amount]\n**Billable:** [Yes/No]\n**Status:** [Status]\n**Assignee:** [Email or "Unassigned"]\n```\n\n#### Field Details:\n\n| Field | Required | Format | Options/Rules |\n|-------|----------|--------|---------------|\n| Number | No | Integer | Sequential numbering (1, 2, 3...) |\n| Description | Yes | Plain text | Task/line item description |\n| Price | Yes | Number with currency symbol | `$100.00`, `[ENTER PRICE]` (placeholder) |\n| Billable | No | Yes/No | Defaults to `Yes` if omitted |\n| Status | No | Enum | `PENDING`, `IN_PROGRESS`, `COMPLETED` (defaults to `PENDING`) |\n| Assignee | No | Email or "Unassigned" | Must be valid email or literal "Unassigned" |\n\n**Price Format Rules:**\n- With symbol: `$100.00`, `$100`, `$99.50`\n- Without symbol: `100.00`, `100`, `99.50`\n- Placeholder: `[ENTER PRICE]` \u2190 **Fails import** (must add price before importing)\n- Zero price: `$0.00` \u2190 Creates non-billable line item\n\n**Assignee Rules:**\n- Valid email: `tom@tommillerservices.com` \u2190 Looks up user and assigns\n- Invalid email: Creates unassigned task and shows warning\n- "Unassigned": Creates unassigned task\n- Omitted: Creates unassigned task\n\n---\n\n## \ud83d\udd04 Import/Export Behavior\n\n### Export (Project \u2192 Markdown)\n\nWhen exporting a project to markdown:\n1. **Project Info:** Populated from project.projectName, projectGoal, projectDescription\n2. **Bill Info:** Uses default values (Currency from tenant, Status = PROPOSAL)\n3. **Line Items:**\n   - Description from task.description\n   - Price = `[ENTER PRICE]` for billable tasks, `$0.00` for non-billable\n   - Billable from task.billable (defaults to Yes)\n   - Status from task.status\n   - Assignee from task.assignedTo.email (or "Unassigned")\n4. **Agreement:** Not included in export (add manually if needed)\n\n### Import (Markdown \u2192 Bill)\n\nWhen importing markdown to a bill:\n1. **Project Info:** Ignored (bill already linked to project)\n2. **Bill Info:** Updates bill.currency if specified\n3. **Line Items:**\n   - **Replaces all existing line items** (with confirmation modal)\n   - Creates new line items from each `### [Number]. [Description]` section\n   - Parses price and converts to cents for Stripe\n   - Sets billable flag based on price ($0 = non-billable)\n   - Assignee is stored but not enforced (bills don\'t have task assignments)\n4. **Agreement:** Ignored during bill import\n\n---\n\n## \u2705 Validation Rules\n\n### During Export\n- [ ] At least 1 task exists in project\n- [ ] Task descriptions are not empty\n- [ ] All billable tasks marked with price placeholder\n\n### During Import to Bill\n- [ ] Valid markdown structure\n- [ ] At least 1 line item found\n- [ ] All line items have valid prices (no `[ENTER PRICE]` placeholders)\n- [ ] All prices are positive numbers or zero\n- [ ] Currency code is valid (AUD or USD)\n- [ ] Status enum is valid (if provided)\n\n---\n\n## \ud83d\udeab Common Parse Errors\n\n| Error | Cause | Solution |\n|-------|-------|----------|\n| "No line items found" | Missing `## Line Items` section | Add section header |\n| "Invalid price format" | Price has `[ENTER PRICE]` | Replace with actual dollar amount |\n| "Currency not supported" | Invalid currency code | Use `AUD` or `USD` |\n| "Line item missing description" | Empty description after number | Add description text |\n| "Negative price not allowed" | Price is negative | Use positive number or $0.00 |\n\n---\n\n## \ud83c\udfa8 Formatting Tips for Claude Editing\n\n### Adding New Line Items\n```markdown\n### 81. New feature: User authentication module\n**Price:** $500.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** tom@tommillerservices.com\n```\n\n### Bulk Price Adjustments\nAsk Claude: "Increase all Content Page items by 20%"\nClaude will update:\n- `**Price:** $100.00` \u2192 `**Price:** $120.00`\n\n### Reassigning Tasks\nAsk Claude: "Assign all calculator tasks to jane@tommillerservices.com"\nClaude will update:\n- `**Assignee:** Unassigned` \u2192 `**Assignee:** jane@tommillerservices.com`\n\n### Marking Tasks Complete\nAsk Claude: "Mark tasks 1-10 as completed"\nClaude will update:\n- `**Status:** PENDING` \u2192 `**Status:** COMPLETED`\n\n---\n\n**Version History:**\n- v1.0 (Jan 2025) - Initial specification\n',"FORMAT_SPEC.md"),b({title:"Format guide downloaded",description:"Downloaded FORMAT_SPEC.md",status:"success",duration:3e3,isClosable:!0})},children:"Format Guide"})}),(0,ve.jsx)(U.m,{label:"Download blank markdown template",children:(0,ve.jsx)(T.$,{size:"sm",bg:"rgba(168, 85, 247, 0.2)",color:"purple.400",border:"1px",borderColor:"rgba(168, 85, 247, 0.3)",_hover:{bg:"rgba(168, 85, 247, 0.3)",borderColor:"purple.400"},leftIcon:(0,ve.jsx)(le.s,{}),onClick:()=>{u("# Bill Line Items Template\n\n## Project Information\n**Project Name:** [Enter project name]\n**Project Goal:** [Enter project goal - max 17 words]\n**Project Description:** [Enter project description - max 200 words]\n\n## Bill Information\n**Currency:** AUD\n**Payment Method:** AUD_TRANSFER\n**Status:** PROPOSAL\n\n## Line Items\n\n### 1. [Task description]\n**Price:** $100.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** email@example.com\n\n### 2. [Another task description]\n**Price:** $200.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n### 3. [Add more line items as needed]\n**Price:** $150.00\n**Billable:** Yes\n**Status:** PENDING\n**Assignee:** Unassigned\n\n## Agreement\n\n[Add your agreement text here, or leave this section empty]\n","bill_template.md"),b({title:"Template downloaded",description:"Downloaded bill_template.md",status:"success",duration:3e3,isClosable:!0})},children:"Template"})})]})]}),fr&&Ne.length>0&&(0,ve.jsxs)(S.z,{fontSize:"xs",color:Ye,bg:"rgba(255, 255, 255, 0.05)",px:3,py:2,borderRadius:"md",children:[(0,ve.jsx)(M.I,{as:ie.S8s}),(0,ve.jsx)(w.E,{children:"Tip: Use the arrow buttons to reorder tasks by priority"})]})]})}),(0,ve.jsx)(R.b,{p:6,children:(0,ve.jsxs)(C.T,{spacing:5,align:"stretch",children:[0===Ne.length&&(0,ve.jsx)(v.a,{textAlign:"center",py:12,bg:"rgba(0, 122, 255, 0.02)",borderRadius:"xl",border:"1px dashed",borderColor:"rgba(0, 122, 255, 0.2)",children:(0,ve.jsxs)(C.T,{spacing:4,children:[(0,ve.jsx)(w.E,{fontSize:"4xl",opacity:.5,children:"\ud83d\udcdd"}),(0,ve.jsx)(D.D,{size:"md",color:Ke,children:"No tasks yet"}),(0,ve.jsx)(w.E,{color:Je,children:"Start by adding your first task to get organized"}),fr&&(0,ve.jsx)(T.$,{bg:(0,re.QQ)("button","primaryBg"),color:"white",_hover:{bg:(0,re.QQ)("button","primaryHover"),transform:"translateY(-2px)"},size:"lg",leftIcon:(0,ve.jsx)(ie.GGD,{}),onClick:()=>{Se(null),q(!0)},boxShadow:"0 4px 12px rgba(0, 122, 255, 0.2)",children:"Create First Task"})]})}),Ne.length>0&&(0,ve.jsxs)(S.z,{spacing:4,p:4,bg:"rgba(0, 122, 255, 0.05)",borderRadius:"lg",border:"1px",borderColor:"rgba(0, 122, 255, 0.1)",children:[(0,ve.jsxs)(C.T,{flex:1,align:"center",children:[(0,ve.jsx)(w.E,{fontSize:"2xl",fontWeight:"bold",color:"gray.500",children:Ne.filter(e=>"PENDING"===e.status).length}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,children:"To Do"})]}),(0,ve.jsx)(G.c,{orientation:"vertical",height:"50px",borderColor:Qe}),(0,ve.jsxs)(C.T,{flex:1,align:"center",children:[(0,ve.jsx)(w.E,{fontSize:"2xl",fontWeight:"bold",color:(0,re.oU)("primary"),children:Ne.filter(e=>"IN_PROGRESS"===e.status).length}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,children:"In Progress"})]}),(0,ve.jsx)(G.c,{orientation:"vertical",height:"50px",borderColor:Qe}),(0,ve.jsxs)(C.T,{flex:1,align:"center",children:[(0,ve.jsx)(w.E,{fontSize:"2xl",fontWeight:"bold",color:"green.400",children:Ne.filter(e=>"COMPLETED"===e.status).length}),(0,ve.jsx)(w.E,{fontSize:"sm",color:Je,children:"Completed"})]})]}),Ne.map((e,r)=>{var o;return(0,ve.jsxs)(P.Z,{p:{base:5,md:6},variant:"outline",borderLeft:"5px",borderLeftColor:"COMPLETED"===e.status?"green.400":"IN_PROGRESS"===e.status?(0,re.oU)("primary"):"gray.400",bg:"COMPLETED"===e.status?"linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(34, 197, 94, 0.03) 100%)":"IN_PROGRESS"===e.status?"linear-gradient(135deg, rgba(0, 122, 255, 0.12) 0%, rgba(0, 122, 255, 0.05) 100%)":"rgba(255, 255, 255, 0.02)",position:"relative",border:"1px",borderColor:"IN_PROGRESS"===e.status?"rgba(0, 122, 255, 0.3)":"COMPLETED"===e.status?"rgba(34, 197, 94, 0.2)":Qe,boxShadow:"IN_PROGRESS"===e.status?"0 4px 20px rgba(0, 122, 255, 0.15)":"COMPLETED"===e.status?"0 2px 8px rgba(34, 197, 94, 0.1)":"0 2px 8px rgba(0, 0, 0, 0.1)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",_hover:{boxShadow:"IN_PROGRESS"===e.status?"0 8px 30px rgba(0, 122, 255, 0.25)":"COMPLETED"===e.status?"0 4px 16px rgba(34, 197, 94, 0.15)":"0 4px 16px rgba(255, 255, 255, 0.05)",transform:"translateY(-3px) scale(1.01)",borderColor:"IN_PROGRESS"===e.status?(0,re.oU)("primary"):"COMPLETED"===e.status?"green.400":Je,bg:"IN_PROGRESS"===e.status?"linear-gradient(135deg, rgba(0, 122, 255, 0.15) 0%, rgba(0, 122, 255, 0.08) 100%)":"COMPLETED"===e.status?"linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(34, 197, 94, 0.05) 100%)":"rgba(255, 255, 255, 0.04)"},_before:{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",bg:"IN_PROGRESS"===e.status?"linear-gradient(90deg, transparent, rgba(0, 122, 255, 0.5), transparent)":"transparent",animation:"IN_PROGRESS"===e.status?"shimmer 2s infinite":"none"},children:[fr&&(0,ve.jsxs)(W.s,{position:"absolute",left:{base:1,md:2},top:{base:2,md:4},direction:"column",bg:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(10px)",borderRadius:"md",border:"1px",borderColor:Qe,p:{base:.5,md:1},zIndex:2,display:{base:"none",sm:"flex"},children:[(0,ve.jsx)(A.K,{"aria-label":"Move task up",icon:(0,ve.jsx)(ie.ei4,{}),size:"xs",variant:"ghost",color:Ke,_hover:{bg:"rgba(255, 255, 255, 0.1)"},isDisabled:0===r,onClick:()=>(async(e,r)=>{if(r<=0)return;const o=[...Ne],i=o[r],t=o[r-1],s=i.order,a=t.order,l=(0,n.A)({},i),d=(0,n.A)({},t);o[r-1]=l,o[r]=d,De(o);try{await $r({variables:{taskId:i.id,order:a}}),await $r({variables:{taskId:t.id,order:s}}),b({title:"Task moved up",status:"success",duration:1e3,isClosable:!0})}catch(He){b({title:"Error moving task",description:He instanceof Error?He.message:"Unknown error occurred",status:"error",duration:3e3,isClosable:!0});const r=(null===Ze||void 0===Ze?void 0:Ze.project)||(null===Ze||void 0===Ze?void 0:Ze.publicProject);null!==r&&void 0!==r&&r.tasks&&De([...r.tasks].sort((e,r)=>e.order-r.order))}})(e.id,r),mb:1}),(0,ve.jsx)(A.K,{"aria-label":"Move task down",icon:(0,ve.jsx)(ie.LPr,{}),size:"xs",variant:"ghost",color:Ke,_hover:{bg:"rgba(255, 255, 255, 0.1)"},isDisabled:r===Ne.length-1,onClick:()=>(async(e,r)=>{if(r>=Ne.length-1)return;const o=[...Ne],i=o[r],t=o[r+1],s=i.order,a=t.order,l=(0,n.A)({},i),d=(0,n.A)({},t);o[r]=d,o[r+1]=l,De(o);try{await $r({variables:{taskId:i.id,order:a}}),await $r({variables:{taskId:t.id,order:s}}),b({title:"Task moved down",status:"success",duration:1e3,isClosable:!0})}catch(He){b({title:"Error moving task",description:He instanceof Error?He.message:"Unknown error occurred",status:"error",duration:3e3,isClosable:!0});const r=(null===Ze||void 0===Ze?void 0:Ze.project)||(null===Ze||void 0===Ze?void 0:Ze.publicProject);null!==r&&void 0!==r&&r.tasks&&De([...r.tasks].sort((e,r)=>e.order-r.order))}})(e.id,r)})]}),(0,ve.jsxs)(C.T,{align:"stretch",spacing:4,pl:{base:fr?8:0,md:fr?12:0},children:[(0,ve.jsxs)(S.z,{spacing:{base:2,md:4},align:"start",justify:"space-between",flexWrap:{base:"wrap",md:"nowrap"},children:[(0,ve.jsxs)(C.T,{align:"start",spacing:3,flex:1,minW:0,w:"full",children:[(0,ve.jsxs)(S.z,{align:"start",spacing:3,w:"full",children:["COMPLETED"===e.status&&(0,ve.jsx)(M.I,{as:ie.A3x,color:"green.400",boxSize:{base:5,md:6},mt:1,flexShrink:0}),(0,ve.jsx)(w.E,{fontSize:{base:"md",md:"xl"},fontWeight:"COMPLETED"===e.status?"medium":"semibold",color:"COMPLETED"===e.status?Je:"IN_PROGRESS"===e.status?(0,re.oU)("primary"):Ke,lineHeight:"tall",opacity:"COMPLETED"===e.status?.85:1,transition:"all 0.3s",wordBreak:"break-word",overflowWrap:"anywhere",children:e.description})]}),(0,ve.jsxs)(S.z,{spacing:3,flexWrap:"wrap",width:"full",children:[fr&&(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)(A.K,{"aria-label":"Edit task",icon:(0,ve.jsx)(se.q,{}),size:"sm",colorScheme:"blue",variant:"ghost",onClick:()=>{Se(e),q(!0)}}),(0,ve.jsx)(A.K,{"aria-label":"Delete task",icon:(0,ve.jsx)(ae.d,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:async()=>{if(window.confirm("Are you sure you want to delete this task?"))try{await Fr({variables:{id:e.id},refetchQueries:[{query:or,variables:{id:i}}]}),b({title:"Task deleted",status:"success",duration:3e3,isClosable:!0})}catch(He){b({title:"Error deleting task",description:He instanceof Error?He.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}}})]}),fr?(0,ve.jsxs)(O.l,{size:"sm",value:e.status,onChange:async r=>{try{await zr({variables:{taskId:e.id,status:r.target.value}})}catch(He){b({title:"Error updating status",description:He instanceof Error?He.message:"Unknown error",status:"error",duration:3e3})}},width:"140px",variant:"filled",bg:"rgba(0, 0, 0, 0.3)",color:Ke,border:"1px",borderColor:"COMPLETED"===e.status?"green.400":"IN_PROGRESS"===e.status?(0,re.oU)("primary"):Qe,fontSize:"sm",_hover:{borderColor:Je},children:[(0,ve.jsx)("option",{value:"PENDING",style:{backgroundColor:"#2a2a2a",color:"#E5E5E5"},children:"\u23f3 Pending"}),(0,ve.jsx)("option",{value:"IN_PROGRESS",style:{backgroundColor:"#2a2a2a",color:"#E5E5E5"},children:"\ud83d\ude80 In Progress"}),(0,ve.jsx)("option",{value:"COMPLETED",style:{backgroundColor:"#2a2a2a",color:"#E5E5E5"},children:"\u2705 Completed"})]}):(0,ve.jsx)(z.E,{px:3,py:1,borderRadius:"full",colorScheme:"COMPLETED"===e.status?"green":"IN_PROGRESS"===e.status?"blue":"gray",fontSize:"sm",children:"COMPLETED"===e.status?"\u2705 Completed":"IN_PROGRESS"===e.status?"\ud83d\ude80 In Progress":"\u23f3 Pending"}),!1===e.billable?(0,ve.jsx)(z.E,{colorScheme:"gray",px:3,py:1,borderRadius:"full",fontSize:"sm",bg:"rgba(107, 114, 128, 0.2)",color:"gray.400",border:"1px dashed",borderColor:"gray.500",children:"\ud83d\udeab Non-Billable"}):e.billed?(0,ve.jsx)(z.E,{colorScheme:"purple",px:3,py:1,borderRadius:"full",fontSize:"sm",children:"\ud83d\udcb0 Billed"}):(0,ve.jsx)(z.E,{colorScheme:"green",px:3,py:1,borderRadius:"full",fontSize:"sm",variant:"outline",children:"\ud83d\udcb5 Billable"}),e.media&&e.media.length>0&&(0,ve.jsxs)(z.E,{colorScheme:"teal",px:3,py:1,borderRadius:"full",fontSize:"sm",children:["\ud83d\udcf8 ",e.media.length," ",1===e.media.length?"file":"files"]}),(null===(o=e.assignedTo)||void 0===o?void 0:o[0])&&(0,ve.jsxs)(S.z,{spacing:2,children:[(0,ve.jsx)(L.e,{size:"xs",name:"".concat(e.assignedTo[0].fName," ").concat(e.assignedTo[0].lName),src:e.assignedTo[0].profilePhoto?(0,je.jV)(e.assignedTo[0].profilePhoto):void 0,bg:(0,re.oU)("primary")}),(0,ve.jsxs)(z.E,{colorScheme:"orange",px:3,py:1,borderRadius:"full",fontSize:"sm",children:[e.assignedTo[0].fName," ",e.assignedTo[0].lName]})]})]})]}),(0,ve.jsx)(v.a,{role:"group",as:fr?"button":"div",onClick:fr?async()=>{try{const r="COMPLETED"===e.status?"PENDING":"COMPLETED";await zr({variables:{taskId:e.id,status:r}}),b({title:"COMPLETED"===r?"Task completed! \ud83c\udf89":"Task marked as pending \ud83d\udccb",status:"success",duration:2e3,isClosable:!0})}catch(He){b({title:"Error updating status",description:He instanceof Error?He.message:"Unknown error",status:"error",duration:3e3})}}:void 0,position:"relative",width:{base:"48px",md:"56px"},height:{base:"48px",md:"56px"},minWidth:{base:"48px",md:"56px"},borderRadius:"12px",border:"3px solid",borderColor:"COMPLETED"===e.status?"green.400":(0,re.oU)("border.darkCard"),bg:"COMPLETED"===e.status?"linear-gradient(135deg, #48bb78 0%, #38a169 100%)":"linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%)",display:"flex",alignItems:"center",justifyContent:"center",cursor:fr?"pointer":"not-allowed",opacity:fr?1:.7,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"COMPLETED"===e.status?"0 8px 25px rgba(72, 187, 120, 0.5), inset 0 2px 0 rgba(255, 255, 255, 0.3), inset 0 -2px 0 rgba(0, 0, 0, 0.1)":"0 4px 15px rgba(0, 0, 0, 0.15), inset 0 2px 0 rgba(255, 255, 255, 0.1), inset 0 -2px 0 rgba(0, 0, 0, 0.1)",_hover:fr?{borderColor:"COMPLETED"===e.status?"green.500":(0,re.oU)("primary"),transform:"translateY(-3px) scale(1.1)",boxShadow:"COMPLETED"===e.status?"0 12px 35px rgba(72, 187, 120, 0.6), inset 0 2px 0 rgba(255, 255, 255, 0.4)":"0 8px 25px rgba(102, 126, 234, 0.4), inset 0 2px 0 rgba(255, 255, 255, 0.2)",bg:"COMPLETED"===e.status?"linear-gradient(135deg, #68d391 0%, #48bb78 100%)":"linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(102, 126, 234, 0.1) 100%)"}:{},_active:fr?{transform:"translateY(1px) scale(0.98)",boxShadow:"COMPLETED"===e.status?"0 2px 10px rgba(72, 187, 120, 0.4), inset 0 1px 0 rgba(0, 0, 0, 0.1)":"0 2px 8px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(0, 0, 0, 0.05)"}:{},_before:{content:'""',position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"COMPLETED"===e.status?"100%":"0%",height:"COMPLETED"===e.status?"100%":"0%",borderRadius:"12px",bg:"rgba(255, 255, 255, 0.1)",animation:"COMPLETED"===e.status?"".concat(rr," 2s infinite"):"none",pointerEvents:"none"},flexShrink:0,alignSelf:{base:"center",md:"flex-start"},mt:{base:2,md:1},ml:{base:2,md:0},children:"COMPLETED"===e.status?(0,ve.jsx)(M.I,{as:ie.A3x,boxSize:8,color:"white",filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2))"}):fr?(0,ve.jsx)(v.a,{width:"24px",height:"24px",borderRadius:"6px",border:"2px dashed",borderColor:(0,re.oU)("text.mutedDark"),opacity:.4,transition:"all 0.2s",_groupHover:{opacity:.6,borderColor:(0,re.oU)("primary")}}):(0,ve.jsx)(M.I,{as:ie.F5$,boxSize:5,color:(0,re.oU)("text.mutedDark"),opacity:.5})})]}),e.media&&e.media.length>0&&(0,ve.jsxs)(v.a,{children:[(0,ve.jsxs)(w.E,{fontWeight:"bold",mb:2,children:["Task Evidence (",e.media.length,")"]}),(console.log("Task media:",{taskId:e.id,media:e.media.map(e=>({url:e.url,fileType:e.fileType,isPDF:"application/pdf"===e.fileType||e.url.toLowerCase().includes("pdf"),isVideo:"video/mp4"===e.fileType||e.url.endsWith(".mp4")}))}),null),(0,ve.jsx)(F.r,{columns:{base:1,sm:2,md:3,lg:4},spacing:{base:2,md:4},children:e.media.map((r,o)=>(console.log("Rendering media item:",{index:o,url:r.url,fileType:r.fileType,isPDF:"application/pdf"===r.fileType||r.url.toLowerCase().includes("pdf"),isVideo:"video/mp4"===r.fileType||r.url.endsWith(".mp4")}),(0,ve.jsxs)(v.a,{position:"relative",cursor:"pointer",borderRadius:"md",overflow:"hidden",boxShadow:"sm",border:"1px solid",borderColor:"COMPLETED"===e.status?"green.200":"gray.200",children:["application/pdf"===r.fileType||r.url.toLowerCase().includes("pdf")?(0,ve.jsxs)(v.a,{maxH:"150px",overflow:"hidden",position:"relative",children:[(0,ve.jsx)(he.A,{file:(0,je.jV)(r.url),onLoadSuccess:e=>{let{numPages:o}=e;console.log("ProjectPage PDF loaded successfully:",{url:r.url,normalizedUrl:(0,je.jV)(r.url),numPages:o})},onLoadError:e=>{console.error("ProjectPage PDF load error:",e,{originalUrl:r.url,normalizedUrl:(0,je.jV)(r.url),fileType:r.fileType})},loading:(0,ve.jsxs)(v.a,{display:"flex",alignItems:"center",justifyContent:"center",height:"150px",children:[(0,ve.jsx)(E.y,{size:"md",color:"blue.500"}),(0,ve.jsx)(w.E,{ml:2,fontSize:"sm",children:"Loading PDF..."})]}),error:(0,ve.jsxs)(v.a,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"150px",bg:"red.50",p:4,children:[(0,ve.jsx)(w.E,{fontSize:"sm",color:"red.600",textAlign:"center",children:"Failed to load PDF"}),(0,ve.jsx)(T.$,{size:"sm",mt:2,colorScheme:"blue",variant:"outline",onClick:()=>window.open((0,je.jV)(r.url),"_blank"),children:"Open Direct"})]}),children:(0,ve.jsx)(xe.A,{pageNumber:1,width:200})}),(0,ve.jsx)(T.$,{position:"absolute",bottom:2,right:2,size:"sm",onClick:()=>window.open((0,je.jV)(r.url),"_blank"),children:"Download PDF"})]}):"video/mp4"===r.fileType||r.url.endsWith(".mp4")?(0,ve.jsxs)(v.a,{maxH:"150px",overflow:"hidden",children:[(console.log("Rendering video:",(0,je.jV)(r.url)),null),(0,ve.jsx)("video",{src:(0,je.jV)(r.url),controls:!0,style:{width:"100%",maxHeight:"150px",objectFit:"cover"},onClick:e=>e.stopPropagation(),children:"Your browser does not support the video tag."})]}):(0,ve.jsxs)(ve.Fragment,{children:[(console.log("Rendering image:",(0,je.jV)(r.url)),null),(0,ve.jsx)(B._,{src:(0,je.jV)(r.url),alt:r.description||"Evidence ".concat(o+1),height:"150px",width:"100%",objectFit:"cover",onClick:()=>pe((0,n.A)((0,n.A)({},r),{},{url:(0,je.jV)(r.url)}))})]}),(0,ve.jsx)(z.E,{position:"absolute",top:2,left:2,colorScheme:"COMPLETED"===e.status?"green":"gray",fontSize:"xs",children:r.description?"Proof of Work":"Screenshot"}),fr&&(0,ve.jsx)(A.K,{"aria-label":"Delete evidence",icon:(0,ve.jsx)(ae.d,{}),size:"sm",position:"absolute",right:2,top:2,zIndex:2,colorScheme:"red",opacity:.7,_hover:{opacity:1},onClick:async o=>{o.stopPropagation();try{await Ar({variables:{taskId:e.id,photoUrl:r.url}}),b({title:"Media deleted",status:"success",duration:3e3,isClosable:!0}),Xe()}catch(He){b({title:"Error deleting photo",description:He instanceof Error?He.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}}})]},o)))})]})]})]},e.id)}),Ne.length>0&&(0,ve.jsx)(P.Z,{p:{base:5,md:6},bg:Ne.every(e=>"COMPLETED"===e.status)?"linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 184, 0, 0.1) 50%, rgba(255, 215, 0, 0.15) 100%)":Be,backdropFilter:"blur(10px)",borderWidth:"2px",borderStyle:"dashed",borderColor:Ne.every(e=>"COMPLETED"===e.status)?"gold":"rgba(255, 215, 0, 0.2)",borderRadius:"xl",boxShadow:Ne.every(e=>"COMPLETED"===e.status)?"0 10px 40px rgba(255, 215, 0, 0.3), inset 0 0 60px rgba(255, 215, 0, 0.1)":"0 4px 20px 0 rgba(0, 0, 0, 0.1)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.4, 0, 0.2, 1)",_before:{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:Ne.every(e=>"COMPLETED"===e.status)?"radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.2) 0%, transparent 70%)":"none",animation:Ne.every(e=>"COMPLETED"===e.status)?"".concat(rr," 3s infinite"):"none",pointerEvents:"none"},children:(0,ve.jsx)(C.T,{spacing:4,align:"center",position:"relative",children:Ne.every(e=>"COMPLETED"===e.status)?(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)(w.E,{fontSize:"4xl",textAlign:"center",children:"\ud83c\udfc6\u2728\ud83d\udcb0"}),(0,ve.jsx)(D.D,{size:"lg",color:"gold",textAlign:"center",textShadow:"0 2px 10px rgba(255, 215, 0, 0.5)",children:"Congratulations! You've Found the Treasure!"}),(0,ve.jsx)(w.E,{color:Ke,fontSize:"lg",textAlign:"center",fontWeight:"semibold",children:"All tasks completed! Your dedication has unlocked the golden achievement."}),(0,ve.jsxs)(S.z,{spacing:4,mt:4,children:[(0,ve.jsx)(z.E,{colorScheme:"yellow",fontSize:"md",px:4,py:2,borderRadius:"full",boxShadow:"0 4px 20px rgba(255, 215, 0, 0.4)",children:"\ud83c\udf1f Project Champion"}),(0,ve.jsx)(z.E,{colorScheme:"green",fontSize:"md",px:4,py:2,borderRadius:"full",boxShadow:"0 4px 20px rgba(72, 187, 120, 0.4)",children:"\ud83d\udc8e 100% Complete"})]}),fr&&(0,ve.jsx)(T.$,{size:"lg",colorScheme:"yellow",mt:4,onClick:()=>window.open("/bills/new?projectId=".concat(i),"_blank"),leftIcon:(0,ve.jsx)(w.E,{children:"\ud83c\udf89"}),rightIcon:(0,ve.jsx)(w.E,{children:"\ud83d\udcb0"}),boxShadow:"0 6px 30px rgba(255, 215, 0, 0.4)",_hover:{transform:"translateY(-2px)",boxShadow:"0 8px 40px rgba(255, 215, 0, 0.5)"},children:"Create Victory Bill"})]}):(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)(w.E,{fontSize:"3xl",opacity:.3,filter:"grayscale(100%)",children:"\ud83c\udfc6"}),(0,ve.jsx)(D.D,{size:"md",color:Je,opacity:.6,textAlign:"center",children:"A Mystery Awaits..."}),(0,ve.jsx)(w.E,{color:Ye,fontSize:"sm",textAlign:"center",fontStyle:"italic",children:"Complete all tasks to reveal the golden treasure"}),(0,ve.jsx)(_.k,{value:Ne.filter(e=>"COMPLETED"===e.status).length/Ne.length*100,colorScheme:"yellow",size:"sm",width:"full",borderRadius:"full",bg:"rgba(255, 215, 0, 0.1)",mt:2}),(0,ve.jsxs)(w.E,{fontSize:"xs",color:Ye,children:[Ne.filter(e=>"COMPLETED"===e.status).length," of ",Ne.length," tasks completed"]})]})})}),0===Ne.length&&(0,ve.jsxs)(v.a,{textAlign:"center",py:10,px:6,borderWidth:"1px",borderRadius:"lg",borderStyle:"dashed",borderColor:"gray.300",children:[(0,ve.jsx)(M.I,{as:ie.A3x,boxSize:12,color:"blue.500",mb:4}),(0,ve.jsx)(D.D,{as:"h4",size:"md",mb:2,children:"No tasks yet"}),(0,ve.jsx)(w.E,{color:"gray.500",mb:4,children:"Start adding tasks to break down your project work"}),fr&&(0,ve.jsx)(T.$,{colorScheme:"blue",onClick:()=>{Se(null),q(!0)},children:"Add First Task"})]})]})})]})]})})]}),(0,ve.jsx)(X.n,{}),i&&(0,ve.jsx)(Te,{isOpen:f,onClose:()=>{q(!1),Se(null)},projectId:i,existingTask:we?{id:we.id,description:we.description,status:we.status,assignedTo:we.assignedTo,media:we.media,billed:we.billed||!1,billable:we.billable}:void 0,onTaskUpdated:()=>{Xe()}}),(0,ve.jsxs)(Q.aF,{isOpen:!!ce,onClose:()=>pe(null),size:"6xl",children:[(0,ve.jsx)(K.m,{onClick:()=>pe(null)}),(0,ve.jsxs)(J.$,{children:[(0,ve.jsx)(Y.s,{zIndex:"popover"}),(0,ve.jsxs)(V.c,{p:0,children:[(0,ve.jsx)(B._,{src:null!==ce&&void 0!==ce&&ce.url?(0,je.jV)(ce.url):"",alt:(null===ce||void 0===ce?void 0:ce.description)||"Task evidence",width:"100%",height:"auto",maxH:"90vh",objectFit:"contain",cursor:"pointer",onClick:()=>pe(null)}),(null===ce||void 0===ce?void 0:ce.description)&&(0,ve.jsx)(w.E,{p:4,textAlign:"center",children:ce.description})]})]})]}),(0,ve.jsx)($e,{isOpen:Ue,onClose:()=>Oe(!1),projectId:i||"",onMemberAdded:()=>{Xe(),b({title:"Member added successfully",description:"New team member has been created and added to the project",status:"success",duration:5e3,isClosable:!0})}})]})]}):(0,ve.jsx)(w.E,{children:"Project not found"})}}}]);
//# sourceMappingURL=3648.9d549074.chunk.js.map