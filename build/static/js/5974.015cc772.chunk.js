"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[5974],{35974:(e,o,r)=>{r.r(o),r.d(o,{default:()=>se});var t,n,i,s,l,a=r(89379),d=r(57528),c=r(65043),u=r(87139),p=r(22107),x=r(98662),h=r(42703),b=r(83169),g=r(24330),j=r(26201),m=r(68659),v=r(44093),y=r(73212),C=r(35699),f=r(45973),S=r(29244),k=r(59883),w=r(86236),z=r(53560),A=r(91872),D=r(88019),O=r(61724),T=r(76659),E=r(96148),I=r(10202),W=r(94217),L=r(94085),U=r(53332),R=r(78149),$=r(30502),_=r(47726),F=r(28846),G=r(39081),P=r(73216),Z=r(31881),H=r(10585),V=r(70459),M=r(1009),N=r(9824),J=r(52003),B=r(63295),q=r(95214),K=r(69129),X=r(39985),Y=r(66037),Q=r(70579);const ee=(0,V.J1)(t||(t=(0,d.A)(["\n  query GetOpportunities($status: OpportunityStatus, $stage: String) {\n    opportunities(status: $status, stage: $stage) {\n      id\n      title\n      description\n      clientId\n      clientName\n      clientEmail\n      clientPhone\n      value\n      stage\n      status\n      priority\n      probability\n      expectedRevenue\n      expectedCloseDate\n      lastActivityDate\n      assignedTo\n      assignedToName\n      source\n      taskCount\n      completedTaskCount\n      createdAt\n      updatedAt\n    }\n  }\n"]))),oe=(0,V.J1)(n||(n=(0,d.A)(["\n  query GetOpportunityStages {\n    opportunityStages {\n      id\n      name\n      code\n      order\n      color\n      icon\n      defaultProbability\n      isWonStage\n      isLostStage\n      currentOpportunities\n    }\n  }\n"]))),re=(0,V.J1)(i||(i=(0,d.A)(["\n  query GetOpportunityStats {\n    activeCount: opportunityCount(status: ACTIVE)\n    wonCount: opportunityCount(status: WON)\n    lostCount: opportunityCount(status: LOST)\n    totalValue: totalOpportunityValue(status: ACTIVE)\n    wonValue: totalOpportunityValue(status: WON)\n  }\n"]))),te=(0,V.J1)(s||(s=(0,d.A)(["\n  mutation MoveOpportunityStage($id: String!, $newStage: String!) {\n    moveOpportunityStage(id: $id, newStage: $newStage) {\n      id\n      stage\n      status\n      probability\n      expectedRevenue\n    }\n  }\n"]))),ne=(0,V.J1)(l||(l=(0,d.A)(["\n  mutation DeleteOpportunity($id: String!) {\n    deleteOpportunity(id: $id)\n  }\n"]))),ie=e=>{let{opportunity:o,onEdit:r,onDelete:t}=e;const{colorMode:n}=(0,v.G6)(),i=(0,X.oU)("background.cardGradient",n),s=(0,X.oU)("border.darkCard",n),l=(0,X.oU)("light"===n?"text.primary":"text.primaryDark",n),a=(0,X.oU)("light"===n?"text.muted":"text.mutedDark",n);return(0,Q.jsx)(b.Z,{bg:i,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:s,borderRadius:"lg",mb:3,cursor:"pointer",onClick:r,_hover:{transform:"translateY(-2px)",boxShadow:"0 12px 40px 0 rgba(0, 0, 0, 0.5)",transition:"all 0.2s"},children:(0,Q.jsx)(g.b,{p:3,children:(0,Q.jsxs)(I.T,{align:"stretch",spacing:2,children:[(0,Q.jsxs)(E.z,{justify:"space-between",children:[(0,Q.jsx)(G.E,{fontWeight:"bold",fontSize:"sm",noOfLines:1,color:l,children:o.title}),(0,Q.jsxs)(k.W,{children:[(0,Q.jsx)(w.I,{as:h.K,icon:(0,Q.jsx)(M.ZZB,{}),variant:"ghost",color:l,size:"xs",onClick:e=>e.stopPropagation()}),(0,Q.jsxs)(A.c,{bg:i,borderColor:s,children:[(0,Q.jsx)(z.D,{icon:(0,Q.jsx)(M.SG1,{}),onClick:e=>{e.stopPropagation(),r()},children:"Edit"}),(0,Q.jsx)(z.D,{icon:(0,Q.jsx)(M.IXo,{}),onClick:e=>{e.stopPropagation(),t()},color:"red.500",children:"Delete"})]})]})]}),(0,Q.jsxs)(E.z,{spacing:2,children:[(0,Q.jsx)(u.E,{colorScheme:(e=>{switch(e){case"CRITICAL":return"red";case"HIGH":return"orange";case"MEDIUM":return"yellow";default:return"gray"}})(o.priority),size:"sm",children:o.priority}),(0,Q.jsx)(G.E,{fontSize:"xs",color:a,children:o.clientName})]}),(0,Q.jsxs)(E.z,{justify:"space-between",children:[(0,Q.jsxs)(G.E,{fontSize:"lg",fontWeight:"bold",color:l,children:["$",o.value.toLocaleString()]}),(0,Q.jsxs)(G.E,{fontSize:"xs",color:a,children:[o.probability,"%"]})]}),o.expectedCloseDate&&(0,Q.jsxs)(E.z,{fontSize:"xs",color:a,children:[(0,Q.jsx)(M.wIk,{}),(0,Q.jsx)(G.E,{children:new Date(o.expectedCloseDate).toLocaleDateString()})]}),(0,Q.jsxs)(I.T,{spacing:1,align:"stretch",children:[(0,Q.jsxs)(E.z,{justify:"space-between",fontSize:"xs",children:[(0,Q.jsx)(G.E,{color:a,children:"Tasks"}),(0,Q.jsxs)(G.E,{color:l,fontWeight:"medium",children:[o.completedTaskCount||0," of ",o.taskCount||0]})]}),o.taskCount>0&&(0,Q.jsx)(D.k,{value:o.completedTaskCount/o.taskCount*100,size:"xs",colorScheme:"green"})]}),(0,Q.jsxs)(E.z,{fontSize:"xs",color:"gray.500",justify:"space-between",children:[(0,Q.jsx)(E.z,{spacing:2,children:o.clientEmail&&(0,Q.jsxs)(E.z,{spacing:1,children:[(0,Q.jsx)(M.pHD,{}),(0,Q.jsx)(G.E,{children:o.clientEmail})]})}),(0,Q.jsx)(E.z,{children:o.clientPhone&&(0,Q.jsx)(_.m,{label:o.clientPhone,children:(0,Q.jsx)("span",{children:(0,Q.jsx)(M.QFc,{})})})})]})]})})})},se=()=>{(0,Y.H)("Opportunities");const e=(0,P.Zp)(),o=(0,$.d)(),[r,t]=(0,c.useState)(""),[n,i]=(0,c.useState)("ALL"),{colorMode:s}=(0,v.G6)(),{data:l,loading:d,refetch:h}=(0,H.IT)(ee,{variables:{status:"ALL"===n?void 0:n}}),{data:k,loading:w}=(0,H.IT)(oe),{data:z}=(0,H.IT)(re),[A]=(0,Z.n)(te),[D]=(0,Z.n)(ne),_=(null===l||void 0===l?void 0:l.opportunities)||[],V=(null===k||void 0===k?void 0:k.opportunityStages)||[],se=V.reduce((e,o)=>(e[o.code]=_.filter(e=>e.stage===o.code),e),{}),le=(0,X.oU)("background.main",s),ae=(0,X.oU)("background.cardGradient",s),de=(0,X.oU)("border.darkCard",s),ce=(0,X.oU)("light"===s?"text.primary":"text.primaryDark",s),ue=(0,X.oU)("light"===s?"text.muted":"text.mutedDark",s),pe=(0,X.oU)("light"===s?"text.secondary":"text.secondaryDark",s),xe=(0,X.oU)("button.bg",s),he=(0,X.oU)("button.hoverBg",s);return d||w?(0,Q.jsxs)(p.a,{children:[(0,Q.jsx)(J.m,{}),(0,Q.jsx)(q.y,{moduleConfig:K.default}),(0,Q.jsx)(p.a,{maxW:"100%",px:{base:4,md:8},py:8,flex:"1",children:(0,Q.jsx)(m.o,{children:(0,Q.jsx)(T.y,{size:"xl"})})})]}):(0,Q.jsxs)(p.a,{bg:le,minH:"100vh",display:"flex",flexDirection:"column",children:[(0,Q.jsx)(J.m,{}),(0,Q.jsx)(q.y,{moduleConfig:K.default}),(0,Q.jsx)(p.a,{maxW:"100%",px:{base:4,md:8},py:8,flex:"1",children:(0,Q.jsxs)(I.T,{spacing:6,align:"stretch",children:[(0,Q.jsxs)(I.T,{spacing:4,align:"stretch",children:[(0,Q.jsx)(F.D,{size:{base:"md",md:"lg"},color:ce,children:"Opportunities Pipeline"}),(0,Q.jsxs)(E.z,{spacing:2,flexWrap:"wrap",children:[(0,Q.jsx)(x.$,{leftIcon:(0,Q.jsx)(M.ARf,{}),variant:"outline",size:{base:"sm",md:"md"},borderColor:"light"===s?"gray.300":"rgba(255, 255, 255, 0.3)",color:ce,_hover:{bg:"light"===s?"gray.50":ae},onClick:()=>e("/opportunities/dashboard"),children:"Dashboard"}),(0,Q.jsx)(x.$,{leftIcon:(0,Q.jsx)(M.GGD,{}),size:{base:"sm",md:"md"},bg:xe,color:"white",_hover:{bg:he},onClick:()=>e("/opportunities/new"),children:"New Opportunity"})]})]}),(0,Q.jsxs)(y.r,{columns:{base:1,md:5},spacing:4,children:[(0,Q.jsx)(b.Z,{bg:ae,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:de,borderRadius:"lg",children:(0,Q.jsx)(g.b,{children:(0,Q.jsxs)(W.r,{children:[(0,Q.jsx)(U.v,{color:pe,children:"Active Opportunities"}),(0,Q.jsx)(R.k,{color:ce,fontSize:"2xl",children:(null===z||void 0===z?void 0:z.activeCount)||0}),(0,Q.jsxs)(L.h,{color:ue,children:["$",((null===z||void 0===z?void 0:z.totalValue)||0).toLocaleString()," total value"]})]})})}),(0,Q.jsx)(b.Z,{bg:ae,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:de,borderRadius:"lg",children:(0,Q.jsx)(g.b,{children:(0,Q.jsxs)(W.r,{children:[(0,Q.jsx)(U.v,{color:pe,children:"Won"}),(0,Q.jsx)(R.k,{color:"#48BB78",fontSize:"2xl",children:(null===z||void 0===z?void 0:z.wonCount)||0}),(0,Q.jsxs)(L.h,{color:ue,children:["$",((null===z||void 0===z?void 0:z.wonValue)||0).toLocaleString()," revenue"]})]})})}),(0,Q.jsx)(b.Z,{bg:ae,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:de,borderRadius:"lg",children:(0,Q.jsx)(g.b,{children:(0,Q.jsxs)(W.r,{children:[(0,Q.jsx)(U.v,{color:pe,children:"Lost"}),(0,Q.jsx)(R.k,{color:"#F56565",fontSize:"2xl",children:(null===z||void 0===z?void 0:z.lostCount)||0})]})})}),(0,Q.jsx)(b.Z,{bg:ae,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:de,borderRadius:"lg",children:(0,Q.jsx)(g.b,{children:(0,Q.jsxs)(W.r,{children:[(0,Q.jsx)(U.v,{color:pe,children:"Win Rate"}),(0,Q.jsxs)(R.k,{color:ce,fontSize:"2xl",children:[null!==z&&void 0!==z&&z.wonCount&&null!==z&&void 0!==z&&z.lostCount?Math.round(z.wonCount/(z.wonCount+z.lostCount)*100):0,"%"]})]})})}),(0,Q.jsx)(b.Z,{bg:ae,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:de,borderRadius:"lg",children:(0,Q.jsx)(g.b,{children:(0,Q.jsxs)(W.r,{children:[(0,Q.jsx)(U.v,{color:pe,children:"Total Tasks"}),(0,Q.jsx)(R.k,{color:ce,fontSize:"2xl",children:(()=>{const e=_.reduce((e,o)=>e+(o.completedTaskCount||0),0),o=_.reduce((e,o)=>e+(o.taskCount||0),0);return"".concat(e,"/").concat(o)})()}),(0,Q.jsx)(L.h,{color:ue,children:(()=>{const e=_.reduce((e,o)=>e+(o.completedTaskCount||0),0),o=_.reduce((e,o)=>e+(o.taskCount||0),0),r=o>0?Math.round(e/o*100):0;return"".concat(r,"% complete")})()})]})})})]}),(0,Q.jsxs)(E.z,{spacing:4,children:[(0,Q.jsxs)(f.M,{maxW:"300px",children:[(0,Q.jsx)(S.W,{pointerEvents:"none",children:(0,Q.jsx)(M.CKj,{color:ue})}),(0,Q.jsx)(C.p,{placeholder:"Search opportunities...",value:r,onChange:e=>t(e.target.value),bg:"light"===s?"white":ae,color:ce,borderColor:de,_placeholder:{color:ue},_hover:{borderColor:pe},_focus:{borderColor:(0,X.oU)("primary",s),boxShadow:"0 0 0 1px ".concat((0,X.oU)("primary",s))}})]}),(0,Q.jsxs)(O.l,{maxW:"200px",value:n,onChange:e=>i(e.target.value),bg:"light"===s?"white":ae,color:ce,borderColor:de,_hover:{borderColor:pe},_focus:{borderColor:(0,X.oU)("primary",s),boxShadow:"0 0 0 1px ".concat((0,X.oU)("primary",s))},children:[(0,Q.jsx)("option",{value:"ALL",children:"All Status"}),(0,Q.jsx)("option",{value:"ACTIVE",children:"Active Filter"}),(0,Q.jsx)("option",{value:"WON",children:"Won"}),(0,Q.jsx)("option",{value:"LOST",children:"Lost"}),(0,Q.jsx)("option",{value:"ON_HOLD",children:"On Hold"})]})]}),(0,Q.jsx)(p.a,{overflowX:"auto",children:(0,Q.jsx)(N.JY,{onDragEnd:async e=>{if(!e.destination)return;const{draggableId:r,destination:t}=e,n=t.droppableId;try{await A({variables:{id:r,newStage:n}}),o({title:"Opportunity moved",status:"success",duration:3e3,isClosable:!0}),h()}catch(i){o({title:"Failed to move opportunity",description:i.message||"An error occurred",status:"error",duration:5e3,isClosable:!0})}},children:(0,Q.jsx)(E.z,{align:"stretch",spacing:4,minW:300*V.length,children:V.map(r=>{var t;return(0,Q.jsx)(p.a,{minW:"300px",flex:"1",children:(0,Q.jsxs)(I.T,{align:"stretch",spacing:2,children:[(0,Q.jsx)(b.Z,{bg:ae,backdropFilter:"blur(10px)",boxShadow:"0 8px 32px 0 rgba(0, 0, 0, 0.37)",border:"1px",borderColor:de,borderRadius:"lg",children:(0,Q.jsxs)(j.a,{py:3,children:[(0,Q.jsxs)(E.z,{justify:"space-between",children:[(0,Q.jsxs)(E.z,{children:[r.icon&&(0,Q.jsx)(G.E,{children:r.icon}),(0,Q.jsx)(G.E,{fontWeight:"bold",color:ce,children:r.name})]}),(0,Q.jsx)(u.E,{colorScheme:"blue",bg:"light"===s?"blue.100":"rgba(56, 178, 255, 0.2)",color:"light"===s?"blue.800":"white",children:(null===(t=se[r.code])||void 0===t?void 0:t.length)||0})]}),(0,Q.jsx)(p.a,{h:"2px",bg:r.color,mt:2,borderRadius:"full"})]})}),(0,Q.jsx)(N.gL,{droppableId:r.code,children:(t,n)=>{var i;return(0,Q.jsxs)(I.T,(0,a.A)((0,a.A)({ref:t.innerRef},t.droppableProps),{},{align:"stretch",spacing:0,minH:"400px",bg:n.isDraggingOver?"blue.50":"transparent",p:2,borderRadius:"md",transition:"background 0.2s",children:[null===(i=se[r.code])||void 0===i?void 0:i.map((r,t)=>(0,Q.jsx)(N.sx,{draggableId:r.id,index:t,children:(t,n)=>(0,Q.jsx)(p.a,(0,a.A)((0,a.A)((0,a.A)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{opacity:n.isDragging?.5:1,children:(0,Q.jsx)(ie,{opportunity:r,onEdit:()=>e("/opportunities/".concat(r.id)),onDelete:()=>(async e=>{if(window.confirm("Are you sure you want to delete this opportunity?"))try{await D({variables:{id:e}}),o({title:"Opportunity deleted",status:"success",duration:3e3,isClosable:!0}),h()}catch(r){o({title:"Failed to delete opportunity",description:r.message||"An error occurred",status:"error",duration:5e3,isClosable:!0})}})(r.id)})}))},r.id)),t.placeholder]}))}})]})},r.code)})})})})]})}),(0,Q.jsx)(B.n,{})]})}}}]);
//# sourceMappingURL=5974.015cc772.chunk.js.map