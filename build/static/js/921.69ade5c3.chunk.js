"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[921],{90921:(e,s,n)=>{n.r(s),n.d(s,{default:()=>O});var r=n(80045),t=n(89379),a=n(57528),l=n(65043),o=n(87139),i=n(22107),d=n(98662),c=n(42703),p=n(44093),h=n(98939),u=n(82459),g=n(73225),m=n(76668),x=n(35699),j=n(76659),f=n(96148),y=n(10202),v=n(19077),b=n(30502),P=n(28846),S=n(39081),I=n(1009),C=n(73216),k=n(31881),z=n(10585),M=n(70459),D=n(39985),w=n(63295),A=n(52003),E=n(95214),J=n(76879),_=n(70579);const R=["__typename"];var T,$;const N=(0,M.J1)(T||(T=(0,a.A)(["\n  query GetProposal($id: ID!) {\n    getProposal(id: $id) {\n      id\n      companyName\n      slug\n      title\n      agreementMarkdown\n      customPagePath\n      projectId\n      draftBillId\n      scheduledPayments {\n        billId\n        daysAfterPrevious\n        description\n      }\n      notes\n    }\n  }\n"]))),U=(0,M.J1)($||($=(0,a.A)(["\n  mutation UpdateProposal($id: ID!, $input: UpdateProposalInput!) {\n    updateProposal(id: $id, input: $input) {\n      id\n      companyName\n      slug\n      title\n      status\n    }\n  }\n"]))),O=()=>{const{id:e}=(0,C.g)(),s=(0,C.Zp)(),n=(0,b.d)(),{colorMode:a}=(0,p.G6)(),[M,T]=(0,l.useState)(""),[$,O]=(0,l.useState)(""),[B,G]=(0,l.useState)(""),[W,q]=(0,l.useState)(""),[L,F]=(0,l.useState)(""),[H,K]=(0,l.useState)(""),[Z,Q]=(0,l.useState)(""),[V,X]=(0,l.useState)([]),[Y,ee]=(0,l.useState)(""),{data:se,loading:ne}=(0,z.IT)(N,{variables:{id:e},skip:!e}),[re,{loading:te}]=(0,k.n)(U),ae=(0,D.oU)("background.main",a),le="light"===a?"white":"gray.800",oe=(0,D.oU)("light"===a?"text.primary":"text.primaryDark",a),ie=(0,D.oU)("light"===a?"text.secondary":"text.secondaryDark",a);(0,l.useEffect)(()=>{if(null!==se&&void 0!==se&&se.getProposal){const e=se.getProposal;T(e.companyName||""),O(e.slug||""),G(e.title||""),q(e.agreementMarkdown||""),F(e.customPagePath||""),K(e.projectId||""),Q(e.draftBillId||""),X(e.scheduledPayments||[]),ee(e.notes||"")}},[se]);const de=(e,s,n)=>{const r=[...V];r[e]=(0,t.A)((0,t.A)({},r[e]),{},{[s]:n}),X(r)};return ne?(0,_.jsx)(i.a,{bg:ae,minH:"100vh",display:"flex",alignItems:"center",justifyContent:"center",children:(0,_.jsx)(j.y,{size:"xl"})}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.m,{}),(0,_.jsx)(i.a,{bg:ae,minH:"100vh",py:10,children:(0,_.jsx)(h.m,{maxW:"container.xl",children:(0,_.jsxs)(y.T,{spacing:8,align:"stretch",children:[(0,_.jsx)(E.y,{moduleConfig:J.default}),(0,_.jsx)(i.a,{bg:le,p:8,borderRadius:"lg",shadow:"md",children:(0,_.jsxs)(y.T,{spacing:6,align:"stretch",children:[(0,_.jsx)(P.D,{size:"lg",color:oe,children:"Edit Proposal"}),(0,_.jsxs)(g.MJ,{isRequired:!0,children:[(0,_.jsx)(m.l,{color:oe,children:"Company Name"}),(0,_.jsx)(x.p,{value:M,onChange:e=>T(e.target.value),placeholder:"e.g., One Group Australasia"})]}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{color:oe,children:"URL Slug"}),(0,_.jsx)(x.p,{value:$,isReadOnly:!0,placeholder:"e.g., onegroup",opacity:.6}),(0,_.jsx)(S.E,{fontSize:"sm",color:ie,mt:1,children:"Slug cannot be changed after creation"})]}),(0,_.jsxs)(g.MJ,{isRequired:!0,children:[(0,_.jsx)(m.l,{color:oe,children:"Proposal Title"}),(0,_.jsx)(x.p,{value:B,onChange:e=>G(e.target.value),placeholder:"e.g., Website Development & Managed IT Agreement"})]}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{color:oe,children:"Custom Offer Page Path (Optional)"}),(0,_.jsx)(x.p,{value:L,onChange:e=>F(e.target.value),placeholder:"e.g., /offers/onegroup"}),(0,_.jsx)(S.E,{fontSize:"sm",color:ie,mt:1,children:"If you have a custom branded offer page, enter its path here (e.g., /offers/onegroup)"})]}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{color:oe,children:"Project ID (Optional)"}),(0,_.jsx)(x.p,{value:H,onChange:e=>K(e.target.value),placeholder:"e.g., 6234f234a234b234c234d234"}),(0,_.jsx)(S.E,{fontSize:"sm",color:ie,mt:1,children:"Link this proposal to an existing project"})]}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{color:oe,children:"Draft Bill ID (Optional)"}),(0,_.jsx)(x.p,{value:Z,onChange:e=>Q(e.target.value),placeholder:"e.g., 6234f234a234b234c234d234"}),(0,_.jsx)(S.E,{fontSize:"sm",color:ie,mt:1,children:"Draft bill to be paid upon signing"})]}),(0,_.jsx)(u.c,{}),(0,_.jsxs)(i.a,{children:[(0,_.jsxs)(f.z,{justify:"space-between",mb:4,children:[(0,_.jsxs)(i.a,{children:[(0,_.jsx)(P.D,{size:"md",color:oe,children:"Scheduled Payments"}),(0,_.jsx)(S.E,{fontSize:"sm",color:ie,mt:1,children:"Create a payment schedule with milestones"})]}),(0,_.jsx)(d.$,{leftIcon:(0,_.jsx)(I.GGD,{}),size:"sm",onClick:()=>{X([...V,{billId:"",daysAfterPrevious:void 0,description:""}])},colorScheme:"blue",children:"Add Payment"})]}),0===V.length?(0,_.jsx)(i.a,{p:6,textAlign:"center",borderWidth:1,borderRadius:"md",borderStyle:"dashed",color:ie,children:(0,_.jsx)(S.E,{children:'No scheduled payments yet. Click "Add Payment" to create a milestone.'})}):(0,_.jsx)(y.T,{spacing:4,align:"stretch",children:V.map((e,s)=>(0,_.jsxs)(i.a,{p:4,borderWidth:1,borderRadius:"md",bg:"light"===a?"gray.50":"gray.700",children:[(0,_.jsxs)(f.z,{justify:"space-between",mb:3,children:[(0,_.jsxs)(o.E,{colorScheme:"blue",children:["Payment ",s+1]}),(0,_.jsx)(c.K,{"aria-label":"Remove payment",icon:(0,_.jsx)(I.yGN,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>(e=>{X(V.filter((s,n)=>n!==e))})(s)})]}),(0,_.jsxs)(y.T,{spacing:3,align:"stretch",children:[(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{fontSize:"sm",color:oe,children:"Bill ID"}),(0,_.jsx)(x.p,{size:"sm",value:e.billId||"",onChange:e=>de(s,"billId",e.target.value),placeholder:"e.g., 6234f234a234b234c234d234"})]}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{fontSize:"sm",color:oe,children:"Days After Previous Payment"}),(0,_.jsx)(x.p,{size:"sm",type:"number",value:e.daysAfterPrevious||"",onChange:e=>de(s,"daysAfterPrevious",e.target.value?parseInt(e.target.value):void 0),placeholder:0===s?"Days after signing (e.g., 0, 7, 14)":"Days after previous payment"}),(0,_.jsx)(S.E,{fontSize:"xs",color:ie,mt:1,children:0===s?"Days after proposal is signed":"Days after the previous payment is completed"})]}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{fontSize:"sm",color:oe,children:"Description"}),(0,_.jsx)(x.p,{size:"sm",value:e.description||"",onChange:e=>de(s,"description",e.target.value),placeholder:"e.g., Milestone 1: Core Pages & Infrastructure"})]})]})]},s))})]}),(0,_.jsx)(u.c,{}),(0,_.jsxs)(g.MJ,{isRequired:!0,children:[(0,_.jsx)(m.l,{color:oe,children:"Agreement (Markdown)"}),(0,_.jsx)(v.T,{value:W,onChange:e=>q(e.target.value),placeholder:"Write your agreement in Markdown format",rows:15,fontFamily:"monospace"}),(0,_.jsx)(S.E,{fontSize:"sm",color:ie,mt:1,children:"Write your agreement in Markdown format"})]}),(0,_.jsx)(u.c,{}),(0,_.jsxs)(g.MJ,{children:[(0,_.jsx)(m.l,{color:oe,children:"Internal Notes (Optional)"}),(0,_.jsx)(v.T,{value:Y,onChange:e=>ee(e.target.value),placeholder:"Internal notes about this proposal...",rows:3})]}),(0,_.jsxs)(f.z,{spacing:4,justify:"flex-end",children:[(0,_.jsx)(d.$,{variant:"outline",onClick:()=>s("/proposals"),children:"Cancel"}),(0,_.jsx)(d.$,{colorScheme:"blue",leftIcon:(0,_.jsx)(I.Bc_,{}),onClick:async()=>{if(M&&$&&B&&W)try{const t=V.map(e=>{const{__typename:s}=e;return(0,r.A)(e,R)});await re({variables:{id:e,input:{companyName:M,title:B,agreementMarkdown:W,projectId:H||void 0,draftBillId:Z||void 0,scheduledPayments:t.length>0?t:void 0,notes:Y||void 0}}}),n({title:"Proposal updated!",description:'Proposal "'.concat(M,'" has been updated'),status:"success",duration:5e3}),s("/proposals")}catch(t){n({title:"Error updating proposal",description:t instanceof Error?t.message:"Unknown error occurred",status:"error",duration:5e3})}else n({title:"Missing fields",description:"Please fill in all required fields",status:"error",duration:3e3})},isLoading:te,children:"Update Proposal"})]})]})})]})})}),(0,_.jsx)(w.n,{})]})}}}]);
//# sourceMappingURL=921.69ade5c3.chunk.js.map