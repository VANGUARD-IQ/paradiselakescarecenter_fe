"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[5037],{55037:(e,a,n)=>{n.r(a),n.d(a,{AvailabilitySettings:()=>X,default:()=>ee});var l,i,r,s=n(89379),t=n(57528),o=n(65043),d=n(73216),c=n(31881),h=n(10585),u=n(70459),b=n(88787),m=n(85871),x=n(87139),j=n(22107),g=n(98662),v=n(42703),p=n(83169),y=n(24330),A=n(26201),k=n(44093),f=n(98939),C=n(82459),z=n(73225),S=n(76668),D=n(73212),T=n(35699),E=n(61724),W=n(76659),I=n(96148),w=n(10202),$=n(98481),U=n(30502),_=n(28846),B=n(39081),O=n(12730),M=n(58584),R=n(37809),F=n(52003),H=n(63295),L=n(95214),Z=n(60319),J=n(66037),K=n(39985),P=n(70579);const G=(0,u.J1)(l||(l=(0,t.A)(["\n  query CalendarAvailability($calendarId: String!) {\n    calendarAvailability(calendarId: $calendarId) {\n      id\n      calendarId\n      slots {\n        dayOfWeek\n        startTime\n        endTime\n      }\n      blockedDates\n      extraAvailableDates\n      timezone\n    }\n  }\n"]))),N=(0,u.J1)(i||(i=(0,t.A)(["\n  mutation CreateBusinessCalendarAvailability($input: CreateBusinessCalendarAvailabilityInput!) {\n    createBusinessCalendarAvailability(input: $input) {\n      id\n      calendarId\n      slots {\n        dayOfWeek\n        startTime\n        endTime\n      }\n      blockedDates\n      timezone\n    }\n  }\n"]))),Y=(0,u.J1)(r||(r=(0,t.A)(["\n  mutation UpdateBusinessCalendarAvailability($calendarId: String!, $input: UpdateBusinessCalendarAvailabilityInput!) {\n    updateBusinessCalendarAvailability(calendarId: $calendarId, input: $input) {\n      id\n      calendarId\n      slots {\n        dayOfWeek\n        startTime\n        endTime\n      }\n      blockedDates\n      timezone\n    }\n  }\n"]))),q=[{value:0,label:"Sunday",short:"Sun"},{value:1,label:"Monday",short:"Mon"},{value:2,label:"Tuesday",short:"Tue"},{value:3,label:"Wednesday",short:"Wed"},{value:4,label:"Thursday",short:"Thu"},{value:5,label:"Friday",short:"Fri"},{value:6,label:"Saturday",short:"Sat"}],Q=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Shanghai","Australia/Sydney","Australia/Melbourne","Australia/Brisbane","Australia/Perth","Pacific/Auckland"],V=(()=>{const e=[];for(let a=0;a<24;a++)for(let n=0;n<60;n+=15){const l=a.toString().padStart(2,"0"),i=n.toString().padStart(2,"0");e.push("".concat(l,":").concat(i))}return e})(),X=()=>{const{id:e}=(0,d.g)(),a=(0,d.Zp)(),n=(0,U.d)(),{colorMode:l}=(0,k.G6)(),i=(0,K.oU)("background.main",l),r=(0,K.oU)("background.cardGradient",l),t=(0,K.oU)("border.darkCard",l),u=(0,K.oU)("light"===l?"text.primary":"text.primaryDark",l),X=(0,K.oU)("light"===l?"text.secondary":"text.secondaryDark",l),ee=(0,K.oU)("text.muted",l),ae=(0,K.oU)("primary",l),ne=(0,K.oU)("primaryHover",l);(0,J.H)("Availability Settings");const[le,ie]=(0,o.useState)({slots:[],blockedDates:[],timezone:"Australia/Sydney"}),[re,se]=(0,o.useState)({}),[te,oe]=(0,o.useState)({}),[de,ce]=(0,o.useState)(""),{data:he,loading:ue,error:be}=(0,h.IT)(G,{variables:{calendarId:e},skip:!e}),[me,{loading:xe}]=(0,c.n)(N,{onCompleted:()=>{n({title:"Availability created",status:"success",duration:3e3})},onError:e=>{n({title:"Error creating availability",description:e.message,status:"error",duration:5e3})}}),[je,{loading:ge}]=(0,c.n)(Y,{onCompleted:()=>{n({title:"Availability updated",status:"success",duration:3e3})},onError:e=>{n({title:"Error updating availability",description:e.message,status:"error",duration:5e3})}});(0,o.useEffect)(()=>{if(null!==he&&void 0!==he&&he.calendarAvailability){const e=he.calendarAvailability;ie({slots:e.slots||[],blockedDates:e.blockedDates||[],timezone:e.timezone||"Australia/Sydney"});const a={},n={};(e.slots||[]).forEach(e=>{a[e.dayOfWeek]||(a[e.dayOfWeek]=[]),a[e.dayOfWeek].push({start:e.startTime,end:e.endTime}),n[e.dayOfWeek]=!0}),oe(a),se(n)}},[he]);const ve=(e,a,n,l)=>{oe(i=>(0,s.A)((0,s.A)({},i),{},{[e]:i[e].map((e,i)=>i===a?(0,s.A)((0,s.A)({},e),{},{[n]:l}):e)}))};return ue?(0,P.jsxs)(j.a,{bg:i,minH:"100vh",children:[(0,P.jsx)(F.m,{}),(0,P.jsx)(f.m,{maxW:"container.xl",py:8,children:(0,P.jsxs)(w.T,{spacing:4,children:[(0,P.jsx)(W.y,{size:"xl",color:ae}),(0,P.jsx)(B.E,{color:u,children:"Loading availability..."})]})}),(0,P.jsx)(H.n,{})]}):be?(0,P.jsxs)(j.a,{bg:i,minH:"100vh",children:[(0,P.jsx)(F.m,{}),(0,P.jsx)(f.m,{maxW:"container.xl",py:8,children:(0,P.jsxs)(b.F,{status:"error",children:[(0,P.jsx)(m._,{}),(0,P.jsxs)(B.E,{color:u,children:["Error loading availability: ",be.message]})]})}),(0,P.jsx)(H.n,{})]}):(0,P.jsxs)(j.a,{bg:i,minH:"100vh",children:[(0,P.jsx)(F.m,{}),(0,P.jsx)(L.y,{moduleConfig:Z.calendarsModuleConfig}),(0,P.jsx)(f.m,{maxW:"container.xl",py:8,children:(0,P.jsxs)(w.T,{spacing:6,align:"stretch",children:[(0,P.jsxs)(I.z,{justify:"space-between",children:[(0,P.jsxs)(I.z,{spacing:4,children:[(0,P.jsx)(v.K,{"aria-label":"Back to event types",icon:(0,P.jsx)(R.g,{}),onClick:()=>a("/calendars/".concat(e,"/event-types")),bg:r,borderColor:t,color:u,_hover:{bg:ne}}),(0,P.jsxs)(j.a,{children:[(0,P.jsx)(_.D,{size:"lg",color:u,children:"Availability Settings"}),(0,P.jsx)(B.E,{color:X,children:"Define when you're available for bookings"})]})]}),(0,P.jsx)(g.$,{bg:ae,color:"white",onClick:async()=>{const a=[];Object.entries(te).forEach(e=>{let[n,l]=e;const i=parseInt(n);re[i]&&l.forEach(e=>{a.push({dayOfWeek:i,startTime:e.start,endTime:e.end})})});const n={slots:a,blockedDates:le.blockedDates.map(e=>new Date(e)),timezone:le.timezone};null!==he&&void 0!==he&&he.calendarAvailability?await je({variables:{calendarId:e,input:n}}):await me({variables:{input:(0,s.A)((0,s.A)({},n),{},{calendarId:e})}})},isLoading:xe||ge,_hover:{bg:ne},children:"Save Availability"})]}),(0,P.jsxs)(p.Z,{bg:r,borderColor:t,children:[(0,P.jsx)(A.a,{children:(0,P.jsx)(_.D,{size:"md",color:u,children:"Timezone"})}),(0,P.jsx)(y.b,{children:(0,P.jsxs)(z.MJ,{children:[(0,P.jsx)(S.l,{color:u,children:"Your Timezone"}),(0,P.jsx)(E.l,{value:le.timezone,onChange:e=>ie((0,s.A)((0,s.A)({},le),{},{timezone:e.target.value})),color:u,bg:"rgba(255,255,255,0.05)",borderColor:t,children:Q.map(e=>(0,P.jsx)("option",{value:e,children:e},e))}),(0,P.jsx)(B.E,{fontSize:"sm",color:ee,mt:2,children:"All availability times are in this timezone"})]})})]}),(0,P.jsxs)(p.Z,{bg:r,borderColor:t,children:[(0,P.jsxs)(A.a,{children:[(0,P.jsx)(_.D,{size:"md",color:u,children:"Weekly Schedule"}),(0,P.jsx)(B.E,{fontSize:"sm",color:X,children:"Select days and set your available hours"})]}),(0,P.jsx)(y.b,{children:(0,P.jsx)(w.T,{spacing:4,align:"stretch",children:q.map(e=>(0,P.jsxs)(j.a,{children:[(0,P.jsxs)(I.z,{justify:"space-between",mb:2,children:[(0,P.jsxs)(I.z,{children:[(0,P.jsx)($.d,{isChecked:re[e.value]||!1,onChange:()=>{return a=e.value,void se(e=>{const n=(0,s.A)((0,s.A)({},e),{},{[a]:!e[a]});return n[a]&&!te[a]&&oe(e=>(0,s.A)((0,s.A)({},e),{},{[a]:[{start:"09:00",end:"17:00"}]})),n});var a},colorScheme:"green"}),(0,P.jsx)(B.E,{fontWeight:"bold",color:u,minW:"100px",children:e.label})]}),re[e.value]&&(0,P.jsx)(g.$,{size:"sm",leftIcon:(0,P.jsx)(O.R,{}),onClick:()=>{return a=e.value,void oe(e=>(0,s.A)((0,s.A)({},e),{},{[a]:[...e[a]||[],{start:"09:00",end:"17:00"}]}));var a},variant:"ghost",colorScheme:"blue",children:"Add Time Range"})]}),re[e.value]&&te[e.value]&&(0,P.jsx)(w.T,{spacing:2,pl:10,align:"stretch",children:te[e.value].map((a,n)=>(0,P.jsxs)(I.z,{children:[(0,P.jsx)(E.l,{value:a.start,onChange:a=>ve(e.value,n,"start",a.target.value),size:"sm",color:u,bg:"rgba(255,255,255,0.05)",maxW:"150px",children:V.map(e=>(0,P.jsx)("option",{value:e,children:e},e))}),(0,P.jsx)(B.E,{color:X,children:"to"}),(0,P.jsx)(E.l,{value:a.end,onChange:a=>ve(e.value,n,"end",a.target.value),size:"sm",color:u,bg:"rgba(255,255,255,0.05)",maxW:"150px",children:V.map(e=>(0,P.jsx)("option",{value:e,children:e},e))}),(0,P.jsx)(v.K,{"aria-label":"Remove time range",icon:(0,P.jsx)(M.d,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:()=>((e,a)=>{oe(n=>(0,s.A)((0,s.A)({},n),{},{[e]:n[e].filter((e,n)=>n!==a)}))})(e.value,n)})]},n))}),e.value<6&&(0,P.jsx)(C.c,{mt:4})]},e.value))})})]}),(0,P.jsxs)(p.Z,{bg:r,borderColor:t,children:[(0,P.jsxs)(A.a,{children:[(0,P.jsx)(_.D,{size:"md",color:u,children:"Blocked Dates"}),(0,P.jsx)(B.E,{fontSize:"sm",color:X,children:"Add dates when you're not available (holidays, vacations)"})]}),(0,P.jsx)(y.b,{children:(0,P.jsxs)(w.T,{spacing:4,align:"stretch",children:[(0,P.jsxs)(I.z,{children:[(0,P.jsx)(T.p,{type:"date",value:de,onChange:e=>ce(e.target.value),color:u,bg:"rgba(255,255,255,0.05)",borderColor:t}),(0,P.jsx)(g.$,{leftIcon:(0,P.jsx)(O.R,{}),onClick:()=>{de&&(le.blockedDates.includes(de)||(ie(e=>(0,s.A)((0,s.A)({},e),{},{blockedDates:[...e.blockedDates,de]})),ce("")))},colorScheme:"red",variant:"outline",children:"Block Date"})]}),0===le.blockedDates.length&&(0,P.jsx)(j.a,{p:4,bg:"rgba(255,255,255,0.05)",borderRadius:"md",textAlign:"center",children:(0,P.jsx)(B.E,{fontSize:"sm",color:ee,children:"No blocked dates. Add holidays or vacation days here."})}),le.blockedDates.length>0&&(0,P.jsx)(D.r,{columns:{base:2,md:3,lg:4},spacing:2,children:le.blockedDates.map(e=>(0,P.jsxs)(I.z,{justify:"space-between",p:2,bg:"rgba(255,0,0,0.1)",borderRadius:"md",children:[(0,P.jsx)(x.E,{colorScheme:"red",children:new Date(e).toLocaleDateString()}),(0,P.jsx)(v.K,{"aria-label":"Remove blocked date",icon:(0,P.jsx)(M.d,{}),size:"xs",colorScheme:"red",variant:"ghost",onClick:()=>(e=>{ie(a=>(0,s.A)((0,s.A)({},a),{},{blockedDates:a.blockedDates.filter(a=>a!==e)}))})(e)})]},e))})]})})]}),(0,P.jsxs)(p.Z,{bg:r,borderColor:t,children:[(0,P.jsx)(A.a,{children:(0,P.jsx)(_.D,{size:"md",color:u,children:"Quick Setup"})}),(0,P.jsx)(y.b,{children:(0,P.jsxs)(I.z,{spacing:3,flexWrap:"wrap",children:[(0,P.jsx)(g.$,{size:"sm",onClick:()=>{const e={},a={};[1,2,3,4,5].forEach(n=>{e[n]=!0,a[n]=[{start:"09:00",end:"17:00"}]}),se(e),oe(a)},colorScheme:"blue",variant:"outline",children:"Mon-Fri 9am-5pm"}),(0,P.jsx)(g.$,{size:"sm",onClick:()=>{const e={},a={};[1,2,3,4,5].forEach(n=>{e[n]=!0,a[n]=[{start:"09:00",end:"12:00"},{start:"13:00",end:"17:00"}]}),se(e),oe(a)},colorScheme:"green",variant:"outline",children:"Mon-Fri 9am-5pm (w/ lunch)"}),(0,P.jsx)(g.$,{size:"sm",onClick:()=>{se({}),oe({})},colorScheme:"red",variant:"outline",children:"Clear All"})]})})]})]})}),(0,P.jsx)(H.n,{})]})},ee=X}}]);
//# sourceMappingURL=5037.7e5158f1.chunk.js.map