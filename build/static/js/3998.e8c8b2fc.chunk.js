"use strict";(self.webpackChunkbusiness_builder_master_frontend=self.webpackChunkbusiness_builder_master_frontend||[]).push([[3998],{3998:(e,n,o)=>{o.r(n),o.d(n,{default:()=>V});var i,t,l,s,r=o(57528),a=o(65043),d=o(88787),c=o(85871),u=o(22107),h=o(98662),m=o(83169),p=o(24330),g=o(26201),x=o(44093),b=o(98939),j=o(73225),v=o(76668),f=o(73212),y=o(67516),w=o(35929),D=o(56529),S=o(15071),T=o(11054),k=o(78460),C=o(25722),E=o(61724),I=o(76659),M=o(96148),z=o(10202),R=o(30502),$=o(28846),N=o(39081),F=o(31881),U=o(10585),_=o(70459),W=o(25624),q=o(37809),A=o(73216),H=o(52003),J=o(63295),L=o(95214),O=o(46898),P=o(39985),G=o(66037),Y=o(70579);const Q=(0,_.J1)(i||(i=(0,r.A)(["\n  query GetTenantsForQuickDeploy {\n    tenants {\n      id\n      name\n      status\n      githubRepo\n      githubOwner\n      branding {\n        siteName\n      }\n      client {\n        id\n        fName\n        lName\n      }\n    }\n  }\n"]))),B=(0,_.J1)(t||(t=(0,r.A)(["\n  query GetAvailableModules {\n    availableModules {\n      id\n      name\n      description\n      icon\n      version\n      requiredTier\n    }\n  }\n"]))),Z=(0,_.J1)(l||(l=(0,r.A)(["\n  mutation DeployModuleToTenant($moduleId: String!, $tenantId: String!) {\n    deployModuleToTenant(moduleId: $moduleId, tenantId: $tenantId) {\n      tenantId\n      tenantName\n      success\n      error\n      commitSha\n    }\n  }\n"]))),K=(0,_.J1)(s||(s=(0,r.A)(["\n  mutation EnableModuleForTenant($tenantId: ID!, $moduleId: String!, $version: String) {\n    enableModuleForTenant(tenantId: $tenantId, moduleId: $moduleId, version: $version) {\n      id\n      moduleConfig {\n        moduleId\n        version\n        enabled\n        enabledAt\n      }\n    }\n  }\n"]))),V=()=>{var e,n,o;(0,G.H)("Quick Deploy");const{colorMode:i}=(0,x.G6)(),t=(0,A.Zp)(),l=(0,R.d)(),s=(0,P.oU)("background.main",i),r=(0,P.oU)("background.cardGradient",i),_=(0,P.oU)("border.darkCard",i),V=(0,P.oU)("light"===i?"text.primary":"text.primaryDark",i),X=(0,P.oU)("light"===i?"text.muted":"text.mutedDark",i),[ee,ne]=a.useState(""),[oe,ie]=a.useState(""),[te,le]=a.useState(!1),[se,re]=a.useState([]),[ae,de]=a.useState(""),[ce,ue]=a.useState(!1),{data:he,loading:me}=(0,U.IT)(Q),{data:pe,loading:ge}=(0,U.IT)(B),[xe]=(0,F.n)(Z),[be]=(0,F.n)(K),je=(null===he||void 0===he?void 0:he.tenants)||[],ve=e=>{const n=(new Date).toLocaleTimeString(),o="[".concat(n,"] ").concat(e);re(e=>[...e,o]),console.log("\ud83d\ude80 DEPLOYMENT: ".concat(o))};if(me||ge)return(0,Y.jsxs)(u.a,{bg:s,minHeight:"100vh",display:"flex",flexDirection:"column",children:[(0,Y.jsx)(H.m,{}),(0,Y.jsx)(b.m,{maxW:"container.xl",py:12,flex:"1",children:(0,Y.jsxs)(z.T,{spacing:8,children:[(0,Y.jsx)(I.y,{size:"xl"}),(0,Y.jsx)(N.E,{children:"Loading deployment options..."})]})}),(0,Y.jsx)(J.n,{})]});const fe=je.find(e=>e.id===oe),ye=null===pe||void 0===pe||null===(e=pe.availableModules)||void 0===e?void 0:e.find(e=>e.id===ee);return(0,Y.jsxs)(u.a,{bg:s,minHeight:"100vh",display:"flex",flexDirection:"column",children:[(0,Y.jsx)(H.m,{}),(0,Y.jsx)(L.y,{moduleConfig:O.default}),(0,Y.jsx)(b.m,{maxW:"container.lg",py:12,flex:"1",children:(0,Y.jsxs)(z.T,{spacing:8,align:"stretch",children:[(0,Y.jsx)(M.z,{justify:"space-between",children:(0,Y.jsxs)(z.T,{align:"start",spacing:2,children:[(0,Y.jsx)(M.z,{children:(0,Y.jsx)(h.$,{variant:"ghost",onClick:()=>t("/tenants/deploy"),leftIcon:(0,Y.jsx)(q.g,{}),children:"Back to Module Deployment"})}),(0,Y.jsx)($.D,{size:"lg",color:V,children:"\u26a1 Quick Deploy"}),(0,Y.jsx)(N.E,{color:X,children:"Deploy a specific module to a specific tenant quickly"})]})}),(0,Y.jsxs)(m.Z,{bg:r,borderColor:_,borderWidth:"1px",children:[(0,Y.jsx)(g.a,{children:(0,Y.jsx)($.D,{size:"md",color:V,children:"Select Deployment Target"})}),(0,Y.jsx)(p.b,{children:(0,Y.jsxs)(z.T,{spacing:6,align:"stretch",children:[(0,Y.jsxs)(f.r,{columns:{base:1,md:2},spacing:6,children:[(0,Y.jsxs)(j.MJ,{isRequired:!0,children:[(0,Y.jsx)(v.l,{children:"Select Tenant"}),(0,Y.jsx)(E.l,{placeholder:"Choose a tenant",value:oe,onChange:e=>ie(e.target.value),size:"lg",children:je.map(e=>{var n,o,i;return(0,Y.jsxs)("option",{value:e.id,children:[(null===(n=e.branding)||void 0===n?void 0:n.siteName)||e.name," (",null===(o=e.client)||void 0===o?void 0:o.fName," ",null===(i=e.client)||void 0===i?void 0:i.lName,")"]},e.id)})})]}),(0,Y.jsxs)(j.MJ,{isRequired:!0,children:[(0,Y.jsx)(v.l,{children:"Select Module"}),(0,Y.jsx)(E.l,{placeholder:"Choose a module",value:ee,onChange:e=>ne(e.target.value),size:"lg",children:null===pe||void 0===pe||null===(n=pe.availableModules)||void 0===n?void 0:n.map(e=>(0,Y.jsxs)("option",{value:e.id,children:[e.icon," ",e.name," (v",e.version,")"]},e.id))})]})]}),oe&&ee&&(0,Y.jsxs)(d.F,{status:"info",borderRadius:"md",children:[(0,Y.jsx)(c._,{}),(0,Y.jsxs)(z.T,{align:"start",spacing:2,flex:"1",children:[(0,Y.jsx)(N.E,{fontWeight:"bold",children:"\ud83d\udccb Deployment Preview"}),(0,Y.jsxs)(N.E,{fontSize:"sm",children:[(0,Y.jsx)("strong",{children:"Module:"})," ",null===ye||void 0===ye?void 0:ye.name," (v",null===ye||void 0===ye?void 0:ye.version,")"]}),(0,Y.jsxs)(N.E,{fontSize:"sm",children:[(0,Y.jsx)("strong",{children:"Target:"})," ",(null===fe||void 0===fe||null===(o=fe.branding)||void 0===o?void 0:o.siteName)||(null===fe||void 0===fe?void 0:fe.name)]}),(0,Y.jsxs)(N.E,{fontSize:"sm",children:[(0,Y.jsx)("strong",{children:"Repository:"})," ",null!==fe&&void 0!==fe&&fe.githubRepo?"".concat(null===fe||void 0===fe?void 0:fe.githubOwner,"/").concat(null===fe||void 0===fe?void 0:fe.githubRepo):"\u26a0\ufe0f No repository configured - deployment will fail"]})]})]}),(0,Y.jsx)(h.$,{colorScheme:"blue",size:"lg",onClick:async()=>{var e;if(!oe||!ee)return void l({title:"Missing Information",description:"Please select both a tenant and a module",status:"warning",duration:3e3,isClosable:!0});const n=je.find(e=>e.id===oe);if(!n)return;const o=(null===(e=n.branding)||void 0===e?void 0:e.siteName)||n.name;de(o),re([]),ue(!0),le(!0);try{ve("\ud83d\ude80 Starting deployment of ".concat(ee," module to ").concat(o)),ve("\ud83d\udccb Tenant ID: ".concat(oe)),ve("\ud83d\udcc2 Target Repository: ".concat(n.githubOwner,"/").concat(n.githubRepo)),ve("\ud83d\udce1 Sending deployment request to backend...");const e=(await xe({variables:{moduleId:ee,tenantId:oe}})).data.deployModuleToTenant;if(e.success){ve("\u2705 Backend deployment request successful"),ve("\ud83d\udcdd Commit SHA: ".concat(e.commitSha||"Not provided")),ve("\ud83c\udf89 Module ".concat(ee," successfully deployed to ").concat(o,"!")),ve("\ud83d\udcc1 Files copied to repository: ".concat(n.githubOwner,"/").concat(n.githubRepo)),ve("\ud83d\udd04 Repository has been updated with new module files"),ve("\ud83d\udd27 Enabling module ".concat(ee," for tenant..."));try{var i,t;const e=(null===pe||void 0===pe||null===(i=pe.availableModules)||void 0===i||null===(t=i.find(e=>e.id===ee))||void 0===t?void 0:t.version)||"latest";await be({variables:{tenantId:oe,moduleId:ee,version:e}}),ve("\u2705 Module ".concat(ee," enabled in tenant configuration")),ve("\ud83d\udccb Module is now active and accessible on the client site")}catch(s){ve("\u26a0\ufe0f Warning: Module deployed but failed to enable in tenant config"),ve("\ud83d\udd27 Error: ".concat(s instanceof Error?s.message:"Unknown enable error")),ve("\ud83d\udca1 You may need to manually enable the module in tenant settings")}l({title:"\u2705 Deployment Successful!",description:"".concat(ee," module deployed and enabled for ").concat(o),status:"success",duration:5e3,isClosable:!0}),ne(""),ie("")}else ve("\u274c Deployment failed: ".concat(e.error||"Unknown error")),ve("\ud83d\udca1 Check the error details above for troubleshooting"),l({title:"\u274c Deployment Failed",description:e.error||"Unknown error occurred",status:"error",duration:5e3,isClosable:!0});ve("\u2705 Deployment process completed")}catch(r){ve("\ud83d\udca5 Deployment error occurred: ".concat(r instanceof Error?r.message:"Unknown error")),ve("\u274c Deployment failed with exception"),l({title:"Deployment Error",description:r instanceof Error?r.message:"Unknown error occurred",status:"error",duration:5e3,isClosable:!0})}finally{le(!1)}},leftIcon:(0,Y.jsx)(W.H,{}),isDisabled:!oe||!ee||!(null!==fe&&void 0!==fe&&fe.githubRepo),width:"full",children:"\ud83d\ude80 Deploy Now"}),oe&&!(null!==fe&&void 0!==fe&&fe.githubRepo)&&(0,Y.jsxs)(d.F,{status:"warning",borderRadius:"md",children:[(0,Y.jsx)(c._,{}),(0,Y.jsx)(N.E,{fontSize:"sm",children:"This tenant does not have a GitHub repository configured. Please set up a repository first."})]})]})})]})]})}),(0,Y.jsxs)(k.aF,{isOpen:ce,onClose:()=>ue(!1),size:"xl",children:[(0,Y.jsx)(T.m,{}),(0,Y.jsxs)(C.$,{bg:r,color:V,borderColor:_,borderWidth:"1px",children:[(0,Y.jsx)(S.r,{color:V,children:(0,Y.jsxs)(M.z,{children:[(0,Y.jsxs)(N.E,{children:["\ud83d\ude80 Deploying to ",ae]}),te&&(0,Y.jsx)(I.y,{size:"sm"})]})}),(0,Y.jsx)(w.s,{}),(0,Y.jsx)(y.c,{children:(0,Y.jsxs)(z.T,{spacing:4,align:"stretch",children:[(0,Y.jsxs)(d.F,{status:te?"info":"success",children:[(0,Y.jsx)(c._,{}),(0,Y.jsx)(N.E,{children:te?"Deployment in progress... Please wait":"Deployment completed! Check the logs below for details."})]}),(0,Y.jsxs)(u.a,{children:[(0,Y.jsx)(N.E,{fontWeight:"bold",mb:2,children:"\ud83d\udccb Deployment Logs:"}),(0,Y.jsxs)(u.a,{bg:"gray.900",color:"green.300",p:4,borderRadius:"md",fontFamily:"mono",fontSize:"sm",maxHeight:"400px",overflowY:"auto",border:"1px solid",borderColor:"gray.600",children:[se.length>0?se.map((e,n)=>(0,Y.jsx)(u.a,{mb:1,children:e},n)):(0,Y.jsx)(N.E,{color:"gray.500",children:"No logs yet..."}),te&&(0,Y.jsx)(u.a,{children:(0,Y.jsx)(N.E,{color:"yellow.300",children:"\u23f3 Waiting for deployment to complete..."})})]})]}),!te&&(0,Y.jsxs)(d.F,{status:"success",children:[(0,Y.jsx)(c._,{}),(0,Y.jsxs)(z.T,{align:"start",spacing:1,children:[(0,Y.jsx)(N.E,{fontWeight:"bold",children:"Deployment Summary:"}),(0,Y.jsx)(N.E,{fontSize:"sm",children:"\u2022 Module files have been copied to the target repository"}),(0,Y.jsx)(N.E,{fontSize:"sm",children:"\u2022 Repository has been updated with the latest changes"}),(0,Y.jsx)(N.E,{fontSize:"sm",children:"\u2022 You can now access the deployed module on the client site"})]})]})]})}),(0,Y.jsxs)(D.j,{children:[(0,Y.jsx)(h.$,{variant:"ghost",mr:3,onClick:()=>{navigator.clipboard.writeText(se.join("\n")),l({title:"Logs copied to clipboard",status:"success",duration:2e3})},children:"\ud83d\udccb Copy Logs"}),(0,Y.jsx)(h.$,{colorScheme:"blue",onClick:()=>ue(!1),isDisabled:te,children:te?"Please wait...":"Close"})]})]})]}),(0,Y.jsx)(J.n,{})]})}}}]);
//# sourceMappingURL=3998.e8c8b2fc.chunk.js.map